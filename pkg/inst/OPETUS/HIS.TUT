SURVO 84C SUCROS@   8@HIST1        171@HIST2       1371@HIST3       3415@HIST4       6406@HIST5       9865@HIST6      14572@HIST7      17983@HIST8      23763@TÿTa1@SCRATCH €   µµµµ Luokitetut aineistot, histogrammat    Aikaisemmin on jo n„hty, miten STAT-operaatio muodostaa aktiivistenmuuttujien frekvenssijakaumat sopiviksi katsomillaan automaattisillaluokitustavoilla. Se riitt„„ aineiston alustavaan katseluun ja tarkas-tukseen.   Tarkempaan yhden muuttujan jakaumien tutkimiseen k„ytet„„n SurvossaHISTO-operaatiota, joka piirt„„ PLOT-operaation tapaan luokitetunjakauman histogrammana graafisilla laitteilla (piirturilla, laserkir-joittimilla, graafisessa n„yt”ss„). Kun toiminta tapahtuu graafisessan„yt”ss„, komentoa sovelletaan nimell„ GHISTO.   HISTO-operaatio paitsi piirt„„ histogramman, my”s tulostaafrekvenssijakauman k„ytt„j„n antaman tasav„lisen luokituksen mukaisestinumeerisessa muodossa. Lis„ksi on mahdollista tutkia erilaistenjakaumamallien yhteensopivuutta aineistoon. Valmiiksi m„„riteltyn„ onnormaali-, lognormaali-, tasainen, binomi- ja Poisson-jakauma.Tarvittaessa k„ytt„j„ voi m„„ritell„ omankin jakaumansa. Mallin jaaineiston yhteensopivuutta p„„see tarkkailemaan paitsi kuvasta my”sKhi-neli”-testin avulla.Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@GA@TXA@Tp@0T!1@C2@Ta-1@TLHIST@TÿTa1@SCRATCH€üGPLOT /DEL ALL€Bü   µµµµ Histogramman piirto Ta-1@TW10@   Piirr„mme histogramman Helsingin hein„kuun l„mp”tilasta (L„mp”)tiedostossa HELSINKI.TW10@Ta1@>COPY HELSINKI HELSINKI.SVO€Ta-1@TW10@GHISTO HELSINKI,L„mp”,0RT=1@1@+@C4@=TW5@  /  Tulokset rivilt„ = eteenp„inTW10@L„mp”=10(0.5)24TW5@           /  Muuttujan L„mp” luokitustapaTW10@   WAIT=10TW10@€TW30@TW50@º  TW10@Numeeriset tulokset:TW10@Luokkakeskiarvot.TW5@Ta1@¹¹¹ºTa-1@TW20@ Ž„rimm„isetluokat ovat avoimia.TW20@TW10@LuokkafrekvenssitTW5@Ta1@¹¹¹ºTa-1@TW30@ ja ne my”sprosentteina.TW5@Ta1@¹¹¹ºTa-1@TW30@TW5@Kumulatiiviset (yhteenlasketut)frekvenssitTW5@Ta1@¹¹¹ºTa-1@TW30@ ja nekin prosentteina.TW5@Ta1@¹¹¹ºTa-1@TW30@TW10@TW10@   Tulostaulukon lopussa on muuttujan luokitetusta jakaumasta laskettukeskiarvo ja hajonta.TW10@.±   Kuvallista puolta hallitaan samoilla keinoilla kuin PLOT-kaavioissa.TW10@Piirr„mme L„mp”- ja Sade-muuttujien jakaumat rinnakkain.TW10@GHISTO HELSINKI,L„mp”TW5@  / Tulosrivi puuttuu.TW10@ Ei siis tuloksia kentt„„n.TW10@L„mp”=10(0.5)24TW5@  HEADER=Keskil„mp”tilan_jakaumaTW10@HOME=0,0TW5@ SIZE=319,349TW5@ OUTFILE=ATW10@TW10@€TW10@.±TW5@¹TW5@¹TW5@¹TW5@TW5@¹TW5@TW5@TW5@SadeTW10@TW5@TW5@Sade=0(10)240TW5@  HEADER=Sadem„„r„n_jakaumaTW10@TW10@32TW10@TW10@INTW10@º  WAIT=10TW10@€TW10@Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@@Ta1@BGPLOT /DEL ALL€Ta-1@Tp@0T!1@C3@TLHIST@Tÿ

Ta1@SCRATCH€üGPLOT /DEL ALL€Bü   µµµµ Normaalijakauman sovittaminen Ta-1@TW10@   Tarkastelemme j„lleen Helsingin hein„kuun keskil„mp”tilan jakaumaatiedostossa HELSINKI.TW10@Ta1@>COPY HELSINKI HELSINKI.SVO€Ta-1@TW10@   GHISTO-operaatiolla piirrett„v„„n histogrammaan voidaan sovittaaerilaisia teoreettisia jakaumia.TW10@ Se tapahtuu antamalla FIT-t„smennys.TW10@T„ss„ tapauksessa kannattaa kokeilla normaalijakaumaa:TW10@GHISTO HELSINKI,L„mp”,0RT=1@1@+@C5@=TW10@L„mp”=10(0.5)24TW10@FIT=NormalTW5@   /  Sovitetaan normaalijakauma.TW10@          WAIT=10TW10@€TW30@TW50@   Tulostaulukon lopussa n„kyy sovitettu jakauma parametreineenTW5@ sek„Khi-neli”-testisuure vapausasteineen ja P-arvoineen.TW10@ T„ss„ tapauksessayhteensopivuus on varsin hyv„.TW10@ Ei ole mit„„n syyt„ ep„ill„,TW5@ etteik”keskil„mp”tilan jakauma voisi olla normaalinen.TW10@ Sama seikka ilmenimy”s kuvasta,TW5@ jossa jakauman tiheysfunktio osui yhteen histogrammankanssa.TW10@TW10@TW5@TW10@   Taulukossa ovat aikaisempien tietojen lis„ksi seuraavatyksityiskohdat:TW10@ Normaalijakauman mukaiset odotetut luokkafrekvenssitTW5@Ta1@¹¹¹ºTa-1@TW30@TW5@ja n„m„ yhdistettyin„ v„hint„„n 5 yksik”n kokoisiksi,TW5@Ta1@¹¹¹Ta-1@TW30@TW5@ vastaavatyhdistettyjen luokkien havaitut frekvenssitTW5@Ta1@¹¹¹º Ta-1@TW30@TW5@sek„ vastaavat Khi-neli”nluokittaiset komponentit,TW5@Ta1@¹¹¹º Ta-1@TW30@joiden summa on lopullinen testisuure.TW20@TW10@´++++++++++++=TW20@   .±TW10@   Kokeilemme samaa my”s sadem„„r„lle:TW10@GHISTO HELSINKI,Sade,0RT=1@1@+@C5@=TW10@Sade=-60(10)240TW5@ / Vaihteluv„li on valittava kyllin laveaksi.TW10@FIT=NormalTW5@    WAIT=10TW10@€TW30@TW20@CP w0w=TW30@   P-arvo = osoittaa,TW5@ ettei t„ss„k„„n tapauksessa ole syyt„hyl„t„ normaalisuushypoteesia.TW10@ Kuvastakin tosin n„kyi,TW5@ ettei yhteen-sopivuus sadem„„r„ll„ ollut yht„ hyv„ kuin keskil„mp”tilalla.TW10@   Kun piirr„mme kuvan viel„ uudelleen,TW5@ huomaamme, ett„ normaalijakauma-sovite edellytt„isi havaintoja l”ytyv„n my”s negatiiviselta puolelta.TW10@Ehk„ jotkut kes„t ovatkin niin kuivia,TW5@ ett„ todellinen sadem„„r„ onnegatiivinenTW5@ (kun kosteutta haihtuu).TW10@TW5@GHISTO HELSINKI,Sade  / Sade=-60(10)240 FIT=Normal FIELD=1 SIZE=639,250TW10@WAIT=10TW10@€TW10@Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@@Ta1@BGPLOT /DEL ALL€Ta-1@Tp@0T!1@C4@TLHIST@Tÿ

Ta1@SCRATCH€üGPLOT /DEL ALL€Bü   µµµµ Nopanheittokokeen testaus Ta-1@TW10@   Palaamme jo aikaisemmin esiteltyyn nopanheiton simulointiin.TW10@ Tarkoi-tuksena on testata,TW5@ onko saatu pistelukujen frekvenssijakauma tasainenyli vaihtoehtojen 1,2,3,4,5,6.TW10@   Aloitamme luomalla 300 havainnon aineiston.TW10@ Ensin perustetaantiedosto:TW10@FILE CREATE NOPPA,1,1TW5@FIELDS:1 N 1 XENDTW10@TW10@€TW10@FILE INIT NOPPA,300TW5@ / Tehd„„n tilaa 300 havainnolle.TW10@€TW10@VAR X=int(6*rnd(0)+1) TO NOPPA / Heitet„„n noppaa 300 kertaa!TW10@€TW10@.±   Teemme aluksi karkean yhteenvedon tuloksista STAT-operaatiolla:TW10@STAT NOPPA,0RT=1@1@+@C1@=TW10@€TW20@Ta1@TXK@0WxTIA1@C @GK@@GK@Ta-1@.±WW0wwwwwwTW30@   Eri pistem„„rien havaitut frekvenssit olivat =,@2,@3,@4,@5 ja @6.TW20@Keskim„„rin frekvenssin pit„isi olla kullakin pisteluvulla 300/6=€º.TW10@Ta1@üüT!7@1@T!8@C1@T!9@1@T!10@C1@TIN2@7@GB2@GB2@@T!7@2@T!8@C2@TXB2@TIN2@9@@GA3@GA3@T!9@2@T!10@C2@TXA3@TIN3@7@GB3@GB3@@T!7@3@T!8@C3@TXB3@TIN3@9@@GA4@GA4@T!9@3@T!10@C3@TXA4@TIN4@7@GB4@GB4@@T!7@4@T!8@C4@TXB4@TIN4@9@@GA5@GA5@T!9@4@T!10@C4@TXA5@TIN5@7@GB5@GB5@@T!7@5@T!8@C5@TXB5@TIN5@9@@GA6@GA6@T!9@5@T!10@C5@TXA6@TIN6@7@GB6@GB6@@T!7@6@T!8@C6@TXB6@TIN6@9@@GA7@GA7@T!9@6@T!10@C6@TXA7@üT=11@9@+@C6@Ta-1@TIN11@7@GC1@@@   Pisteluvut ovat yll„tt„v„n tasaisia.TW10@TLGC2@TXC1@   V„hiten (@9 kpl.) esiintyy pistelukua @:TW10@ ja eniten (@7 kpl.)pistelukua @8.TW20@TXC2@   Katsotaan, mit„ HISTO-ohjelma sanoo t„st„ tilanteesta.TW10@GHISTO NOPPA,X,CUR+5TW10@X=0.5(1)6.5   /   Luokkakeskukset 1,2,3,4,5,6TW10@XSCALE=0.5:_,1(1)6,6.5:_  / V„lill„ (0.5,6.5) merk. pisteet 1,2,3,4,5,6TW10@FIT=Uniform(0.5,6.5)  / Sovitetaan tasainen jakaumaTW10@     WAIT=10TW10@€TW20@C= 0w=CP w=TW30@   Khi-neli”-testisuureen arvo on =,TW5@ mik„ vapausasteilla 5 (df)antaa P-arvon @2 .TW20@TIN2@C0.001@GP1@@@TIN2@C0.01@GP2@@@TIN2@C0.05@GP3@@@TIN2@C0.10@GP4@@@TIN2@C0.20@GP5@@@TIN2@C0.99@@@GP6@TIN2@C0.95@@@GP7@TIN2@C0.80@@@GP8@   Kysymyksess„ on hyvin tavanomainen tilanne.TW10@ Tulos on t„ysin odotetunkaltainen.TW10@TLGQ@TXP1@   T„llainen tulos on hyvin harvinainen.TW10@ Noppa hyl„tt„isiin ilman muuta.TW10@TLGQ@TXP2@   Tulokset yll„tt„v„n ep„tasaiset.TW10@ Hypoteesi, ett„ noppa on oikea,hyl„tt„isiin riskitasolla 0.01 .TW10@TLGQ@TXP3@   Pistem„„rien jakauma on melko ep„tasainen.TW10@ Nopan oikeellisuushyl„tt„isiin riskitasolla 0.05 .TW10@TLGQ@TXP4@   Tulos liev„sti ep„tasainen.TW10@ Ei kuitenkaan syyt„ ep„ill„ noppaavirheelliseksi.TW10@TLGQ@TXP5@   Vaikka tuloksissa hieman ep„tasaisuutta,TW5@ tilanne aivan normaali.TW10@TLGQ@TXP6@   N„m„ frekvenssit ovat ep„ilytt„v„n tasaisia.TW10@ Saattaisi ajatella, ett„tuloksia on "kaunisteltu" j„lkik„teen.TW10@TLGQ@TXP7@   Tulokset vaikuttavat liian siisteilt„. Yleens„ jakauma on selv„stiep„tasaisempi.TW10@TLGQ@TXP8@   Hiukan tasaisen tuntuinen lopputulos,TW5@ mutta ei mitenk„„n ep„ilytt„v„.TW10@TXQ@   T„m„ sukro kannattaa katsoa useita kertoja,TW5@ jotta n„kisit, mitentulokset vaihtelevat arvonnasta toiseen.TW10@Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@@Ta1@BGPLOT /DEL ALL€Ta-1@Tp@0T!1@C5@TLHIST@Tÿ


 Etsit„„n minimi ja maksimi

Ta1@SCRATCH€üGPLOT /DEL ALL€Bü   µµµµ Osaatko matkia sattumaa?    Edellisess„ sukrossa annettiin Survon simuloida nopanheittoa jatestattiin sitten Khi-neli”-testill„, ovatko tulokset riitt„v„nsatunnaisia ja jakautuvatko ne tasaisesti pistelukujen 1,2,3,4,5,6osalle. Jos toistat tuon sukron useita kertoja, saatat havaita, ett„tulosten joukkoon pujahtaa aina sellaisia, jotka ovat joko liiankaukana tasaisesta jakaumasta tai my”s sellaisia, jotka ovat "liianhyvi„". Esim. jos joku kertoo heitt„neens„ noppaa 300 kertaa ja saa-neensa jokaista pistem„„r„„ yht„ paljon eli 50 kpl., moni suhtautuut„h„n ep„luulolla, vaikka kysymyksess„ on juuri kaikkein todenn„k”isintulos. Ep„luulolle on katetta sik„li, ett„ ko. heittosarjan toden-n„k”isyys on eritt„in pieni. Se on t„sm„lleen 300!/(50!)^6*(1/6)^300eli logaritmien kautta laskettuna       exp(fact.l(300)-6*fact.l(50)+300*log(1/6))=€º .Siis suunnilleen vain yksi heittosarja miljoonasta on t„ysin tasainen.   Tieteen historia tuntee tapauksia, joissa tutkija on kaunistellutja tasoitellut koetuloksiaan parantaakseen teoriansa uskottavuutta.Tilastollisilla testeill„ on voitu paljastaa t„llaisia huijauksia.   Vaatii jonkin verran kokemusta, jotta n„kisi suoraan, millaisettulossarjat ovat tyypillisi„. Saat nyt tilaisuuden koetella kykyj„sisatunnaisuuden matkimisessa.Tp        Jatka painamalla ENTER!@TVC1200@_@GA@TXA@Tp@.±   Teht„v„n„si on kuvitella tyypillisen nopanheittosarjanfrekvenssijakauma heittokertojen m„„r„n N ollessa tiedossa. Kun oletantanut kunkin pisteluvun frekvenssin, katsomme Khi-neli”-testill„,miten tyypillisen tuloksen olet ilmoittanut.   Muista, ett„ tyypillinen heittosarja ei ole liian tasainen eik„liian ep„tasainen. Tulkitsemme sellaisten tulosten, joiden P-arvo onl„hell„ puolikasta, edustavan tyypillist„ heittosarjaa.   Jotta teht„v„„n tulisi hieman vaihtelevuutta, arvomme kokonaisluvunN satunnaislausekkeena N=30+6*int(abs(100*(rnd(0)+rnd(0)-1))) ,jolloin keskim„„r„inen yksitt„isen pistem„„r„n frekvenssi on K=N/6 .Tp        Jatka painamalla ENTER!@TVC1200@_@GB@TXB@Tp@Ta-1@¶TXU@Ta1@SCRATCH €   Koe alkaa:                (Kuhunkin vastaukseen on aikaa 30 sek.)TW10@0Heittokertojen m„„r„ N.=     (pistelukua kohti keskim„„rin K.=€º )C= w=C= w=Ta-1@TW20@T!3@C0@T!4@C0@Ta1@TXP1@TZ5@T!4@3@Ykk”sten  lukum„„r„ ? TKC300@@C@3@T=4@4@+@5@TIA5@C@@GE1@@TIN5@C0@GP1@@@TIN4@1@@@GP1@T!3@4@@5			J„ljell„ T=4@1@-@3@@4TW10@TXP2@TZ6@T!4@3@Kakkosten lukum„„r„ ? TKC300@@C@3@T=4@4@+@6@TIN6@C0@GP2@@@TIN4@1@@@GP2@T!3@4@@6			J„ljell„ T=4@1@-@3@@4TW10@TXP3@TZ7@T!4@3@Kolmosten lukum„„r„ ? TKC300@@C@3@T=4@4@+@7@TIN7@C0@GP3@@@TIN4@1@@@GP3@T!3@4@@7			J„ljell„ T=4@1@-@3@@4TW10@TXP4@TZ8@T!4@3@Nelosten  lukum„„r„ ? TKC300@@C@3@T=4@4@+@8@TIN8@C0@GP4@@@TIN4@1@@@GP4@T!3@4@@8			J„ljell„ T=4@1@-@3@@4TW10@TXP5@TZ9@T!4@3@Viitosten lukum„„r„ ? TKC300@@C@3@T=4@4@+@9@TIN9@C0@GP5@@@TIN4@1@@@GP5@T!3@4@@9			J„ljell„ T=4@1@-@3@@4TW10@T!10@4@Kuutosten lukum„„r„ksi j„„ t„ll”in @:.Ta-1@TW30@Ta1@Khi-neli”-testisuure onTW5@Khi2=K1+K2+K3+K4+K5+K6 miss„TW5@K1=(@5-@2)^2/@2  K2=(@6-@2)^2/@2K3=(@7-@2)^2/@2  K4=(@8-@2)^2/@2K5=(@9-@2)^2/@2  K6=(@:-@2)^2/@2ja riskitaso P=1-Chi2.F(df,Khi2) vapausasteilla df=5T„ss„ tapauksessa Khi2.=                    P.=€C= TZ11@w=C= w=ºCexTa-1@   TIA13@Ce@@GR1@@TIN12@C0.001@GR1@@@TIN12@C0.01@GR2@@@TIN12@C0.1@GR3@@@TIN12@C0.2@GR4@@@TIN12@C0.3@GR5@@@TIN12@C0.999@@@GR6@TIN12@C0.99@@@GR7@TIN12@C0.9@@@GR8@TIN12@C0.8@@@GR9@TIN12@C0.7@@@GR10@TIN11@2@GS1@@@   Ehdotuksesi on varsin kelvollinen.TLGJ@TXS1@T„m„ on hyvin tyypillinen tulosten jakauma.TLGJ@TXR1@N„in ep„tasainen tulos on hyvin harvinainen.TLGJ@TXR2@T„t„ ei voi pit„„ lainkaan tyypillisen„ tuloksena.TLGJ@TXR3@Tulossarjasi ei ole kovin tyypillinen.TLGJ@TXR4@Kuvitelmasi poikkeaa hieman ep„tasaiseen suuntaan.TLGJ@TXR5@T„m„ ei poikkea paljonkaan tyypillisest„ tuloksesta.TLGJ@TXR6@Tulossarja on aivan liian tasainen. Yrititk” tosissasi?TLGJ@TXR7@T„m„ on ep„ilytt„v„n siisti tulossarja.TLGJ@TXR8@Ehdotuksesi poikkeaa jonkin verran liikaa tasaiseen p„in.TLGJ@TXR9@Ehk„ hieman tasaisen tuntuinen kuvitelma.TLGJ@TXR10@Ei aivan tyypillinen, mutta silti mahdollinen tulos.TLGJ@ TW10@TXJ@0Haluatko yritt„„ uudelleen (K/E)? TKC300@@CE@1@=TJ1@E@K@k@@GE@GU1@GU1@@TXU1@¶TLGU@TXE1@Ta-1@Et vastannut mit„„n.TW10@TLGJ@TXE@Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@@Ta1@BGPLOT /DEL ALL€Ta-1@Tp@0T!1@C6@TLHIST@Tÿ

Ta1@SCRATCH€üGPLOT /DEL ALL€Bü   µµµµ Kirjainten jakaumat kuntien nimiss„    Otamme tarkastelun kohteeksi eri kirjainten frekvenssit KUNNAT-aineiston kuntien nimiss„. Kirjaimet eiv„t miss„„n luonnollisessakieless„ esiinny sattumanvaraisesti. Jos esim. jokin suomen kielen sanaalkaa A-kirjaimella, on syyt„ olettaa, ett„ sanassa on muitakinA-kirjaimia suuremmalla todenn„k”isyydell„ kuin siin„ tilanteessa, ett„sana alkaa esim. E-kirjaimella.   Tutkiessamme eri kirjaimia voimme silti kokeilla, miten Poisson-jakauma kuvaa niiden esiintymist„ nimiss„. T„m„ jakauma toimii hyvinsilloin, jos sanoja synnytett„isiin arpomalla kirjain kirjaimeltasiten, ett„ joka kirjaimella on oma vakiotodenn„k”isyytens„.Tp        Jatka painamalla ENTER!@TVC1200@_@GA@TXA@Tp@Ta-1@   Aloitamme siirt„m„ll„ kuntien nimet tiedostosta KUNNAT toimitus-kentt„„n.TW10@FILE LOAD KUNNAT.  /  VARS=KuntaTW10@€TW30@º Annamme taulukolle mukavamman nimen KUNNAT2TW5@ ja nime„mmekirjainkohtaista frekvenssi„ varten muuttujan NK.TW20@TW10@2TW10@		TW10@NKTW10@   Voisimme nyt kirjoittaa NK-sarakkeeseen esim. A-kirjaimen frekvens-sej„TW10@		TW10@2TW5@TW5@2TW5@TW5@3TW5@TW5@3TW5@TW5@2TW10@ºTW5@, mutta se on ik„v„„ ja hidasta ty”t„.TW10@ Sen vuoksi olemme tehneetapusukron NKIRJAIN,TW5@ joka toimii n„in:TW10@TW10@TW10@/NKIRJAIN aTW10@Tp        Sukro NKIRJAIN laskee A-kirjaimien lukum„„ri„...@€Tp@TW30@.±   Komennolla /NKIRJAIN aTW10@   , joka kirjoitettiin nimisarakkeen yl„puo-lelle,TW5@ laskettiin uusi sarake (NK),TW5@ jossa on nimien sis„lt„mien merkkiena ja A lukum„„r„t.TW20@.±   Tutkimme muuttujan NK jakaumaa seuraavalla GHISTO-kaaviolla:TW10@GHISTO KUNNAT2,NK,0RT=1@1@+@C5@=TW10@NK=-0.5(1)10.5TW5@   /  Luokkakeskukset 0,1,2,...,10TW10@          WAIT=10FIT=PoissonTW5@      /  Sovitetaan Poisson-jakaumaTW10@MINF=3TW5@           /  Luokkia yhdistett„ess„ minimifrekvenssi on 3.TW10@TW10@€TW50@   A-kirjainten jakauma n„ytt„„ olevan varsin kaukana Poisson-jakau-mastaTW5@ ja syykin on ilmeinen.TW10@ Nimi„, joissa on vain 1 A-kirjain,TW5@ onPoisson-jakaumaan verrattuna selv„sti v„hemm„nTW5@ ja nimi„,TW5@ joissa onyli 2 A-kirjainta,TW5@ on sit„ vastoin odotettua enemm„n.TW10@Siis A-kirjaimet eiv„t jakaudu nimiss„ kovin satunnaisesti.TW20@.±   Tehd„„n sama tutkimus E-kirjaimelle:TW10@TW20@eTW10@Tp        Sukro NKIRJAIN laskee E-kirjaimien lukum„„ri„...@€Tp@TW10@TW5@¹TW5@¹ºTW5@¹TW5@TW5@¹TW5@TW10@0RT=1@1@+@C5@=TW10@€TW20@TW30@   Tulos on aivan p„ivastainen.TW10@ E-kirjaimien jakauma n„ytt„„ noudattavaneritt„in tarkasti Poisson-jakaumaa.TW30@   Kannattaa kokeilla muitakin kirjaimiaTW5@ ja mietti„ syit„ siihen,TW5@miksi tietyt kirjaimet (esim. E,K ja M) toimivat Poisson-jakaumanmukaisestiTW5@ ja toiset (esim. A,I ja L) eiv„t.TW10@   Tutki my”s toisia nimi- tai sanaluetteloita vastaavalla tavalla.TW10@Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@@Ta1@BGPLOT /DEL ALL€Ta-1@Tp@0T!1@C7@TLHIST@Tÿ

Ta1@SCRATCH€üGPLOT /DEL ALL€Bü   µµµµ Oman jakauman sovittaminen    HISTO-operaation tuntemien perusjakaumien (NORMAL, LOGNORMAL,UNIFORM, BINOMIAL ja POISSON) lis„ksi on empiiriseen jakaumaanmahdollista sovittaa my”s k„ytt„j„n itse m„„rittelemi„ jatkuvia jadiskreettej„ jakaumia.   T„ss„ sukrossa esitell„„n diskreetin geometrisen jakaumansovittamista.   Oletetaan, ett„ toistetaan koetta, jossa yksitt„isen yrityksenonnistumistodenn„k”isyys on p, niin monta kertaa, ett„ onnistutaanensimm„isen kerran. T„ll”in turhien yrityskertojen lukum„„r„ Xnoudattaa geometrista jakaumaa Geom(p) ja muuttujan X mahdollisetarvot ovat 0,1,2,...,n,... todenn„k”isyyksin p, p*(1-p), p*(1-p)^2,...,p*(1-p)^n,...   Kokeilemme µµµµ geometrisen jakauman µµµµ sovittamista keinotekoiseenaineistoon, joka uudistuu aina, kun k„yt„mme t„t„ sukroa. T„ss„aineistossa simuloidaan nopanheittoa ja katsotaan, kuinka montaheittoa tarvitaan, ennen kuin saadaan ensimm„inen kuutonen.Kysymyksess„ on silloin jakauma Geom(1/6).Tp        Jatka painamalla ENTER!@TVC1200@_@GA@TXA@Tp@Ta-1@.±   Vaikka geometrista jakaumaa voisi simuloida tehokkaamminkin,TW5@havainnollistamme asiaa m„„rittelem„ll„ satunnaismuuttujan Noppa:TW10@Noppa=int(6*rnd(0)+1)TW10@ja "heit„mme Noppaa",TW5@ kunnes saamme ensimm„isen kuutosen:TW10@TXN0@0T!1@C0@TXN1@T=1@1@+@C1@Heitto =: Noppa=€TZ2@xTIN2@C6@GN1@@GN1@   Saimme ensimm„isen kuutosen TIN1@C1@@GN2@@heitolla =TLGN3@TXN2@heti ensimm„isell„ heitollaTXN3@,TW5@joten turhien yritysten m„„r„ eli satunnaismuuttujan X arvo olisi T=2@1@-@C1@@2.TW10@TIN1@C1@@@GN4@   Kokeilemme uudelleen:TW10@TLGN0@TXN4@.±ü   Heitt„k„„mme nyt noppaa niin kauan,TW5@ ett„ saamme 50 havaintoamuuttujalle X.TW10@ Apusukro NOPPA6 tuottaa t„m„n aineiston n„in:TW10@/NOPPA6 50TW10@Tp        Sukro NOPPA6 heitt„„ toistuvasti noppaa, kunnes saadaan 6...@€Tp@TW10@   Yll„ on kahdessa riviss„ 50 havainnon aineisto,TW5@ jolle annammenimen X.TW10@TW10@TW5@DATA X:TW10@.±   Histogramman piirtoa ja geometrisen jakauman sovitusta vartenkirjoitamme kaavion:TW10@GHISTO X,X,0RT=1@1@+@C10@=TW10@X=-0.5(1)50.5TW5@    /  Luokkakeskuksina 0,1,2,...,50TW10@     WAIT=10FIT=Geom(0.1667)TW5@ /  Sovitetaan jakauma Geom(1/6),TW5@ joka kuvataan		alla olevalla m„„ritelm„ll„:TW10@PROBABILITY Geom(p)TW10@Y(X)=if(X>=0)then(p*(1-p)^X)else(0)TW10@TW10@€TW30@TW10@³Mean 0w=CP w=üLoint(100*=+0.5)/100=€ i1wL0üTW20@   Tehdyiss„ 50 kokeessa tarvittiin keskim„„rin = yrityst„,TW5@ ennenkuin saatiin ensimm„inen kuutonen.TW10@ Teoreettinen odotusarvo on 5.TW10@TIN1@C7@@GM1@GM1@TIN1@C6@@GM2@GM2@TIN1@C3@GM3@GM3@@TIN1@C4@GM4@GM4@@Keskiarvo on siis odotetun kaltainen.TLGMJ@TXM1@Keskiarvo on yll„tt„v„n suuri.TLGMJ@TXM2@Keskiarvo vaikuttaa hieman suurelta.TLGMJ@TXM3@Keskiarvo on ep„ilytt„v„n pieni.TLGMJ@TXM4@Keskiarvo on jonkin verran odotettua pienempi.TLGMJ@TXMJ@TW10@   Khi-neli”-testin P-arvo @2 osoittaa,TW5@ ett„TIN1@C0.9@@@GP1@TIN1@C0.7@@@GP2@TIN1@C0.01@GP3@@@TIN1@C0.05@GP4@@@TIN1@C0.1@GP5@@@TIN1@C0.2@GP6@@@TXP1@aineisto sopii malliin eritt„in hyvin.TLGPJ@TXP2@aineiston ja mallin yhteensopivuus on eritt„in selv„.TLGPJ@TXP3@aineisto poikkeaa mallista yll„tt„v„n paljon.TW10@ N„inkin voi sattua!TLGPJ@TXP4@aineistoa ei pidett„isi geometrisesti jakautuneena riskitasolla 0.05 .TW10@Kuitenkin joka 20. otos keskim„„rin saa P-arvon,TW5@ joka on alle 0.05.TLGPJ@TXP5@aineisto poikkeaa jonkin verran geometrisesta jakaumasta.TLGPJ@TXP6@aineisto poikkeaa vain hieman odotetun kaltaisesta.TLGPJ@TXPJ@TW10@   Edell„ oletimme onnistumistodenn„k”isyyden p tunnetuksi (p=1/6).TW10@Yrit„mme nyt vaikeampaa teht„v„„.TW10@ Annamme HISTO-operaation itsem„„r„t„ sopivimman arvon ns. suurimman uskottavuuden menetelm„ll„.TW10@T„ll”in joudutaan k„ytt„m„„n askeltavaa laskutapaa,TW5@ joka onhuomattavasti hitaampiTW5@ ja jolle tulee antaa sopivat alkuarvot:TW50@³GHISTOTW10@TW10@        TW10@TW10@TW10@INIT=0.2 STEP=0.01TW5@   /  p:n alkuarvo ja askelv„liTW10@MAXNF=200TW5@            /  Iteraatioiden maksimim„„r„TW10@SCRATCH TW5@€TW5@TW10@€TW30@ w=üC(LR1 º w)Lr1(üTW10@TW5@TW10@ACCURACY=4   Ennen frekvenssitaulukkoa ovat parametrin p estimaatti @3TW5@ja sen keskivirhe sp=@4 .TW10@ Koska estimaattorin jakauma onlikimain normaalinen,TW5@ voimme n„iden perusteella muodostaa esim. 95%:nluottamusv„lin (ala_p,yl„_p),TW5@ miss„ ala_p=N.G(p,sp^2,0.025) jayl„_p=N.G(p,sp^2,0.975) .TW20@ T„ss„ tapauksessa ala_p=€ w=ºTW10@ jayl„_p=€ w=º ,TW10@ joten oikea p:n arvo 1/6=€TIN5@C0.167@@@GR1@TIN6@C0.166@GR1@@@lankeaaTLGR2@TXR1@ei valitettavasti osuTXR2@ 95%:n luottamusv„lille (@5,@6).TW60@TW10@³MeanTW10@   Koska geometrisen jakauman ominaisuudet tunnetaan hyvin,TW5@ „skeineniteratiivinen ratkaisu p:n estimoimiseksi (arvioimiseksi) oli osittaintarpeeton.TW10@ Tied„mme, ett„ jakauman Geom(p) odotusarvo on (1-p)/p,TW5@jonka arvioksi k„y luonnollisesti keskiarvo Mean=€º .TW10@T„ll”in hyv„ arvio p:lle onTW5@ (ratkaise p yht„l”st„ (1-p)/p=Mean)TW5@1/(Mean+1)=€º ,TW5@ jonka pit„isi vastata iteratiivisesti laskettuaestimaattia @3 .TW20@   Yleisemmiss„ ongelmissa ei ole oikoteit„ ja on valittava iteratii-vinen ratkaisutapa.TW10@Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@@Ta1@BGPLOT /DEL ALL€Ta-1@Tp@0T!1@C8@TLHIST@Tÿ


 Muutos 15.1.1996/SM

 Muutos 15.1.1996

Ta1@SCRATCH€üGPLOT /DEL ALL€Bü   µµµµ Tyt”t ja pojat sekaisin    Er„s tilastollisen tutkimuksen painajainen on useanlaatuistenhavaintojen sotkeutuminen samaan aineistoon, jolloin on hyvin vaikeaerottaa eri havaintotyyppej„ toisistaan ja n„in ollen my”s hankalatehd„ mit„„n kunnollisia p„„telmi„.   Esimerkkin„ saatamme ajatella, ett„ on ker„tty "tytt”j„" ja "poikia"koskeva otos, jossa on tiedossa kunkin pituus, mutta ei sit„, onkokulloinkin kysymyksess„ tytt” vai poika. Tulemme nyt luomaan sekoi-tetun 500 havainnon aineistoa, jossa on noin 70% tytt”j„ ja 30%poikia. Oletamme tytt”jen pituuden noudattavan normaalijakaumaakeskiarvolla 150 ja hajonnalla 5 sek„ poikien pituuden vastaavaajakaumaa keskiarvolla 170 ja hajonnnalla 6.   N„yt„mme, ett„ vaikka emme tied„ muuta kuin, ett„ aineisto saattaaolla kahden normaalijakauman sekoitus tuntemattomassa suhteessa,pystymme HISTO-operaatiolla tunnistamaan osajakaumat joltisellakintarkkuudella ja arvioimaan kummankin sukupuolen tunnusluvut.Tp        Jatka painamalla ENTER!@TVC1200@_@GA@TXA@Tp@Ta-1@.±   Aloitamme piirt„m„ll„ tarkastelun kohteena olevien jakaumientiheysfunktiot samaan kuvaan siten,TW5@ ett„ sekoitussuhde 70:30 onotettu huomioon.TW10@Tytt”jen tiheysfunktio:TW5@m1=150 s1=5TW10@			WAIT=10GPLOT Y(X)=exp(-0.5*((X-m1)/s1)^2)TW5@  /  INTEGRAL=0.7TW10@XSCALE=100(10)250 YSCALE=0(0.01)0.1 OUTFILE=ATW10@HEADER=TW5@TW10@€TW10@.±Poikien tiheysfunktio:TW5@TW5@¹TW5@¹TW5@TW5@¹TW5@TW5@¹TW5@TW5@m2=170 s2=6TW10@TW5@2TW5@TW5@2TW5@ºTW5@3TW5@ºTW5@ INFILE=ATW10@TW10@€TW10@.±   Se mit„ todella tulemme havaitsemaan,TW5@ on n„iden jakaumien f1,f2sekoitus p*f1+(1-p)*f2,TW5@ miss„ p=0.7 .TW10@HEADER=Sekoitetun_normaalijakauman_tiheysfunktioTW10@          WAIT=10GPLOT Y(X)=p*f1+(1-p)*f2  /  INTEGRAL=1TW10@   f1=1/s1*exp(-0.5*((X-m1)/s1)^2)  m1=150 s1=5TW10@   f2=1/s2*exp(-0.5*((X-m2)/s2)^2)  m2=170 s2=6TW10@XSCALE=100(10)250 YSCALE=0(0.01)0.1 INFILE=ATW5@X=[PUNAINEN][viivanleveys(3)],100,250TW10@TW10@€TW10@   Vaikka jakaumien huiput erottuivatkin hyvin t„st„ kuvastaTW5@, eivastaavaa empiirist„ aineistoa ole helppo k„sitell„.TW10@.±   Luomme nyt koeaineistomme perustamalla ensin tiedostonTW5@FILE CREATE SEKOITUS,5,2TW5@FIELDS:TW5@1 N 1 S        Sukupuoli: 1=tytt” 2=poikaTW10@2 N 4 PituusTW5@ENDTW5@TW10@€TW10@ja varaamme tilaa 500 havainnolle:TW10@FILE INIT SEKOITUS,500TW10@€TW10@   Oletustemme mukaisia havaintoja muodostetaan seuraavalla VAR-kaaviolla:TW10@VAR S,Pituus TO SEKOITUSTW5@   S=if(rnd(1)<0.7)then(1)else(2)TW5@   Pituus=if(S=1)then(Tytt”)else(Poika)TW5@   Tytt”=150+5*probit(rnd(1))TW5@   Poika=170+6*probit(rnd(1))TW30@TW10@€TW20@.±D¶   STAT-operaatio antaa alustavan k„sityksen aineistosta:TW10@STAT SEKOITUS,0RT=1@1@+@C1@=TW10@€TW30@TW5@TW10@   Sukupuolijakauma lienee odotetun kaltainen.TW10@Ta1@TXC@0WxTIA1@C @GC@@GC@Ta-1@   Pituuden jakauma n„ytt„„ t„ss„ karkeassa histogrammassa ainakinliev„sti kaksihuippuiselta.TW10@   Laskemme tunnusluvut ja frekvenssijakauman erikseen tyt”ilt„:TW10@STAT SEKOITUS,0RT=1@1@+@C1@=TW5@  /  IND=S  (siis ehdolla S=1)TW10@€TW20@Ta1@TXD@0WxTIA1@C @GD@@GD@Ta-1@   Tytt”jen pituuden jakauma n„ytt„„ selv„sti normaaliselta.TW30@.±   Tarkastamme t„m„n viel„ HISTO-operaatiolla:TW10@               WAIT=10GHISTO SEKOITUS,Pituus,0RT=1@1@+@C4@=TW5@  /  IND=S  (vain tyt”t)TW10@Pituus=120(2)180TW5@FIT=NormalTW10@TW10@€TW20@Ta1@TXF@0WxTIA1@C @GF@@GF@Ta-1@CP 0w=TW30@   P-arvo = osoittaa,TW5@ ett„TIN1@C0.05@GP1@@@TIN1@C0.10@GP2@@@jakauman normaalisuutta ei ole syyt„ ep„ill„.TLGPJ@TXP1@yll„tt„v„„ kyll„, jakauma ei vaikuta normaaliselta.TLGPJ@TXP2@normaalijakauman yhteensopivuus ei ole kovin hyv„.TLGPJ@TXPJ@TW40@.±   Tilanne muuttuu huomattavasti vaikeammaksi,TW5@ jos tieto havainnontyypist„ (S=1 tai 2) on j„„nyt rekister”im„tt„.TW10@ Katsomme nyt, mit„voimme tehd„ siin„ tilanteessa.TW30@¶TW10@SCRATCH / H„vit„mme alla olevat tulokset!TW30@€TW10@   Yrit„mme sovittaa normaalijakaumaa koko aineistoon:TW10@GHISTO SEKOITUS,Pituus,END+2TW5@Pituus=100(2)250  XSCALE=100(10)250 YSCALE=0(10)80TW5@FILL=4  (keltaiset pylv„„t)TW5@FIT=[SININEN][viivanleveys(3)],NORMALTW20@TW10@€TW30@Ta1@TXG@0WxTIA1@C @GG@@GG@Ta-1@CP 0w=TW30@   P-arvo = osoittaa,TW5@ ett„TIN1@C0.01@GQ1@@@TIN1@C0.05@GQ2@@@eritt„in yll„tt„v„sti normaalisuushypoteesia ei hyl„tt„isik„„n!TLGQJ@TXQ1@jakauma odotetusti on kaukana normaalisesta.TLGQJ@TXQ2@jakauma poikkeaa selv„sti nomaalijakaumasta.TLGQJ@TXQJ@TW30@TW5@¶¶TW20@TW5@   Kokeilemme sitten sekoitetun normaalijakauman sovitusta:TW10@TW5@SCRATCH TW20@€TW10@TW5@TW5@MIXNORMTW10@Sekoitettu normaalijakauma MIXNORM m„„ritell„„n n„in:TW10@DENSITY MIXNORM(p,m1,s1,m2,s2)TW10@y(x)=c*(p/s1*exp(-0.5*((x-m1)/s1)^2)+(1-p)/s2*exp(-0.5*((x-m2)/s2)^2))TW10@miss„ c=1/sqrt(2*pi)TW5@ pi=3.14159265TW5@ eli c=TW5@€TW10@°TW5@TW5@TW5@°TW10@Iteratiivista ratkaisua varten tarvitaan mielell„„n hyv„t alkuarvotTW10@INIT=0.6,140,4,180,7TW10@ja kullekin parametrille sopiva askelv„liTW10@STEP=0.05,1,0.1,1,0.1TW10@sek„ iteraatioden maksimim„„r„ MAXNF=100 .TW20@Laskentaprosessi on eritt„in raskas,TW5@ joten varaudu odottamaan...TW10@TW10@€TW20@TW50@TW5@TW5@TW10@   Tulosten alussa n„kyv„t parametrien estimaatit suluissa olevinekeskivirheineenTW5@ ja estimaattien v„liset korrelaatiokertoimet.TW30@Ta1@TXH@0WxTIA1@C @GH@@GH@Ta-1@CP 0w=TW30@   P-arvo = osoittaa,TW5@ ett„TIN1@C0.01@GR1@@@TIN1@C0.05@GR2@@@TIN1@C0.10@GR3@@@TIN1@C0.30@GR4@@@sovitus on onnistunut eritt„in hyvin.TLGRJ@TLGQJ@TXR1@t„ss„ tapauksessa yll„tt„en emme saaneet sovitusta onnistumaan.TLGRJ@TXR2@yhteensopivuus n„ytt„„ aika heikolta.TLGRJ@TXR3@sovitus ei ole kovin hyv„.TLGRJ@TXR4@sovitus on onnistunut kohtalaisen hyvin.TLGRJ@TXRJ@TW30@Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@@Ta1@BGPLOT /DEL ALL€Ta-1@Tp@0T!1@CX@TLHIST@Tÿ

