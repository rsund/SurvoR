SURVO 84C SUCROS@  10@TNL1         207@MY          1930@KOLIKOT    21369@TOISTO     35260@TEMPPELI   51654@NOPPA      67276@OTOKSET    80054@KULKU      88963@WKUVA1    106319@AA_AB     107505@TÿTa1@SCRATCH €   µµµµ Todenn„k”isyyksien laskentaa ja arviointia: Yleist„ Matemaatikon ja tilastotieteilij„n ammattikuvaan kuuluvilla aloillakohdataan teht„vi„, joissa ei riit„ se, ett„ µµµµµtiet„„µµµ miten lasketaan vaantulee todella µµµµµosataµµµ laskea. On my”s t„rke„t„, ett„ pystyy kohtuullisennopeasti ja hyvin arvioimaan erilaisten tapahtumien todenn„k”isyyksi„.Ihmisen luontainen taito on t„ss„ suhteessa kehnonlainen.Yleens„kin on vaikea hahmottaa suoraan, miten sattuma k„ytt„ytyyja mink„ n„k”isi„ tuloksia satunnaisilmi”iss„ esiintyy."Todenn„k”isyyksien laskemiselle" ei ole tarkoittamassani mieless„mit„„n yhten„ist„ teoriaa vaan alaan kuuluva tietous koostuuerilaisista ty”kaluista (kuten rekursiivinen laskenta ja generoivatfunktiot) ja nokkelista tempuista, joita aikojen kuluessa on keksitty.Erityisen kiinnostukseni kohteena ovat sellaiset tilanteet, joissaongelman ratkaisua ei voi esitt„„ "siistin„" lausekkeena vaanse joudutaan tekem„„n esim. algoritmisesti eli joko valmiin taiitse laadittavan tietokoneohjelman avulla.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@   µµµµ Todenn„k”isyyksien laskentaa ja arviointia: Yleist„ (jatkuu)Olen havainnut, ett„ Survo tarjoaa mukavan alustan monien aiheeseenkuuluvien teht„vien k„sittelylle. Olenkin kehitellyt er„it„ uusiatoimintoja n„ihin tarkoituksiin.T„ss„ jaksossa esiintyvist„ esimerkeist„ osa on syntynyt vuosina1998-9 Helsingin yliopiston tilastotieteen laitoksella pit„mi„nikursseja varten. Osa on tullut mukaan vasta j„lkeenp„in.Toukokuussa 2001Seppo MustonenüTp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@@Tp@Ta-1@0T!1@C2@TLTNLS@Tÿ
bTa1@TgC1@C1@C!@C1@C1@SCRATCH€   µµµµµµµ Maailman ymp„ri üüüTV1:ss„ perjantai-iltaisin k„yt„v„ss„ "Maailman ymp„ri"-kisassaparas kilpailijoista p„„see yritt„m„„n maailmanymp„rimatkaavastaamalla nelj„„ maata    Maa1 -> Maa2 -> Maa3 -> Maa4koskeviin kysymyksiin. Kussakin kysymyksess„ on kolme vastaus-vaihtoehtoa.Aluksi kysymysten kohteena on Maa1 ja siin„ pysyt„„n,kunnes kilpailija vastaa oikein, jolloin h„n p„„see vastaamaanMaa2-kysymyksiin.Vastatessaan v„„rin kilpailija putoaa takaisin edellist„ maatakoskeviin kysymyksiin. Kilpailijan on minuutin sis„ll„ kyett„v„kiipe„m„„n Maa4-tasolle ja vastaamaan siis oikein Maa3-kysymykseen.Jo t„m„ onnistuu, kello pys„ytet„„n ja kilpailija voi valita(viimeisen, lopulliseen voittoon johtavan) Maa4:n kohdallajoko "kerrasta poikki"-kysymyksen, jossa on kaksi vastaus-ehdotusta (tyyli A) tai jatkaa aikaisempaan tapaan j„ljellej„„neen ajan kuluessa (tyyli B).Tp        Jatka painamalla ENTER!@TVC18000@_@@Pohtikaamme, kannattaako kilpailijan koskaan valita j„lkimm„ist„vastaustyyli„.Koska jokaiseen kysymyssarjan alkup„„ss„ annettavaan kysymykseen javastaukseen kuluu keskim„„rin noin 7 sekuntia, kilpailijalla(vastatessaan suoraan oikein kolmeen ensimm„iseen kysymykseen) onenimmill„„n aikaa noin 40 sekuntia tyylill„ B.N„in parhaassakin tilanteessa pit„isi p„„st„ 6 kysymyksell„ maaliin.Jotta voisimme tehd„ arvioita, olettakaamme aluksi, ett„kilpailija toimii puhtaasti arvaamalla eli vastaa 3 vaihtoehdonkysymyksiin oikein todenn„k”isyydell„ 1/3 ja valitessaan "kerrastapoikki"-tyylin h„n voittaa suoraan todenn„k”isyydell„ 1/2.Riitt„„k” siis tylill„ B 6 kysymyst„ siihen, ett„ voittotodenn„k”isyysnousisi yli 1/2 ?Tp        Jatka painamalla ENTER!@TVC2400@_@@Katsokaamme, miten tuo todenn„k”isyys kasvaa.Kilpailija voittaa suoraan yhdell„ kysymyksell„ tn.ll„ 1/3.Jos h„n vastaa v„„rin (tn. 2/3), h„n p„„see maaliin kahdellaseuraavalla kysymyksell„ tn.ll„ (2/3)*(1/3)*(1/3)=2/27 elitilaisuus vastata kolmeen kysymykseen nostaa voittotodenn„k”isyydenarvoon 1/3+2/27=0.407...Kun merkit„„n p=1/3 ja q=2/3,viidell„ kysymyksell„ voittoon voi p„„st„  todenn„k”isyydell„q*p*q*p*p+q*q*p*p*p=0.0329... (miss„ p ja q samalla ilmaisevatyksitt„isiss„ kysymyksiss„ onnistumista ja ep„onnistumista).Siis viidell„ kysymyksell„ p„„st„„n voittoon n„in:Voitto         *       *Maa4      1 * *   2   *Maa3       * *     * *Maa2                *Maa1T„sm„lleen kuudella kysymyksell„ voittoa ei voi saavuttaa.Laskemalla yhteen saadaan todenn„k”isyys sille, ett„ kilpailijavoittaa, kun on aikaa 6 kysymykseen, todenn„k”isyydell„p+p^2*q+2*p^3*q^2=0.4403... Tyyli B ei siis t„ss„ mieless„ kannata.TVC2400@_@@Tp@Tilanne muuttuu, jos kilpailija ei pelk„st„„n arvaa, vaan saattaajopa tiet„„ joskus oikean vastauksen. Olettakaamme, ett„ tiet„misentodenn„k”isyys on x. T„ll”in 3 vaihtoehdon kysymyksen osaltaonnistumistodenn„k”isyys nousee arvoonp=x*1+(1-x)*(1/3) (kokonaistodenn„k”isyyden kaava)ja 2 vaihtoehdon tapauksessa arvoonp2=x*1+(1-x)*(1/2) .Siis esim. arvolla x=0.25 saadaan p=0.5 ja p2=0.625 .T„ll”in edellisen tarkastelun perusteella tyylill„ B voitetaan6 kysymyksen aikana todenn„k”isyydell„p+p^2*q+2*p^3*q^2=0.6875   q=1-peli suuremmalla kuin p2=0.625 ja t„ll”in tyyli B olisi jo A:ta parempi.Jos aikaa on vain 3 kysymykseen, B-tyylin voittotodenn„k”isyys olisip+p^2*q=0.625eli sama kuin A-tyylill„.Ta-1@Tp        Jatka painamalla ENTER!@TVC2400@_@@Ta1@µµµµµViereinen kuva n„ytt„„, milloin tyyli B voittaa A:n.¶.±üp(x):=x*1+(1-x)*(1/3) q(x):=1-p(x)GPLOT Y(x)=p(x)+p(x)^2*q(x)+2*p(x)^3*q(x)^2x=0,1,0.05                                         WSIZE=WX/2,WY/2XSCALE=0(0.1)1 YSCALE=0.4(0.1)1                    WHOME=WX/2,WY/2                                                   OUTFILE=A HEADER=ü€Ta-1@TW30@Ta1@€.±üHEADER=Tyylien_A_ja_B_voittotodenn„k”isyydetGPLOT Y(x)=x+(1-x)*(1/2)x=[RED],0,1,1                                      WSIZE=WX/2,WY/2XSCALE=0(0.1)1 YSCALE=0.4(0.1)1                    WHOME=WX/2,WY/2                                                   INFILE=A€.±LR1¶¶Tp        Jatka painamalla ENTER!@TVC2400@_@@Lr1Tp@üK„yrien leikkauskohta saadaan ratkaisemalla numeerisesti5. asteen yht„l”:p(x):=x*1+(1-x)*(1/3) q(x):=1-p(x)f(x):=p(x)+p(x)^2*q(x)+2*p(x)^3*q(x)^2-x-(1-x)/2x=root_of(f(x),0.05,0.2,1E-16)x=Ta-1@TW600@€TW50@Siten jo hieman yli 10-prosenttinen osaaminen tekisi B-tyylinkuuden kysymyksen tapauksessa edullisemmaksi.TW300@Ta1@üGPLOT /DEL ALL€Bü           - - -Jos aikaa on yli puoli minuuttia j„ljell„, edes v„h„nkintiet„v„n kilpailijan kannattaisi jatkaa tyylill„ B.K„yt„nn”ss„ n„in lienee harvoin tapahtunut. Tyyli A valitaankaiketi sen vuoksi, ett„ "kerrasta poikki" -tilanteessa ei oleaikarajoitusta. Kilpailija ei t„ll”in koe tilannetta yht„ahdistavana.Tp        Jatka painamalla ENTER!@TVC2400@_@@Tp@.±Palatkaamme alkuper„iseen olettamukseen, ett„ kilpailija valitseevastauksensa aina satunnaisesti.Jos kilpailija saisi vastailla loppumattomiin, on "varmaa", ett„h„n lopulta p„„sisi maaliin. Ko. todenn„k”isyys kasvaa siisyrityskertojen lis„„ntyess„ l„hestyen arvoa 1.Voidaan kysy„, milloin ylitet„„n arvo 0.5, jolloin tyyli Bolisi parempi kuin tyyli A.T„ll”in laskelmat kannattaa tehd„ ottamalla huomioon, ett„ongelma on kuvattavissa µµµµµMarkovin ketjunµµµ avulla.üTp        Jatka painamalla ENTER!@TVC2400@_@@Tp@üMarkovin ketjun tiloina ovat Maa1, Maa2, Maa3, Maa4, Voitto jalopputilana "Ulos", joka pit„„ kirjaa my”s yrityskerroista.Pelin s„„nn”t on silloin esitett„viss„ "p„hkin„nkuoressa"seuraavan siirtym„todenn„k”isyysmatriisin P muodossa:p=1/3 q=1-pMATRIX P///      Maa1 Maa2 Maa3 Maa4 Voitto UlosMaa1        q    p    0    0    0   0Maa2        q    0    p    0    0   0Maa3        0    q    0    p    0   0Maa4        0    0    q    0    p   0Voitto      0    0    0    0    0   1Ulos        0    0    0    0    0   1Tunnetusti kahden vaiheen siirtym„todenn„k”isyydet saadaan matriisistaP^2 (P*P) ja yleisesti n askeleen siirtym„todenn„k”isyydet matriisistaP^n. Koska Voitto on t„ss„ asetelmassa transientti (v„liaikainen) tila,josta aina "joudutaan varmasti Ulos-tilaan", matriisisummassaS=P+P^2+P^3+...+P^n alkio S(Maa4,Voitto) antaa todenn„k”isyyden sille,ett„ n kysymyksen aikana kilpailija on saapunut maaliin.üTp        Jatka painamalla ENTER!@TVC2400@_@@Tp@Ta-1@üLasketaan n„it„ todenn„k”isyyksi„ Survon matriisitulkilla:TW30@MAT SAVE P / Matriisi P talletetaanTW20@€MAT S=P    / Ker„t„„n summaa S=P+P^2+...+P^nTW20@€MAT S=S+P^2TW20@€MAT_S(Maa4,Voitto)=TW20@€/  2 kysymyksen j„lkeenMAT S=S+P^3€MAT_S(Maa4,Voitto)=TW10@€/  3 kysymyksen j„lkeenMAT S=S+P^4€MAT_S(Maa4,Voitto)=€/  4 kysymyksen j„lkeenMAT S=S+P^5€MAT_S(Maa4,Voitto)=€/  5 kysymyksen j„lkeenMAT S=S+P^6€MAT_S(Maa4,Voitto)=€/  6 kysymyksen j„lkeenMAT S=S+P^7€MAT_S(Maa4,Voitto)=€/  7 kysymyksen j„lkenMAT S=S+P^8€MAT_S(Maa4,Voitto)=€/  8 kysymyksen j„lkeenMAT S=S+P^9€MAT_S(Maa4,Voitto)=€/  9 kysymyksen j„lkeenMAT S=S+P^10€MAT_S(Maa4,Voitto)=€/ 10 kysymyksen j„lkeenMAT S=S+P^11€MAT_S(Maa4,Voitto)=€/ 11 kysymyksen j„lkeenMAT S=S+P^12€MAT_S(Maa4,Voitto)=€/ 12 kysymyksen j„lkeenMAT S=S+P^13€MAT_S(Maa4,Voitto)=€µµµµµ                µµµ/ 13 kysymyksen j„lkeenTW10@TW10@üN„in vasta silloin, kun aikaa olisi 13 kysymykseen, tyyli B olisityyli„ A kannattavampi em. olettamuksilla.TW50@TW10@Kokonaisuudessaan matriisi S on 13 askeleen j„lkeen seuraavanlainen:TW10@MAT LOAD STW10@€TW30@				µµµµµ       Ta1@Tp        Jatka painamalla ENTER!@TVC2400@_@@Tp@üArvaaja tarvitsee siis 13 kysymyst„ saadakseen voittotodenn„k”isyytens„nousemaan yli puolikkaan. Siten 13 on kysymysten lukum„„r„n jakaumanmediaanina tunnettu keskiluku.Ent„, montako kysymyst„ tarvitaan keskim„„rin, ett„ p„„st„isiinvoittoon eli mik„ on tuon jakauman odotusarvo (teoreettinen keskiarvo)?Ta-1@TW1200@Koska jakauman pistetodenn„k”isyyksi„ on hyvin hankala k„sitell„,Ta1@kannattaa k„ytt„„ ehdollistamisperiaatetta.Kysytyn odotusarvon m4=E(Maa4->Voitto) laskemiseksi tarkastellaansit„ ehdollisesti "seuraavan kysymyksen suhteen".Merkit„„n yleisesti odotusarvoja eri tiloista voittoonmi=E(Maa(i)->Voitto), i=1,2,3,4.T„ll”inm4=p*1+q*(m3+1)=q*m3+1eli todenn„k”isyydell„ p (1/3) ehdollinen odotusarvo on 1 muttatodenn„k”isyydell„ q=1-p (2/3) se on m3+1, koska voiton asemastaon pudotty Maa3:een ja yksi kysymys on mennyt hukkaan.Tp        Jatka painamalla ENTER!@TVC2400@_@@Tp@Kaiken kaikkiaan saadaan muodostetuksi 4 tuntemattoman m1,m2,m3,m4 ja4 lineaarisen yht„l”n ryhm„m1=p*(m2+1)+q*(m1+1)=p*m2+q*m1+1         p*m1-p*m2          =1m2=p*(m3+1)+q*(m1+1)=p*m3+q*m1+1   eli  -q*m1  +m2-p*m3     =1m3=p*(m4+1)+q*(m2+1)=p*m4+q*m2+1             -q*m2  +m3+p*m4=1m4=p*1+q*(m3+1)=q*m3+1                            -q*m3  +m4=1Ta-1@TW300@Talletamme t„m„n yht„l”ryhm„n kertoimet ja vakiot matriisitiedostoksi:TW10@p=1/3 q=1-pMATRIX C///  m1  m2  m3  m4  vakiom1    p  -p   0   0    1m2   -q   1  -p   0    1m3    0  -q   1  -p    1m4    0   0  -q   1    1TW300@MAT SAVE C               / Matriisin C talletusTW10@€MAT A=C(*,m1:m4)         / Kerroinmatriisin A erottaminen C:st„TW10@€MAT B=C(*,vakio)         / Vakiovektorin B erottaminen C:st„TW10@€MAT SOLVE M FROM A*M=B   / Yht„l”ryhm„n A*M=B ratkaisu vektoriin MTW10@€üTp        Jatka painamalla ENTER!@TVC2400@_@@Tp@üRatkaisuvektori M onMAT LOAD MTW10@€µµµµµ        TW30@üTulos 45 on varmasti monen mielest„ yll„tt„v„n suuri.TW20@Yleinen lauseke m4:lle muodostetaan luonnollisesti ratkaisemallaem. yht„l”ryhm„ algebrallisesti.TW20@ Odotusarvon m4 lausekkeeksi saadaan(1-2*p+2*p^2)/p^4TW20@=TW10@€µµµµµ  TW20@mik„ t„sm„„ numeerisesti matriisitulkilla saatuun ratkaisuun.Ta1@Tp        Jatka painamalla ENTER!@TVC2400@_@@Tp@üTarkistaaksemme yll„olevat tulokset ja n„hd„ksemme, miten voittoontarvittavan kysymyssarjan pituus todella vaihtelee, teemmesimulointikokeen.Luomme todellisuutta j„ljittelev„n aineiston, joka kertoo 10000kilpailijan kohtalot niin, ett„ varaudutaan kunkin kohdallajopa tuhanteen kysymykseen.Ta-1@TW600@Tehd„„n datatiedosto MY_DATA 10000 koetoistoa varten ja varataan1000 askeleen (kysymyksen) tila jokaiselle.TW30@FILE MAKE MY_DATA,1000,10000,X,1,8TW20@€Kehikko 1000 muuttujaa ja 10000 havaintoa varten on nyt luotu.Ta1@Tp        Jatka painamalla ENTER!@TVC2400@_@@Tp@üTarkoituksena on nyt simuloida Markovin ketjua, jonka siirtym„toden-n„k”isyysmatriisi on seuraava:p=1/3 q=1-pMATRIX P5///      Maa1 Maa2 Maa3 Maa4 VoittoMaa1        q    p    0    0    0Maa2        q    0    p    0    0Maa3        0    q    0    p    0Maa4        0    0    q    0    pVoitto      0    0    0    0    1Ta-1@TW600@MAT SAVE P5 / Matriisin talletusTW10@€Ta1@Koesarjat generoidaan seuraavalla Survon TRANSFORM-komennolla.T„smennys START=4 tarkoittaa sit„, ett„ jokainen koetoisto alkaatilasta 4 (Maa4).TRANSFORM MY_DATA BY #MARKOV(P5) / START=4Ta-1@TW600@€Koesarjat ovat nyt luotuna tiedostoon MY_DATA.üTW30@Vilkaistaan, milt„ aineiston alkup„„ n„ytt„„:TW10@FILE SHOW MY_DATATW20@€TW600@²TW10@Ta1@Tp        Jatka painamalla ENTER!@TVC2400@_@@Tp@üüüüüüüKysymyssarjan pituuden (pelin keston) laskemiseksi kullekin 10000"koehenkil”lle" toimitaan seuraavasti.Lasketaan kussakin koetoistossa, milloin saavutetaan tila 5 (Voitto)seuraavalla Survon VARSTAT-komennolla.Kysymyssarjojen pituudet saadaan uutena muuttujana 'Kesto'.VARSTAT MY_DATA,Kesto:2,FIRST,L / L=5üTa-1@TW1200@€TW20@.±Muodostetaan pelin keston frekvenssijakauma:TW10@STAT MY_DATA,CUR+1 / VARS=Kesto  CLASSMAX=1000TW30@€TW50@üüµµµµµEnimmill„„n tarvittiin per„ti 579 kysymyst„!TW20@üTa1@¶.±HEADER=Huono-onnisimman_pelaajan_tie   PEN=[Swiss(30)]IND=ORDER,2255,2255MAT SAVE DATA MY_DATA TO K2255€MAT K2255=K2255'€MAT K2255(0,1)="Tila"€MAT RLABELS NUM(1) TO K2255€LINE=1 YSCALE=0:_,1:Maa1__,2:Maa2__,3:Maa3__,4:Maa4__,5:Voitto,6:_       XSCALE=0(100)600 XLABEL=Kysymyksi„XDIV=3,20,2 MODE=1000,1000GPLOT K2255.MAT,CASE,Tila / IND=ORDER,1,579€.±¶¶üµµµµµTuon huono-onnisimman kohtalo n„kyy kuvassa!µµµTa-1@TW2400@üTa1@BBGPLOT /DEL ALL€BTa-1@üTW30@µµµµµ            TW10@TW10@Aineistosta laskettu pelin keskim„„r„inen kesto on hyvinl„hell„ teoreettista arvoa 45.TW30@TW10@TW10@T„ss„ kokeessa peli p„„ttyi heti ensimm„iseen kysymykseen 3268tapauksessa 10000:sta.TW20@ Kun p=1/3, odotettu m„„r„ olisi N*p=TW10@€TW10@Tulos on uskottava, sill„ keskivirhe on sqrt(p*(1-p)*N)=TW10@€TW10@mik„ on samaa luokkaa kuin erotus 3333-3268=TW10@€TW10@Muita alkup„„n frekvenssej„ voitaisiin tarkastella samalla tavalla.TW30@TW10@TW10@TW10@Havaitaan my”s, ett„ pelin p„„ttyminen parillisella m„„r„ll„ ei aluksionnistu lainkaan (2,4,6) ja on viel„ 10 yrityksell„ puolet harvinai-sempaa kuin 11 yrityksell„.TW20@Ennen pitk„„ parillisten ja parittomien frekvenssit tasoittuvatpieneten hitaasti.TW10@ Millaista on tuo hidastuminen?Ta1@Tp        Jatka painamalla ENTER!@TVC2400@_@@Tp@Siirtym„todenn„k”isyyksien tarkkojen lausekkeiden m„„r„„minenyleisesti on ilmeisen hankalaa.Numeerisesti todenn„k”isyydet sille, ett„ kilpailija p„„seetilasta 'Maa4' n askeleella tilaan 'Voitto', voidaan Survossalaskea nopeasti seuraavalla tavalla:Markovin ketjun yhden askeleen siirtym„todenn„k”isyydet ovatt„ss„ tapauksessa aikaisemmin talletetussa matriisissa P.p=1/3 q=1-pMATRIX P///      Maa1 Maa2 Maa3 Maa4 Voitto UlosMaa1        q    p    0    0    0   0Maa2        q    0    p    0    0   0Maa3        0    q    0    p    0   0Maa4        0    0    q    0    p   0Voitto      0    0    0    0    0   1Ulos        0    0    0    0    0   1Seuraava Survo-komento laskee (kertomalla matriisia P itsell„„n)nuo siirtym„todenn„k”isyydet askelm„„rill„ 1,2,...,1000.MARKOV PROB P,Maa4,Voitto,1000,PNüTa-1@TW1200@€TW20@Ta1@üTp        Jatka painamalla ENTER!@TVC2400@_@@Tp@Ta-1@üTodetaan ensin, ett„ siirtym„todenn„k”isyyksien Maa4 -> Voittosumma todella l„hestyy ykk”st„:TW10@MAT S=SUM(PN)TW10@€TW30@MAT_S(1,1)=TW10@€TW30@eli n„ytt„„ varmalta, ett„ aina lopulta selviydyt„„n maaliin.TW50@Katsellaan, milt„ siirtym„todenn„k”isyydet Maa4 -> Voitton„ytt„v„t eri askelm„„rill„ (askeleesta 11 eteenp„in):TW10@GPLOT PN.MAT,CASE,Voitto   / POINT=0  YSCALE=0,0.02 IND=ORDER,11,1000üTW20@€TW600@Todenn„k”isyydet pienenev„t niin nopeasti,ett„ on parasta siirty„ logaritmiseenasteikkoon Y-akselilla:TW50@GPLOT PN.MAT,CASE,Voitto   / POINT=11 YSCALE=*log(y),0.00000001,1üTW20@€TW600@N„hd„„n, ett„ suuremmilla askelm„„rill„tn.ien logaritmit pienenev„t lineaarisesti.TW20@T„m„ tarkoittaa mm. sit„, ett„ per„kk„istentn.ien suhde l„hestyy vakiota.TW30@Saamme tuon vakion (likiarvon) esillelaskemalla vektorista PN kahden viimeisen alkionsuhteenTW20@s=MAT_PN(1000,1)/MAT_PN(999,1)TW20@s=TW10@€TW20@üTa1@GPLOT /DEL ALL€Ta-1@üT„m„ tarkoittaa sit„, ett„ vaikka siirtym„todenn„k”isyydetaluksi heilahtelevat paljonkin (alkutilanteesta johtuen),TW20@prosessi ennen pitk„„ "unohtaa" tuon alkutilanteenja k„ytt„ytyy puhtaan arvonnan kaltaisesti.TW40@Siis ehdollinen todenn„k”isyys p„„st„ voittoonn. kysymyksell„, jos se ei ole tapahtunut aikaisemmin,on suurilla n-arvoilla vain 1-s=TW30@€TW1200@Voidaan lopuksi kysy„, miten tuo vakio s liittyy matriisiin P.Vastaus l”ytyy m„„r„„m„ll„ matriisin P ominaisarvot,TW20@mik„ vastaa tietyn, matriisin P alkioiden avulla muodostetun,6. asteen yht„l”n (ns. karakteristisen yht„l”n) ratkaisua:TW50@MAT #EIGEN(P,L) / Lasketaan matriisin P ominaisarvotTW10@€MAT L=VD(L)     / L„vist„j„matriisi L muunnetaan pystyvektoriksiTW10@€MAT LOAD L,12.12345678901234,CUR+1TW10@€TW50@MATRIX LKun muistetaan, ett„ s=TW10@€TW10@havaitaan, ett„ se vastaa toiseksi suurinta ominaisarvoa.TW30@ü.±BüTW10@µµµµµ                TW10@TW10@TW10@TW10@s=TW10@€TW20@TW50@üTW20@Ta1@üVaikka ei tiet„isik„„n luvun s olevan yksi matriisin P ominaisarvoista,on mahdollista "l”yt„„" karakteristinen yht„l” "tarkasti" pelk„st„„nlikiarvon s=TW10@€ perusteella!!!.T„m„ tapahtuu k„ytt„en ns. µµµµµk„„nteist„ symbolista laskentaa.Survossa on INTREL-komento, joka mm. pystyy p„„ttelem„„n, onkoannettu vakio tietynasteisen, kokonaislukukertoimisen, algebrallisenyht„l”n juuri.Ta-1@TW600@Kokeilkaamme aluksi, voisiko s olla toisen asteen yht„l”n juuri:TW20@INTREL sTW20@€TW20@Ratkaisua ei l”ytynyt. Kokeilemme kolmatta astetta.TW10@INTREL s / DEGREE=3TW20@€TW20@Nyt l”ytyi ratkaisu, mutta kertoimet ovat "liian" suuria.TW20@Yritt„k„„mme viel„ nelj„tt„ astetta.TW10@INTREL s / DEGREE=4TW20@€TW20@Nyt saatiin hyvin pienikertoiminen yht„l”.TW30@üüüüTW10@üKatsokaamme, mitk„ ovat sen juuret.TW10@ Talletamme yht„l”n kertoimetvakiotermist„ l„htien vektorina Q4.TW10@MATRIX Q4 ///  4 24-54-54 81TW300@MAT SAVE Q4     / Vektorin Q4 talletusTW10@€TW20@POL R=ROOTS(Q4) / Yht„l”n 81*X^4-54*X^3-54*X^2+24*X+4=0 ratkaiseminenTW20@€TW20@MAT LOAD R,12.12345678901234,CUR+1TW10@€TW300@TW10@TW10@Kaikki juuret ovat reaalisia.TW20@ Niist„ s on ensimm„isen„ ja muut ovatsamat kuin aikaisemman matriisin P ominaisarvoteht„v„st„ saadutvektorina L talletetut (triviaalitapauksia 0 ja 1 lukuunottamatta):TW50@MAT LOAD L,12.12345678901234,CUR+1TW10@€TW20@Siis kaikki karakteristista yht„l”„ koskeva informaatio on"salakirjoitettuna" lukuun s=€ .üTW50@µµµµµT„m„ opetusjakso p„„ttyy!µµµTW50@üBFILE DEL MY_DATATW10@€ü0T!1@CX@TLTNLS@Tÿ
 {call MY_KUVA}




















 Kysymyssarjan pituuden (pelin keston) laskemiseksi m„„ritell„„n data-{R}
 tiedostoon uusi muuttuja Kesto:{20}{R}
 VAR Kesto:2=MISSING TO MY_DATA{10}{10}{R}
 .{copy}{R}{R}
 Lasketaan kussakin koetoistossa, milloin saavutetaan tila 5 (Voitto):{10}{R}



















 s=0.98656284627029
 INTREL s / DEGREE=4
 X=0.98656284627029 is a root of 81*X^4-54*X^3-54*X^2+24*X+4=0





bTa1@TgC1@C1@C!@C1@C1@SCRATCH€üGPLOT /DEL ALL€Bü   µµµµµµµ Oikean kolikon tunnistaminen Jo niinkin yksinkertainen teht„v„ kuin rahanheittosarjan arviontisen suhteen, onko k„ytetty "oikeata" kolikkoa, tuottaa ihmisillevaikeuksia.Esitin seuraavan teht„v„n syksyn 1999 todenn„k”isyyslaskennankurssin osanottajille.Yrit„ itse arvioida tilannetta ja valitse tuo oikea kolikkokolmesta vaihtoehtoisesta.Tp        N„et vaihtoehdot kun painat ENTER-nappia.@TVC1200@_@@Tp@üAlla on esitetty 200 heiton tulokset kolmella kolikolla siten, ett„kruuna on 1 ja klaava 0. Esim. kolikolla 1 on tullut ensin kruunaja sitten 2 klaavaa, kruuna, klaava, kruuna, klaava, jne.Mieti, mik„ tulossarjoista vastaa mielest„si eniten todellistarahanheittotilannetta, jossa kruuna ja klaava ovat yht„ todenn„k”isi„ja per„kk„iset tulokset ovat toisistaan riippumattomia?µµµµµKolikko 1:10010101010010110101100101010101011010000101101000010100011000010100000101010010111010010011010101000101100111101101010101101010101010111010101000101001101010010001101010011010001101011000101010100110µµµµµKolikko 2:10010100100010110110000101010010011101111010010111101011100111101011111010101101000101101100101010111010011000011101010010010101010111000101011000101110010101101110011010011010001101011000010110100110µµµµµKolikko 3:10010000011100110110000111010010011101111000010111101011100111101011111101101101111010011100010101000101100111100010101101100101010111111010100111010000011011101110011010000010001101011000010110100111µµµµµüTXA@Mik„ on tuo "oikea" kolikko (vastaa 1,2 tai 3) ? i1TKC2400@@C@1@=BTIN1@C3@@@GA@TIN1@C1@GA@@@Valitsit siis kolikon =.TJ1@1@2@3@@GR1@GR2@GR3@@TXR1@Kanssasi samaa mielt„ oli 8 kurssin 40 osanottajasta (siis 20%).TLGB@TXR2@Kanssasi samaa mielt„ oli 26 kurssin 40 osanottajasta (siis 65%).TXB@"Oikea" raha on kuitenkin viimeinen eli 3.TLGC@TXR3@Kanssasi samaa mielt„ oli 6 kurssin 40 osanottajasta (siis 15%).Siit„ huolimatta, ett„ v„hemmist” oli samaa mielt„, olet oikeassa.TXC@Tp        Paina ENTER!@TVC1200@_@@Tp@T„ss„ viel„ uudelleen heittosarjat ja kannatusluvut 40 kurssilaisella:µµµµµKolikko 1:  8/40 eli 20% (v„„r„)TIN1@C1@GK1@@GK1@ T„m„ oli siis sinun valintasi.TXK1@10010101010010110101100101010101011010000101101000010100011000010100000101010010111010010011010101000101100111101101010101101010101010111010101000101001101010010001101010011010001101011000101010100110µµµµµKolikko 2: 26/40 eli 65% (v„„r„)TIN1@C2@GK2@@GK2@ T„m„ oli siis sinun valintasi.TXK2@10010100100010110110000101010010011101111010010111101011100111101011111010101101000101101100101010111010011000011101010010010101010111000101011000101110010101101110011010011010001101011000010110100110µµµµµKolikko 3:  6/40 eli 15% (oikea)TIN1@C3@GK3@@GK3@ T„m„ oli siis sinun valintasiTXK3@10010000011100110110000111010010011101111000010111101011100111101011111101101101111010011100010101000101100111100010101101100101010111111010100111010000011011101110011010000010001101011000010110100111Tp        Paina ENTER!@TVC1200@_@@Tp@Mist„ oikein kiikastaa, ett„ kurssilaisten enemmist”TIN1@C3@@GD@@ (kuten sin„kin)TXD@teki v„„r„n valinnan ja miksi enemmist”n valintaa voi pit„„ v„„r„n„?Tp        Paina ENTER!@TVC1200@_@@Tp@¶ü..........MODE=1000,400    WHOME=0.5*WX,0.65*WY WSIZE=0.5*WX,0.30*WYPEN=[WHITE] LINETYPE=[WHITE] OUTFILE=ATITLE=RahanheittosarjatTEXTS=T T=[Courierb(90)][BLACK],#LINES:CUR+1,CUR+16,10,380,60GPLOT /FRAMEHeittosarjat ja kannatusluvut 40 kurssilaisella:Kolikko 1:  8/40 eli 20% (v„„r„)10010101010010110101100101010101011010000101101000010100011000010100000101010010111010010011010101000101100111101101010101101010101010111010101000101001101010010001101010011010001101011000101010100110Kolikko 2: 26/40 eli 65% (v„„r„)10010100100010110110000101010010011101111010010111101011100111101011111010101101000101101100101010111010011000011101010010010101010111000101011000101110010101101110011010011010001101011000010110100110Kolikko 3:  6/40 eli 15% (oikea)10010000011100110110000111010010011101111000010111101011100111101011111101101101111010011100010101000101100111100010101101100101010111111010100111010000011011101110011010000010001101011000010110100111€¶¶SCRATCH €BüHeittosarjat n„kyv„t nyt omassa ikkunassaan!Periaatteessa mik„ tahansa heittosarja (vaikka pelkist„ klaavoista,siis nollista koostuva) on yht„ mahdollinen.Kukaan ei pid„ noin monotonista tulosta kuitenkaan uskottavana,vaan syyst„kin ep„ilee, ett„ kolikossa on ollutkin klaava molemmillapuolilla tms.Yleens„kin, jos toista vaihtoehtoa esiintyy selv„sti enemm„n,tilastotieteen tuntija alkaa ep„ill„.T„ss„ tapauksessa katsoja huomaa silm„m„„r„isestikin, ett„ nollia jaykk”si„ esiintyy kaikilla kolmella kolikolla suurin piirtein yht„paljon. T„ss„ suhteessa koesarjoissa ei ole mit„„n omituista.Tied„n (kokeilijoiden kertomusten mukaan), ett„ he huomaavat heti,ett„ 1. kolikolla nollat ja ykk”set vuorottelevat hyvin tihe„„n.Ns. µµµµµtoistoksetµµµ eli saman vaihtoehdon per„kk„iset esiintymisetovat verraten lyhyit„.Kolikoilla 2 ja 3 esiintyy enemm„n pitki„ 0- ja 1-toistoksia muttaselv„sti useimpien mielest„ ne ovat liian pitki„ kolikolla 3.Siksi enemmist” p„„tyy kolikkoon 2, vaikka kolikko 3 on se oikea.Tp        Paina ENTER!@TVC1200@_@@Tp@T„m„n perusteella uskallan v„itt„„, ett„ ihminen ei luonnostaan osaaarvioida, miten toistokset k„ytt„ytyv„t aidosti rahanheiton kaltaisessakoetilanteessa.Osoittaakseni, miksi vain kolikko 3 on antanut uskottavia tuloksia,tarkastelkaamme vaikkapa 1-toistosten lukum„„ri„:                                                     1-toistoksiaKolikko 1:10010101010010110101100101010101011010000101101000   1901010001100001010000010101001011101001001101010100   1601011001111011010101011010101010101110101010001010   1901101010010001101010011010001101011000101010100110   17  yht. 71 kpl.Kolikko 2:10010100100010110110000101010010011101111010010111   1610101110011110101111101010110100010110110010101011   1610100110000111010100100101010101110001010110001011   1610010101101110011010011010001101011000010110100110   15  yht. 63 kpl.Kolikko 3:10010000011100110110000111010010011101111000010111   1210101110011110101111110110110111101001110001010100   1301011001111000101011011001010101111110101001110100   1500011011101110011010000010001101011000010110100111   13  yht. 53 kpl.Tp        Paina ENTER!@TVC1200@_@@Tp@1-toistosten lukum„„r„ on kolikoilla 1 ja 2 suurempi kuin kolikolla 3.Jotta voimme vakuuttavasti osoittaa, ett„ vain kolikolla 3 toistostenm„„r„ on uskottava, olisi selvitett„v„, miten toistosten lukum„„r„tjakautuvat aidolla kolikolla 200 heiton mittaisessa koesarjassa.Tarkastelkaamme asiaa aluksi ilman mit„„n teoreettisia pohdintoja elivailla toistosten jakautumislain tuntemista.K„ytin t„t„ aikoinaan kurssilla esimerkkin„ siit„, kuinka oikeaanp„„telm„„n p„„st„„n "arkij„rjell„" ilman todenn„k”isyyslaskennan jatilastotieteen osaamista.Tp        Paina ENTER!@TVC1200@_@@Tp@B.±üTurvaudumme simulointikokeeseen, jossa luodaan 10000 kpl 200 heitonmittaisia sarjoja "aidolla", harhattomalla kolikolla.Perustamme aluksi datatiedoston 200 muuttujaa X1,X2,...,X200 ja 10000havaintoa varten:FILE MAKE RUNS,200,10000,X,1€Tp        Paina ENTER!@TVC1200@_@@Tp@Seuraava Survon TRANSFORM-komento t„ytt„„ koko tiedoston nollilla jaykk”sill„ sattumanvaraisesti.Koska tietokonetta ei saa toimimaan aidon satunnaisesti, on kehitettylaskennallisia menettelyj„ (ns. pseudosatunnalislukugeneraattoreita),jotka j„ljittelev„t satunnaista k„ytt„ytymist„ (kts. RAND?:R).T„ss„ RND-t„smennys kertoo siemenluvun, josta l„hdet„„n liikkeelle.TRANSFORM RUNS BY #UNIFORM(0,2)  / RND=rand(199906)€Tp        Paina ENTER!@TVC1200@_@@Tp@Ta-1@Jokainen havaintoarvo Xi on int(U),TW10@ miss„ U noudattaa tasaista jakaumaav„lill„ (0,2) eli P(Xi=0)=P(Xi=1)=1/2.TW50@üTa1@GPLOT /DEL ALL€BTa-1@üVoit selailla vaakasuunnassa kulkevia heittosarjoja:TW20@FILE SHOW RUNSTW20@Q€qTW20@Nyt lasketaan 1-toistosten lukum„„r„ NR jokaiselle heittosarjalle:TW20@VARSTAT RUNS,NR:2,#RUN,L / L=1TW30@€TW20@.±Lopuksi selvitet„„n kuinka 1-toistosten lukum„„r„ NR vaihtelee n„iss„heittosarjoissa:TW20@STAT RUNS,CUR+1 / VARS=NR  FRACTILES=0.95,0.99,0.999TW30@€TW50@TW10@TW10@TW10@µµµµµ      TW10@Ta1@üSuurin 1-toistosten lukum„„r„ t„ss„ 10000-kertaisessa kokeessa on 62.Kun muistamme, ett„ kolikolla 1 n„it„ toistoksia oli 71 kpl. jakolikolla 2 vastaavasti 63 kpl., n„in suuria toistosm„„ri„ eiollut yhdess„k„„n 10000 kokeesta, jotka juuri teimme. T„ss„ suhteessa kolikkojen 1 ja 2 tuotokset vaikuttavat eritt„inharvinaisilta eiv„tk„k„ siis ole lainkaan uskottavia.Kolikolla 3 saatu toistosm„„r„ 53 on sen sijaan hyvin l„hell„aineistosta laskettua keskiarvoa 50.2642 ja siten t„ysin uskottava.üTp        Paina ENTER!@TVC1200@_@@Tp@üTa-1@TW50@TW20@üKatselemalla frekvenssitaulukkoa n„emme toistosten lukum„„„r„njakautuvan varsin kauniisti keskiarvon ymp„rille.Ta1@Tp        Paina ENTER!@TVC1200@_@@Tp@üLienee paikallaan selvitt„„, miten t„ss„ esiintyneet 200 rahanheitonsarjat ovat syntyneet.Jokainen niist„ on generoitu Markovin ketjuna, jossa siirtym„toden-n„k”isyys kruunasta klaavaan on c ja samoin klaavasta kruunaan on c.Eri kolikoilla p on   kolikko 1: c=0.7   kolikko 2: c=0.6   kolikko 3: c=0.5 .Siis vain kolikko 3 k„ytt„ytyy harhattoman lantin tapaan. Kolikoilla1 ja 2 on taipumus herkemmin "vaihtaa puolta", jolloin toistoksetlyhenev„t.Tp        Paina ENTER!@TVC1200@_@@Tp@.±Ta-1@üTarkalleen esim. kolikon 1 heittosarja tehtiin n„in:TW10@Perustetaan datatiedosto RAHA1 200 heittoa X varten:TW20@FILE MAKE RAHA1,1,200,X,1TW20@€TW20@Lasketaan muuttujan X arvot ehdollisella VAR-komennolla:TW10@X=if(ORDER=1)then(Y)else(X2)X2=if(X[-1]=1)then(1-Y)else(Y)Y=int(rand(1999)+c) c=0.7VAR X TO RAHA1Tp        Paina ENTER!@TVC1200@_@@Tp@€TW20@Poimitaan n„in tuotettu "heittosarja" toimituskentt„„n:TW10@FILE LOAD RAHA1,CUR+1 / FORMAT=LISTTW20@€TW50@T„st„ esityksest„ heittosarja muunnettiin aiemmin n„htyyn muotoon.Ta1@Tp        Paina ENTER!@TVC1200@_@@Tp@.±Toistosten jakauma:Edell„ p„„telm„t tehtiin satunnaistetun testin tyyliin tarvitsemattatuntea testisuureen (1-toistosten lukum„„r„) tarkkaa jakaumaa.Pyrimme nyt johtamaan tuon jakauman ja oletamme, ett„ kyseess„ ontoistokoe, jossa onnistumistodenn„k”isyys on 1/2.Tarkastelemme ensin 1-toistosten ja 0-toistosten lukum„„rien summaan-kertaisessa kokeessa kombinatorisesti. Olkoon siis R(n,k) niidenerilaisten n-mittaisten 0,1-jonojen lukum„„r„, joissa on k toistosta.Ehdollistamalla viimeinen j„senen suhteen saamme palautuskaavanR(n,k)=R(n-1,k)+R(n-1,k-1)eli toistosten lukum„„r„ kasvaa yhdell„, joss viimeinen j„sen poikkeaaviimeist„ edellisest„. T„m„ kaava on sama kuin binomikertoimilla.Tp        Paina ENTER!@TVC1200@_@@Tp@.±Nyt kuitenkin on R(n,1)=2 kaikille n ja R(2,2)=2, joten palautuskaavanavulla syntyy R(n,k)-taulukko    k  1  2  3  4  5   n   1   2   2   2  2   3   2  4  2   4   2  6  6  2   5   2  8 12  8  2   .   .............Kyseess„ on Pascalin kolmio kahdella kerrottuna eliR(n,k)=2*C(n-1,k), k=1,2,,,,.n .Tp        Paina ENTER!@TVC1200@_@@Tp@.±Olkoon nyt R1(n,k) erilaisten n-mittaisten 0,1-jonojen m„„r„, joissaon k 1-toistosta. R1(n,k) voidaan ilmaista R(n,k):n avulla asettamallajonon kumpaankin p„„h„n ylim„„r„isen 0:n. T„ss„ tilanteessa edelleenon k kpl. 1-toistoksia ja havaitsemme, ett„ siin„ on t„ll”in ainak+1 kpl. 0-toistoksia eli toistoksia yhteens„ 2*k+1 kpl.T„ll”in on R1(n,k)=R(n+2,2*k+1)/2=C(n+1,2*k),koska t„sm„lleen puolet n+2 -mittaisista, jonoista, joissa on 2*k+1toistosta (eli joko k 1-toistosta ja k+1 0-toistosta tai p„invastoin),on 0:lla alkavia ja p„„ttyvi„.Jos X on satunnaismuuttuja 1-toistosten lukum„„r„lle n-kertaisessatoistokokeessa, jossa onnistumistodenn„k”isyys on 1/2, X:n jakaumanm„„rittelev„t siten pistetodenn„k”isyydetP(X=k)=C(n+1,2*k)*2^(-n), k=1,2,...,[n/2].Tp        Paina ENTER!@TVC1200@_@@Tp@.±Tarkastamme, ett„ n„iden todenn„k”isyyksien summa on 1 tapauksessan=200. Merkit„„ns(n):=for(k=1)to(int(n/2))sum(C(n+1,2*k)*2^(-n))jolloin esim.s(200)=Tp        Paina ENTER!@TVC1200@_@@Tp@€Tp        Paina ENTER!@TVC1200@_@@Tp@.±Edell„ luodussa RUN-aineistossa muuttuja NR vastaa muuttujaa X.Katsomme, miten hyvin muuttujan NR empiirinen 10000 havainnonjakauma sopii yhteen juuri johdetun 1-toistosten jakauman kanssa.T„m„ tapahtuu Survon GHISTO-operaatiolla.Teoreettisen jakauman m„„rittely:PROBABILITY RUN1(N)  Y(X)=C(N+1,2*X)*2^(-N)FIT=RUN1(200)                         Sovitus N:n arvolla 200NR=29.5(1)70.5 XSCALE=30(5)70 FILL=5  Sopiva luokitus ja v„ritysGHISTO RUNS,NR,CUR+1Tp        Paina ENTER!@TVC1200@_@@Tp@ü€Ta-1@TW50@TW10@üKhi^2-testin perusteella ei ole aihetta ep„ill„, ett„ havaittu jakaumapoikkeaa teoreettisesta.TW50@üTa1@GPLOT /DEL ALL€BTa-1@üüTW50@µµµµµT„m„ opetusjakso p„„ttyy!µµµTW50@üBFILE DEL RUNSTW10@€ü0T!1@C3@TLTNLS@Tÿ





















bTa1@TgC1@C1@C!@C1@C1@SCRATCH€üGPLOT /DEL ALL€BüREDIM 1000,200€Büüü   µµµµµµµ Toistokokeen tunnistaminen Edellisess„ jaksossa tarkasteltiin rahanheittosarjoja eli sellaisiatoistokokeita, joissa suotuisan vaihtoehdon (1) esiintymistoden-n„k”isyys on p=1/2 ja ep„suotuisan (0) todenn„k”isyys q=1-p=1/2.Siirrymme nyt ehk„ astetta vaikeampaan tunnistusteht„v„„n elitilanteeseen, jossa p poikkeaa puolikkaasta.Saat n„kyviisi j„lleen kolme koesarjaa ja teht„v„n„sion tunnistaa n„ist„ se, joka vastaa aitoa toistokoetta eliett„ per„kk„iset kokeet ovat toisistaan riippumattomia.Tp        N„et vaihtoehdot kun painat ENTER-nappia.@TVC1200@_@@Tp@üAlla on esitetty 3 koesarjaa, joissa kussakin on 240 koetta.Mieti, mik„ tulossarjoista vastaa mielest„si eniten todellistatoistokoetilannetta, jossa ykk”sen esiintymistodenn„k”isyys onp (tuntematon) ja kokeet ovat toisistaan riippumattomia?µµµµµKoe 1:110011001001011111111011000011000100010011111011101111101010011010111101111110111101011111101101111110100111011111111111110101101011111110111101101111100111100011111101011010101001111000101010100110111111111110111111111000001011111011101101µµµµµKoe 2:010000001001111111111011000000000100010011111011000111101110011010111101111110111101011111101101111110100110111111111111110101101011111110111101101111100011101111111101011010101000011000000010100110111111111110111111111000000001110001101101µµµµµKoe 3:010000001001011111111010000000000000010011111000000111101010011010111100011110101111011111101111111110100111111111111111111101101011111110111100000111100011100000111111011010100000011100000000100010011111111110111111111111101001111001001111µµµµµüTXA@Mik„ on tuo aito toistokoe (vastaa 1,2 tai 3) ? i1TKC2400@@C@1@=BTIN1@C3@@@GA@TIN1@C1@GA@@@Valitsit siis kokeen =.TJ1@1@2@3@@GR1@GR2@GR3@@TXR1@Valitsit aivan oikein!.TLGB@TXR2@Koe 2 ei oikein hyvin t„yt„ toistokokeen ehtoja!.TXB@Koe 1 on tuo aito toistokoesarja.TLGC@TXR3@Koe 3 on n„ist„ kaikkein kauimpana aidosta toistokokeesta.TLGB@TXC@Tp        Paina ENTER!@TVC1200@_@@Tp@.±Miksi Koe 1 vastaa parhaiten toistokokeesta saatavaa tulossarjaa?Vastaus l”ytyy j„lleen tarkastelemalla esim. 1-toistostenlukum„„r„„. Kaikki kolme koesarjaa on luotu siten, ett„ ykk”sentodenn„k”isyys on koko koesarjan aikana vakio p=2/3 ja niinp„ykk”sten m„„r„t ovat kussakin sarjassa kutakuinkin samat.1-toistosten lukum„„riss„ on sen sijaan eroja.Tp        Paina ENTER!@TVC1200@_@@Tp@                                                             1-toistotµµµµµKoe 1:110011001001011111111011000011000100010011111011101111101010 14011010111101111110111101011111101101111110100111011111111111 12110101101011111110111101101111100111100011111101011010101001 15111000101010100110111111111110111111111000001011111011101101 12                    ykk”si„ 164 164/240=0.683...             53 yht.µµµµµKoe 2:010000001001111111111011000000000100010011111011000111101110 10011010111101111110111101011111101101111110100110111111111111 12110101101011111110111101101111100011101111111101011010101000 14011000000010100110111111111110111111111000000001110001101101 10                    ykk”si„ 152 152/240=0.633...             46 yht.µµµµµKoe 3:010000001001011111111010000000000000010011111000000111101010 10011010111100011110101111011111101111111110100111111111111111 10111101101011111110111100000111100011100000111111011010100000 10011100000000100010011111111110111111111111101001111001001111  9                    ykk”si„ 144 144/240=0.6                  39 yht.Tp        Paina ENTER!@TVC1200@_@@Tp@üSen asemasta ett„ tekisimme aineistokohtaiset testit, johdamme1-toistosten jakauman yleisess„ N-kertaisessa toistokokeessa.Kun toistokokeessa onnistumistodenn„k”isyys ei ole 1/2 vaanyleisemmin p (0<p<1), 1-toistosten jakauman hallinta vaikeutuu.Tapauksessa p=0.5 jokaisen koesarjan todenn„k”isyys oli sama 2^(-N),mutta kun p ei ole 0.5, saman toistosluvun omaavien koesarjojentodenn„k”isyydet vaihtelevat riippuen siit„, montako nollaa jaykk”st„ koetuloksissa esiintyy.Olkoon X edelleen satunnaismuuttuja, joka ilmaisee 1-toistostenlukum„„r„n jakauman N-kertaisessa toistokeessa.Jotta X:n jakauma saataisiin selville, on tunnettava todenn„k”isyydetP(N,X,S)=P[ N-kertaisessa kokeessa X 1-toistosta ja S kpl. ykk”si„ ]N„m„ todenn„k”isyydet ovat muotoaP(N,X,S)=R(N,X,S)*p^S*q^(N-S),miss„ q=1-p ja R(N,X,S) tarkoittaa niiden N-mittaisten 0,1-jonojenlukum„„r„„, joissa on X 1-toistosta ja S ykk”st„.Tp        Paina ENTER!@TVC1200@_@@Tp@Ta-1@TW10@üLaskemme aluksi tapauksessa N=15 luvut R(N,X,S) muodostamallakaikki erilaiset 0,1-jonot, joita l”ytyy 2^15=TW10@€TW10@º kappaletta.TW20@Koska n„ill„ jonoilla on yksik„sitteinen vastaavuus bin„„risestiesitettyjen lukujen 0,1,...,2^15-1 kanssa, tarvittavat 0,1-jonotsyntyv„t Survon COMB-operaatiolla seuraavasti:TW30@COMB N2 TO JONOT15 / N2=INTEGERS,15,2 RESULTS=1TW30@€TW20@Jonot talletettiin tekstitiedostoon JONOT15.TW20@TW10@üPoimitaan joitain n„ytteit„:TW10@LOADP JONOT15,1,10,CUR+1 / 10 ensimm„ist„ jonoaTW10@€TW50@LOADP JONOT15,22222,22222,CUR+1 / 22222. jonoTW20@€TW30@Huomaa, ett„TW10@TW10@¹¹¹TW10@TW10@¹TW10@TW10@TW5@TW5@TW5@TW5@TW4@TW3@TW2@TW1@TW1@TW2@TW3@TW5@TW10@ü(bin:10)=TW10@€TW20@eli jonot ovat tekstitiedostossa JONOT15 "numeroj„rjestyksess„".TW20@Tp        Paina ENTER!@TVC1200@_@@Tp@TW10@üLaskeaksemme toistosten lukum„„r„t kaikissa erilaisissa 32768koesarjoissa, jotka ovat rivein„ tekstitiedostossa JONOT15,siirr„mme ko. tiedot samannimiseen Survon datatiedostoon.TW30@Luodaan tarvittava tiedosto:TW10@FILE MAKE JONOT15,15,0,K,1TW20@€TW10@Kopioidaan tiedot:TW10@FILE SAVE JONOT15 TO JONOT15 / NAMES=DEFAULTTW20@€TW20@FILE SHOW JONOT15  / Voit silm„ill„ tiedoston sis„lt”„.üTW20@Q€qTW10@.±Lasketaan sek„ 1-toistosten lukum„„r„ (X) ja ykk”sten m„„r„ (S)erikseen kussakin koesarjassa.TW20@MASK=AAAAAAAAAAAAAAA / 15 ensimm„ist„ muuttujaa aktiivisiksiTW20@VARSTAT JONOT15,X:1,#RUN,L / L=1TW20@€TW20@VARSTAT JONOT15,S:1,SUMTW20@€Tp        Paina ENTER!@TVC1200@_@@Tp@.±Muodostetaan kaikkien X-, S-yhdistelmien frekvenssitaulukko:TW10@VARIABLES=X,S X=0(1)8 S=0(1)15TW10@TAB JONOT15,CUR+1   / RESULTS=CSUMS,RSUMS CHI2=-TW20@€TW50@TW10@µµµµµ    TW10@    TW10@TW10@µµµµµ    TW10@Tp        Paina ENTER!@TVC1200@_@@Tp@Lukujen R(N,X,S) yleinen lauseke onR(N,X,S):=C(S-1,X-1)*C(N-S+1,X)TW30@eli ne voidaan lausua kahden binomikertoimen tulona.TW30@Esim. R(15,5,7)=TW10@€TW20@ (vrt. taulukkoon)TW30@ja vastaava sarakesumma onRSUM(N,X):=for(S=X)to(N-X+1)sum(R(N,X,S))TW30@joten RSUM(15,5)=TW10@€TW20@ (vrt. taulukkoon)TW30@mink„ tulisi olla my”s sama kuin edellisess„ opetusjaksossa johdettuR1(N,X):=C(N+1,2*X)TW30@ eli t„ss„ tapauksessa R1(15,5)=TW10@€Luonnollisesti vastaava rivisumma on binomikerroin C(15,7)=TW10@€.Ta1@Tp        Paina ENTER!@TVC1200@_@@Tp@üYleinen perustelu lausekkeelle R(N,X,S)=C(S-1,X-1)*C(N-S+1,X)on seuraava:Ajatellaan 0,1-jonoon kuuluvat S ykk”st„ asetetuksi per„kk„in. N„ill„ykk”sill„ on S-1 v„li„, joista X-1 kpl. tulee valita erottimiksi,jotta syntyisi X kpl. 1-toistosta. T„m„ voidaan tehd„ C(S-1,X-1)tavalla.Asetetaan mielivaltaisen, ehdot t„ytt„v„n, N-mittaisen  0,1-jononkumpaankin p„„h„n ylim„„r„inen 0. T„m„ ei vaikuta 1-toistostenm„„r„„n, mutta takaa sen, ett„ 0-toistoksia on lis„tyss„ jonossaX+1 kpl. Koska nollia on t„ll”in N+2-S kpl., p„„tell„„n samallatavalla kuin edell„ 1-toistosten suhteen, ett„ nollat voivatesiinty„ C((N+2-S)-1,(X+1)-1)=C(N-S+1,X) tavalla riippumattasiit„, miten ykk”set esiintyv„t.N„in sellaisten N-mittaisten jonojen m„„r„, joissa on X 1-toistostaja S ykk”st„ on em. binomikertoimien tulo.Ko. lauseke p„tee kaikilla mahdollisilla N-,S-,X-yhdistelmill„paitsi silloin, kun S=X=0 sill„ t„ll”in saadaan esim. R(15,0,0)=0kun oikean arvon tulisi olla 1 (kyseess„ pelkkien nollien jono).Tp        Paina ENTER!@TVC2400@_@@Tp@.±N„iden tulosten perusteella 1-toistosten lukum„„r„n X jakaumanpistetodenn„k”isyydet P(N,X) N-kertaisessa toistokokeessa, jossaykk”sen todenn„k”isyys on p voidaan m„„ritell„ seuraavasti:P(N,X):=if(X=0)then(q^N)else(P1(N,X))    q=1-pP1(N,X):=for(S=X)to(N-X+1)sum(p(N,X,S))p(N,X,S):=C(S-1,X-1)*C(N-S+1,X)*p^S*q^(N-S)  X = 0,1,2,...,[N+1/2]T„ss„ esiintyy "erikoistapauksena" tuo pelkkien nollien jono, jonkatodenn„k”isyys on q^N.Tp        Paina ENTER!@TVC2400@_@@Tp@Ta-1@Tarkistuksena laskettakoon n„iden todenn„k”isyyksien summa, kun N=15ja p=2/3:TW10@S=for(i=0)to(int((N+1)/2))sum(P(N,i))TW20@S=TW20@€TW20@Ta1@Tp        Paina ENTER!@TVC2400@_@@Tp@.±X:n edell„ p„„telty jakauma on yksinkertaisempi ja tehokkaampitestaustilanteissa ehdollistettuna S:n suhteen.Todenn„k”isyys sille, ett„ N-mittaisessa jonossa on X 1-toistostaehdolla, ett„ ykk”sten lukum„„r„ on S, on „skeinen p(n,X,S) jaettunabinomitodenn„k”isyydell„ P(S)=C(N,S)*p^S*q^(N-S) eliP(X|S)=C(S-1,X-1)*C(N-S+1,X)/C(N,S), mik„ ei riipu p:st„!Kun S siis tunnetaan, X on korkeintaan pienempi luvuista S ja N-S+1.Tarkistetaan ko. todenn„k”isyyksien summa, kun N=15 ja S=7:sum(N,S):=for(X=1)to(min(S,N-S+1))sum(C(S-1,X-1)*C(N-S+1,X)/C(N,S))sum(15,7)=Tp        Paina ENTER!@TVC2400@_@@Tp@üTa-1@TW10@€TW10@Ta1@Tp        Paina ENTER!@TVC2400@_@@Tp@.±Koska nyt tunnemme 1-toistosten jakauman yleisess„ toistokokeessa,voimme tutkia, kuinka hyvin Koe1, Koe2 ja Koe3 k„ytt„ytyv„t t„ss„suhteessa.µµµµµKoe 1:110011001001011111111011000011000100010011111011101111101010 14011010111101111110111101011111101101111110100111011111111111 12110101101011111110111101101111100111100011111101011010101001 15111000101010100110111111111110111111111000001011111011101101 12                    ykk”si„ 164 164/240=0.683...             53 yht.Tp        Paina ENTER!@TVC2400@_@@Tp@Ta-1@TW10@1-toistosten lukum„„r„n X eri arvojen todenn„k”isyydet ehdolla, ett„ykk”sten lukum„„r„ on S saamme, kuten edell„ n„ytettiin, kaavastaTW20@P(N,X,S):=C(S-1,X-1)*C(N-S+1,X)/C(N,S)TW10@Teemme vektorin P, johon talletamme ko. todenn„k”isyydet:TW20@n=240 s=164 k=min(s,n-s+1)TW10@MAT P=ZER(k,1)TW10@€TW20@MAT #TRANSFORM P BY P(n,I#,s)TW20@€TW20@MAT F=CUM(P)                  / Kumulatiiviset summat (kertym„funktio)TW20@€TW20@Koska 1-toistosten m„„r„ oli 53,TW10@ kiinnostaa P(X<=53) eli lasketaanTW10@MAT_F(53,1)=TW10@€TW20@mik„ osoittaa, ettei toistokoehypoteesia voi hyl„t„ koesarjassa 1.Ta1@Tp        Paina ENTER!@TVC2400@_@@Tp@.±Tutkimme koesarjaa Koe 2 samalla tavalla:µµµµµKoe 2:010000001001111111111011000000000100010011111011000111101110 10011010111101111110111101011111101101111110100110111111111111 12110101101011111110111101101111100011101111111101011010101000 14011000000010100110111111111110111111111000000001110001101101 10                    ykk”si„ 152 152/240=0.633...             46 yht.P(N,X,S):=C(S-1,X-1)*C(N-S+1,X)/C(N,S)TW10@n=240 s=152 k=min(s,n-s+1)TW10@MAT P=ZER(k,1)TW10@€TW20@MAT #TRANSFORM P BY P(n,I#,s)TW20@€TW20@MAT F=CUM(P)                  / Kumulatiiviset summat (kertym„funktio)TW20@€TW20@Koska 1-toistosten m„„r„ oli 46,TW10@ kiinnostaa P(X<=46) eli katsotaanTW10@MAT_F(46,1)=TW10@€TW20@eli t„m„ koesarja ei vaikuta kovin uskottavalta.Tp        Paina ENTER!@TVC2400@_@@Tp@.±Viimeist„„n t„ss„ vaiheessa on syyt„ todeta, ett„ tilastotiedetarjoaa muitakin keinoja t„m„n testausongelman k„sittelyyn.Voidaan esim. k„ytt„„ Khi^2-testi„.Muunnamme koesarjan 2 Survon datatiedostoksi TOISTO2:µµµµµKoe 2:010000001001111111111011000000000100010011111011000111101110011010111101111110111101011111101101111110100110111111111111110101101011111110111101101111100011101111111101011010101000011000000010100110111111111110111111111000000001110001101101üFILE DEL TOISTO2€BüTa-1@TW600@üüINSERTTW10@€TW10@TW10@TRIM 1TW10@€TW10@INSERTTW10@€TW5@TW2@€€€€€€€€€€€€€€€€€€€€€€€€€€TW3@€TW4@TW5@€TW10@TW10@TW10@TW10@TW10@DATA X1:TW10@TW10@ENDTW10@FILE COPY X1 TO TOISTO2TW10@€TW10@Taulukoimme kaikki yhdistelm„t 00,01,10,11:TW20@VAR X2:1=X1[-1] TO TOISTO2TW20@€TW20@TAB TOISTO2,CUR+1 / VARIABLES=X2,X1 X2=-1,0,1 X1=-1,0,1TW20@€TW20@TW20@Ta1@My”s t„m„ testi hylk„„ sen hypoteesin, ett„ kyseess„ olisi aitotoistokoe, mutta ei tee sit„ yht„ selv„sti kuin 1-toistoksiinperustuva testi (jossa P=0.0032).Khi^2-testin k„ytt„minen t„ss„ yhteydess„ saattaa muutenkinsynnytt„„ ep„ilyksi„, sill„ tarkasteltavat havainnot (00,01,10,11-yhdistelm„t) lomittuvat toisiinsa, eiv„tk„ ole siis toisistaanriippumattomia.Tekem„ni simulointikokeet osoittavat yll„tt„en, ett„ ep„ilyksist„huolimatta testisuure noudattaa Khi^2-jakaumaa 1 vapausasteella.üTp        Paina ENTER!@TVC2400@_@@Tp@.±Ta-1@üOlen koonnut yhteen erilaisia keinoja toistokoesarjan satunnaisuudentutkimista varten RUNTEST-modulin muodossa.TW20@ Žskeisess„ tapauksessaRUNTEST antaa seuraavat tulokset:TW20@RUNTEST TOISTO2,X1,CUR+1TW10@€TW50@Ta1@üTarkempia tietoja RUNTEST-modulin k„ytt„mist„ keinoista l”ytyykyselysanalla RUNTEST?.Todettakoon, ett„ 1-toistosten lukum„„r„„ koskevaa testi„ vastaaWald-Wolfowitzin testi, joka perustuu toistosten kokonaism„„r„„n elinyt arvoon run0+run1=€º.Ta-1@TW50@Ter„vimmin puree t„ss„ tilanteessa kuitenkin Khi^2-testi, jokatarkkailee kolmikoitten (triples) 000,001,010,011,100,101,110,111 luku-m„„ri„ samoin kuin edell„ tarkasteltiin pareja 00,01,10,11.TW50@Tekem„ni simulointikokeet osoittavat, ett„ Khi^2-jakaumaolettamusp„tee, vaikka frekvenssit lasketaan osittain sis„kk„isist„ kolmikoista.TW50@"Geometric disribution test" perustuu siihen, ett„ aidossa toisto-kokeessa 1-toistoksien pituudet noudattavat geometrista jakaumaaparametrilla q ja 0-toistokset parametrilla p.T„m„ testi edellytt„„ kuitenkin yleens„ suurempaa otoskokoa.TW50@"O'Brien-Dyck-test" k„ytt„„ toistospituuksien variansseja. Sen antamaKhi^2-testisuure tuottaa usein liian pieni„ P-arvoja. Siksi RUNTESTlaskee P-arvon my”s simuloimalla ja saa nyt 4-kertaisen arvon.Tp        Paina ENTER!@TVC2400@_@@Tp@.±Ta1@üTutkimme viel„ kolmatta  koesarjaa suoraan RUNTEST-operaatiolla:Muunnamme koesarjan Survon datatiedostoksi TOISTO3:µµµµµKoe 3:010000001001011111111010000000000000010011111000000111101010011010111100011110101111011111101111111110100111111111111111111101101011111110111100000111100011100000111111011010100000011100000000100010011111111110111111111111101001111001001111üFILE DEL TOISTO3€BüTa-1@TW600@üüINSERTTW10@€TW10@TW10@TRIM 1TW10@€TW10@INSERTTW10@€TW5@TW2@€€€€€€€€€€€€€€€€€€€€€€€€€€TW3@€TW4@TW5@€TW10@TW10@TW10@TW10@TW10@DATA X3:TW10@TW10@ENDTW10@FILE COPY X3 TO TOISTO3TW10@€TW10@üTW20@üRUNTEST TOISTO3,X3,CUR+1TW10@€TW50@eli "kaikin tuomari„„nin" koesarja 3 on aidoksi toistokokeeksit„ysin ep„uskottava.Tp        Paina ENTER!@TVC2400@_@@Tp@TW50@µµµµµT„m„ opetusjakso p„„ttyy!µµµTW50@üBFILE DEL JONOT15.*TW10@€ü0T!1@C4@TLTNLS@Tÿ


 {u}LOAD TOISTO{R}



























bTa1@TgC1@C1@C!@C1@C1@SCRATCH€üGPLOT /DEL ALL€BüREDIM 1000,200€Büüü   µµµµµµµ Temppelin pylv„songelma T„m„ ongelma tuli vastaan Jari Pakkasen v„it”skirjaty”n yhteydess„.Jari antiikin rakennustaiteen tutkijana tuonut uutta ilmett„t„h„n perinteisesti humanistispainotteiseen alaan matematiikan,tilastotieteen ja tietojenk„sittelyn taidoillaan.H„n on jo pitk„„n k„ytt„nyt Survoa sek„ varsinaisissaanalyysiteht„viss„ ett„ jopa kentt„tutkimuksissa kannettavallalaitteella.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üV„it”skirjan er„„n„ tavoitteena oli arvioida raunioituneen,Labraundassa (V„h„-Aasia) sijainneen joonialaisen, Zeuksentemppelin pylv„skorkeus paikalla sijainneen, puutteellisenj„„mist”n perusteella. Mahdollisimman oikea tieto pylv„skorkeudestaauttaa paremmin ymm„rt„m„„n rakennuksen arkkitehtuuria.Temppeliss„ oli ollut 24 pylv„st„, joista jokainen muodostui 5p„„llekk„isest„ pylv„srummusta. N„ist„ 120 pylv„srummusta oli vain33 s„ilynyt mitattavassa kunnossa. Jokainen pylv„s on ollut sik„liainutlaatuinen, ett„ sen rumpujen korkeudet eiv„t ole tarkkaansamat kuin toisissa pylv„iss„. Sen vuoksi pylv„skorkeutta ei voidasaada esille suoraan laskemalla eri tasoilla olleitten rumpujenkorkeudet yhteen, vaan Jari joutui k„ytt„m„„n hyv„ksi muitakintietoja, esim. pylv„„n hieman ulosp„in kaarevaa „„riviivaa,ns. entasis-k„yr„„.N„iden tietojen avulla on mahdollista selvitt„„, l”ytyyk”j„„mist”st„ edes yksi pylv„s, jonka kaikki rummut ovat s„ilyneet.N„in ei t„ss„ tapauksessa ollut asian laita, jolloin pylv„skorkeusjouduttiin m„„ritt„m„„n tilastollisin keinoin.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üPeriaatteessa olisi kuitenkin hyv„ tiet„„ muissa vastaavanlaatuisissatilanteissa ennen tarkempia tutkimuksia, mik„ on todenn„k”isyys P sille,ett„ ainakin yksi pylv„s on tallella, kun tiedet„„n pyv„itten lukum„„r„(t„ss„ 24) rumpujen m„„r„ pylv„st„ kohti (t„ss„ 5) ja eri tasoiltas„ilyneitten pylv„itten lukum„„r„t (t„ss„ 4, 5, 7, 11 ja 6).S„ilyneiden rumpujen er„s mahdollinen sijoittelu pylv„isiin voisiolla esim. seuraavan kaavion mukainen:                                                   taso                                                    k     n(k)  - Û - - Û - - - - Û - - - - - - - Û - Û - - - Û   5       6  Û - - Û - Û - Û - Û Û Û - - Û - Û - - Û - - Û -   4      11  - - Û Û - Û - - - Û - - - - Û - - - Û Û - - - -   3       7  - - - Û - - - Û - Û - - - - - - Û - - - - Û - -   2       5  - - - Û - - - - - Û - - - - - - Û - - Û - - - -   1       4                    ^                    Realisaatio, jossa kokonainen pylv„s tallellaOlettamalla, ett„ j„ljelle j„„neet pylv„srummut muodostavatumpim„hk„isen otoksen, P on mahdollista arvioida.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üJari Pakkanen pohti kysymyst„ 21.11.1997 l„hett„m„ss„„n viestiss„seuraavasti:> Otin yhden alimmista pohjarummuista ja todenn„k”isyys, ett„ sen> kanssa aikoinaan samassa pylv„„ss„ ollut rumpu on s„ilynyt, on 5/24.> P sille, ett„ t„m„n parin kanssa yhdess„ ollut kolmas rumpu olisi> s„ilynyt, on 7/24 jne. P koko pylv„„n s„ilymiselle olisi siis> (5/24)*(7/24)*(11/24)*(6/24)=0.007. Koska pohjarumpuja on nelj„,> kaiken kaikkiaan todenn„k”isyys, ett„ temppelist„ olisi s„ilynyt yksi> kokonainen pylv„s on P=4*0.007=0.028. Paremmin asian voisi ehk„> muotoilla niin, ett„ koska on sama, mik„ 24:st„ pylv„„st„ on> s„ilynyt, voidaan laskea> P=24*(4/24)*(5/24)*(7/24)*(11/24)*(6/24)=0.028. Jos olet keksinyt> paremman laskutavan, niin otan eritt„in mielell„ni kommentteja> vastaan.Jarin p„„ttely on periaatteessa hieman virheellinen, vaikka se antaakinkysytyn todenn„k”isyyden t„ss„ tapauksessa suunnilleen oikein.Virheen huomaa v„litt”m„sti, jos tarkastelee tilanteita, joissas„ilyneit„ rumpuja on selv„sti enemm„n, esim. 15 kullakin tasolla.T„ll”in Jarin p„„ttelytapa antaisi todenn„k”isyyden    24*(15/24)*(15/24)*(15/24)*(15/24)*(15/24)=2.289mik„ on tietenkin mielet”n tulos.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üOngelma on siin„, etteiv„t tapahtumat    A(i)="Pylv„s i on s„ilynyt", i=1,2,...,24ole toisensa poissulkevia eik„ t„ll”in ole oikein laskea niidentodenn„k”isyyksi„ suoraan yhteen (eli kertoa luvulla 24).Ž„rimmilleen vietyn„ eli "ehj„n temppelin" tapauksessa saataisiin"todenn„k”isyydeksi" jopa 24.My”hemmin n„hd„„n, ett„ t„t„kin tiet„ oikea ratkaisu syntyy, kunk„ytet„„n yleist„ todenn„k”isyyslaskennan yhteenlaskulausetta.Mielest„ni kuitenkin kauniimpi tapa on soveltaa seuraavaarekursiivista p„„ttely„:Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üTarkastellaan pylv„it„ alhaalta p„in ja seurataan kauanko pylv„ss„ilyy ehj„n„.Olkoon P(k,h) todenn„k”isyys sille, ett„ tasolle k asti h pylv„st„on j„ljell„ (ehj„n„).T„ll”in saadaan palautuskaava kokonaistodenn„k”isyyten„          n(k-1)P(k,h) =  SUMMA  P(k-1,j)*C(j,h)*C(n-j,n(k)-h)/C(n,n(k)).           j=hSiis, jotta tasolla k olisi h ehj„„ pylv„st„ j„ljell„,tasolla k-1 niit„ on j„ljell„ jokin m„„rist„ j=h,h+1,...,n(k-1).Todenn„k”isyys ett„ tasolla k-1 on j pylv„st„ ehjin„ on P(k-1,j).Ehdollinen todenn„k”isyys sille, ett„ ehjien pylv„iden m„„r„putoaa j:st„ lukuun h siirrytt„ess„ tasolle k on hypergeometrinenC(j,h)*C(n-j,n(k)-h)/C(n,n(k)).Koska tasolla 1 "ehji„" pylv„it„ on n(1) kappaletta, palautuskaavanreunaehdot ovat P(1,n(1))=1, P(1,h)=0 muuten.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@ü.±üRatkaisu saadaan Survossa yksinkertaisesti seuraavallalaskentakaaviolla:Olkoon P(k,h) todenn„k”isyys sille, ett„ tasolla k on h kokonaistapylv„st„ j„ljell„.Tarkastellaan erikseen tasoa 1P(k,h):=if(k=1)then(P1(h))else(P2(k,h))jolloin ko. todenn„k”isyys on 1 arvolla h=n(1) ja 0 muutoin eliP1(h):=if(h=n(1))then(1)else(0)Yleisesti p„tee P:lle (eli kun k>1, P2:lle) palautuskaavaP2(k,h):=for(j=h)to(n(k-1))sum(P(k-1,j)*C(j,h)*C(n-j,n(k)-h)/C(n,n(k)))miss„ C:t ovat binomikertoimia. Siis h:n ehdollinen jakauma siirrytt„-ess„ tasolta k-1 tasolle k on hypergeometrinen.Pylv„itten kokonaism„„r„ oli n=24 ja s„ilyneiden rumpujen m„„r„teri tasoilla n(k):=X(N,k)  (X-funktiosta tietoa kyselyll„ XFUNC?)Nü 4 5 7 11 6                                                           ACCURACY=16Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@üKysytty todenn„k”isyys saadaan aktivoimalla1-P(5,0)=TW30@€TW30@üVastaavasti todenn„k”isyydet h pylv„„n s„ilymiselle ovat (h=0,1,2,3,4)P(5,0).=P(5,1).=P(5,2).=P(5,3).=P(5,4).=TW20@€TW30@siis yhteens„ s=for(h=0)to(4)sum(P(5,h))TW10@ eli s=TW20@€TW30@Tp        Jatka painamalla ENTER-nappia!@Ta1@TVC1200@_@@Tp@.±üKuten jo huomautettiin, Jarin alkuper„inen laskutapa antaa melkeinsaman tuloksen 24*(4/24)*(5/24)*(7/24)*(11/24)*(6/24)=0.0278501157...mutta se on puutteellinen, koska tapahtumat    A(i)="Pylv„s i on s„ilynyt", i=1,2,...,24eiv„t ole toisensa poissulkevia.Laskelmaa voi pit„„ ensimm„isen vaiheen likikiarvona yleisest„todenn„k”isyyksien (inclusion-exclusion) summalauseesta, joka kahdentapahtuman A,B tapauksessa on tunnetusti P(A+B)=P(A)+P(B)-P(A*B).T„ss„ 'A+B' tarkoittaa tapahtumaa "joko A tai B tai molemmat"ja 'A*B' tapahtumaa "sek„ A ett„ B".Soveltamalla t„t„ kaavaa kolmeen tapahtumaan A,B,C saadaanP(A+B+C)=P(A+B)+P(C)-P((A+B)*C)=P(A+B)+P(C)-P(A*C+B*C)        =P(A+B)+P(C)-P(A*C)-P(B*C)+P(A*B*C)        =P(A)+P(B)+P(C)-P(A*B)-P(A*C)-P(B*C)+P(A*B*C).Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üT„ydellisell„ induktiolla p„„tell„„n, ett„ yleisesti on voimassa                      nP[A(1)+...+A(n)] =  SUMMA  P[A(i)]                     i=1                  - SUMMA  P[A(i)*A(j)]                     i<j                  + SUMMA  P[A(i)*A(j)*A(k)]                    i<j<k                    ...                  + (-1)^(n-1)*P[A(1)*...*A(n)],miss„ summat lasketaan yli kaikkien mahdollisten indeksikombinaatioden.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üT„ss„ erikoistapauksessa tapahtumat A(i) ovat yhdenvertaisia, jolloinkaava sievenee muotoonP[A(1)+...+A(n)] =   C(n,1)*P[A(1)]                   - C(n,2)*P[A(1)*A(2)]                   + C(n,3)*P[A(1)*A(2)*A(3)]                   - C(n,4)*P[A(1)*A(2)*A(3)*A(4)]                   + ...Koska pienin luvuista n(k) on 4, t„ss„ n„kyviin merkityt termitovat ainoat nollasta poikkeavat jaesim. todenn„k”isyys                          5   n(k)  n(k)-1   n(k)-2   n(k)-3P[A(1)*A(2)*A(3)*A(4)] = TULO ----*--------*--------*--------                         k=1   n     n-1      n-2      n-3(5*4=20 tekij„„) saadaan suoralla p„„ttelyll„.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@ü.±üN„iden tietojen avulla on rakennettu seuraava laskentakaavio, jossaesiintyy uusi funktio k_fact(n,k):=fact(n)/fact(n-k)(T„m„ funktio on valmiiksi m„„riteltyn„ SURVO MM:n versiossa 1.06+,mutta se toimii vanhemmissa Survoissa yo. m„„rittelyn perusteella.)n(k):=X(N,k)n=24 m=5                                              ACCURACY=16P=for(i=1)to(4)sum(Q(i))Q(i):=C(n,i)*(-1)^(i-1)*Q2(i)Q2(i):=for(k=1)to(m)product(k_fact(n(k),i)/k_fact(n,i))Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@üT„st„ saadaanP=TW20@€TW30@mik„ on luonnollisesti sama tulos kuin aikaisemmalla rekursiivisellakaaviolla laskettu.Tp        Jatka painamalla ENTER-nappia!@Ta1@TVC1200@_@@Tp@.±üKoska summakaavaan perustuvassa ratkaisussa termit ovat vuorottelevia,on aina pel„tt„viss„ py”ristysvirheen kasautumista.T„ss„ tapauksessa ei kuitenkaan ole aihetta huoleen.Vaikka rekursiivinen ratkaisu on laskuty”n kannalta ty”l„„mpi, senetuna on periaatteellinen selkeys ja mahdollisuus laskea osatoden-n„k”isyydet P(n,h), h=0,1,2,3,4.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±üTarkastellaan lopuksi er„it„ t„m„n temppeliongelman muunnelmia.µMuunnelma 1:Jos rummun sijainnilla pylv„„n sis„ll„ ei olisi merkityst„ (tasoei siis m„„r„tty), teht„v„n asettelu muuttuu:n x k -ruudukosta valitaan m kpl ruutuja umpim„hk„„n.Laske todenn„k”isyys sille, ett„ valituista ruuduista syntyy ainakinyksi k ruudun "ehj„" sarake.(Em. temppeliesimerkin parametrein n=24, k=6, m=33.)Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üTeht„v„„ tarkastellaan aluksi kombinatoorisesti:Olkoon Bk(m,n) niiden tapojen lukum„„r„, joilla ruudukko t„yttyyilman yht„„n ehj„„ saraketta.T„ll”in kysytty todenn„k”isyys on 1-Bk(m,n)/C(k*n,m).Luvut Bk(m,n) m„„r„ytyv„t palautuskaavasta seuraavasti:Ensinn„kin Bk(m,n)=C(k*n,m), kun m=1,2,...,k-1,sill„ t„ll”in ei voi olla yht„„n ehj„„ saraketta.Sitten ehdollistetaan sen suhteen, montako ruutua (0,1,...,k-1)on valittu viimeisest„ sarakkeesta.Kun k <= m < (k-1)*n+1, saadaan palautuskaava kokonaistodenn„k”isyyten„Bk(m,n)=  Bk(m,n-1)+k*Bk(m-1,n-1)+C(k,2)*Bk(m-2,n-1)+...+C(k,k-1)*B(m-k+1,n-1).Muuten Bk(m,n)=0.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@ü.±µNumeerinen ratkaisu:T„ss„ k„ytet„„n Survon matriisitulkkia ja erityisesti komentoaMAT #TRANSFORM <matriisi> BY RECURRENCE <funktion_nimi>joka t„ydent„„ matriisitilan (taulukon) yhden tai kahden muuttujanfunktion arvoilla, kun ao. muuttujien arvot ovat 0,1,2,... jako. funktiolle on annettu palautuskaava ja tarvittavat alkuarvot.L„ht”kohtana on siis kaavio           0  1  2  3  4  5  ...        0  a  a  a  a  a  a        1  a  a  a  a  a  a        2  a  a  a  a  a  a        3  a  a  x  x  x  x        4  a  a  x  x  x  x        5  a  a  x  x  x  x        .miss„ a tarkoittaa alkuarvoa ja x palautuskaavalla laskettavaa arvoa.On siis ennen MAT #TRANSFORM ... BY RECURRENCE - komentoaa) varattava matriisitila taulukkoa varten,b) sijoitettava alkuarvot a paikoilleen,c) annettava palautuskaava (Survon tilap„isen„ funktiona),d) ilmoitettava START-t„smennyksell„ "iteraation" alkukohta   (yll„ esim. START=3,2).Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@ü.±Palautuskaava on siis t„ss„ tapauksessaBk(M,N):=for(i=0)to(k-1)sum(C(k,i)*Bk(M-i,N-1))K„ytet„„n temppeliesimerkin parametreja n=24 k=6 m=33.MAT BK=ZER(m+1,n+1)               / TilanvarausMAT C=CON(k-1,n)                  / Alkuarvot k-1 ensimm„iselle rivilleMAT #TRANSFORM C BY C(k*J#,I#)MAT BK(2,2)=C                     / Alkuarvojen siirto taulukkoonMAT RLABELS NUM(0) TO BK          / Numeeriset otsikot 0,1,2,...MAT CLABELS NUM(0) TO BKMAT #TRANSFORM BK BY RECURRENCE Bk  / START=k,2Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@TW20@Tp        Jatkuva aktivointi!@TW20@€Tp@TW20@üMatriisiin P lasketaan vastaavat todenn„k”isyydet:MAT P=BK(2:m+1,2:n+1)TW10@€TW10@A=if(X#=0)then(0)else(1-X#/C(k*J#,I#))MAT #TRANSFORM P BY ATW20@€TW20@Poimitaan esille viimeinen alkio eli kysytty todenn„k”isyys:MAT_P(m,n)=TW10@€TW20@Tp        Jatka painamalla ENTER-nappia!@Ta1@TVC1200@_@@Tp@.±üVaihtoehtoinen ratkaisu perustuu j„lleen yhteenlaskulauseeseen:Merkit„„nA(i) = "Sarake i on ehj„", i=1,2,...,n.T„ll”in sarake 1 t„yttyy, jos m-k ruutua valitaan sen ulkopuoleltaeli k*(n-1) ulkopuolisesta ruudusta. T„m„ tapahtuu todenn„k”isyydell„P[A(1)]=C(k*(n-1),m-k)/C(k*n,m).Vastaavasti onP[A(1)*A(2)*...*A(i)]=C(k*(n-i),m-i*k)/C(k*n,m)eli kysytty todenn„k”isyys saadaan yhteenlaskukaavasta muodossaP=Q/C(k*n,m)Q=for(i=1)to(int(m/k))sum((-1)^(i-1)*C(n,i)*C(k*(n-i),m-i*k))Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@üEm. temppeliesimerkin parametrein n=24, k=6, m=33TW10@ ACCURACY=16P=TW20@€TW20@mik„ tulos yhtyy palautuskaavalla laskettuunMAT_P(m,n)=TW10@€TW20@Tp        Jatka painamalla ENTER-nappia!@Ta1@TVC1200@_@@Tp@.±üµMuunnelma 2:Arvotaan n x k -ruudukosta ruutuja siten, ett„ kunkin ruudunvalintatodenn„k”isyys (toisista ruuduista riippumatta) on p=m/(n*k).Lasketaan todenn„k”isyys sille, ett„ syntyy ainakin yksi k ruudun"ehj„" sarake.Todetaan ensiksi, ett„ P[1.sarake ei ehj„]=1-p^k, jotenP[ei yht„„n ehj„„ saraketta]=(1-p^k)^n.Kysytty todenn„k”isyys on siten P(n,k,p):=1-(1-p^k)^nTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@üeli temppeliongelman arvoinP(24,6,33/(24*6))=TW20@€TW20@Tp        Jatka painamalla ENTER-nappia!@Ta1@TVC1200@_@@Tp@.±üHuomattakoon, ett„ muunnelmissa 1 ja 2 saadut todenn„k”isyydet ovatkertalukua pienempi„ (temppeliongelman parametrein) alkuper„iseentodenn„k”isyyteen verrattuna. T„m„ johtuu siit„, ett„ alkuper„isess„teht„v„ss„ jokaiselle tasolle oli taattuna v„hint„in 4 rumpua (ruutua),mik„ parantaa yhten„isen sarakkeen syntymahdollisuuksia.µµµµµTemppelin pylv„songelman k„sittely p„„ttyy!Tp        Lopeta painamalla ENTER-nappia! (Keskeytys napilla .)@TVC1200@_@@Tp@üTa-1@0T!1@C5@TLTNLS@Tÿ


{u}LOAD TEMPPEL2{R}





























bTa1@TgC1@C1@C!@C1@C1@SCRATCH€üGPLOT /DEL ALL€BüREDIM 1000,200€Büüü   µµµµµµµ Noppaongelma (multinomitodenn„k”isyyksi„)Jori M„ntysalo Tampereen yliopistosta kirjoitti 4.5.2001 uutisryhm„ss„sfnet.tiede.matematiikka seuraavaa:> T„m„ pit„isi kait osata laskea itsekin, vaan...> Kun heitt„„ vaikka normaalia noppaa 6*N kertaa, niin keskim„„rin> pit„isi tulla N kappaletta kutakin numeroa. Miten todenn„k”ist„ on> p„„st„ esimerkiksi 10% heittoon suurimmassakin erossa? Eli jos> heit„n vaikka 600 kertaa noppaa, niin mill„ todenn„k”isyydell„> _jokaista_ lukua tulee 90..110 kappaletta?> Ent„ toisinp„in, montako kertaa noppaa pit„„ heitt„„, jotta ero> odotusarvoon olisi maksimissaan vaikka tuo 10%?J„lkimm„iseen kysymykseen on helppo vastata. Koska esim. heittosarja66666666666666... (loputtomiin) on yht„ mahdollinen kuin jokin muu,t„ytt„ varmuuutta 10% rajojen sis„ll„ pysymisest„ ei koskaan saavuteta.Ensimm„inenkin kysymys on periaatteessa helppo, mutta k„yt„nn”ss„yll„tt„v„n hankala, jos pyrit„„n tehokkaaseen laskentaan.Opetusmieless„ etenen seuraavissa tarkasteluissa vaiheittainhitaista kohti nopeampia ratkaisuja.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üOlkoon yleisesti heittojen lukum„„r„ n (Jorilla 6*N) ja eri pistelukujenfrekvenssit n1,n2,n3,n4,n5,n6, jolloin n1+n2+n3+n4+n5+n6=n.Koska jokaisen yksitt„isen pisteluvun saantitodenn„k”isyys on 1/6,yhdistelm„ll„ n1,n2,n3,n4,n5,n6 on multinomijakauman mukaisestitodenn„k”isyys   P(n1,n2,n3,n4,n5,n6) =  n!/(n1!*n2!*n3!*n4!*n5!*n6!)*(1/6)^n.Tarkasteltaessa tapahtumaa, ett„ jokainen frekvensseist„n1,n2,n3,n4,n5,n6 on v„lill„ [MIN,MAX], todenn„k”isyys saadaanlaskemalla yhteen kaikki ne P(n1,n2,n3,n4,n5,n6):t, joissan1+n2+n3+n4+n5+n6=n ja MIN<=n(i)<=MAX, i=1,2,3,4,5,6.Survossa t„m„n laskutoimituksen voi v„litt”m„sti tehd„ seuraavallalaskentakaaviolla, joka on k„yt„nn”ss„ hidas:Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±üTarkastellaan vain suppeaa erikoistapaustan=180 MIN=27 MAX=33 (siis 10 prosentin rajoin).P=for(n1=MIN)to(MAX)sum(P2(n1))          / P lasketaan 6 sis„kk„isell„P2(n1):=for(n2=MIN)to(MAX)sum(P3(n1,n2)) / "ohjelmakierroksella".P3(n1,n2):=for(n3=MIN)to(MAX)sum(P4(n1,n2,n3))P4(n1,n2,n3):=for(n4=MIN)to(MAX)sum(P5(n1,n2,n3,n4))P5(n1,n2,n3,n4):=for(n5=MIN)to(MAX)sum(P6(n1,n2,n3,n4,n5))P6(n1,n2,n3,n4,n5):=for(n6=MIN)to(MAX)sum(P7(n1,n2,n3,n4,n5,n6))P7(n1,n2,n3,n4,n5,n6):=if(n1+n2+n3+n4+n5+n6=n)&                       then(exp(M(n1,n2,n3,n4,n5,n6)))else(0)M(n1,n2,n3,n4,n5,n6):=lfact(n)-lfact(n1)-lfact(n2)-lfact(n3)-lfact(n4)&                              -lfact(n5)-lfact(n6)-n*log(6)Huom. lfact(n)=log(n!) ja laskenta tapahtuu logaritmien kautta, sill„esim. lfact(180)/log(10)=329.30297142479 eli 180!>10^329, mik„ ylitt„„koneen salliman suurimman mahdollisen liukulukuarvon.Lasketaan P aktivoimalla P= ja mitataan laskemiseen kuluva aika:TIME COUNT STARTP=TIME COUNT ENDTa-1@TW30@€TW30@üTa1@WWWi1wTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üLaskenta vei siis aikaa = sekuntia, mik„ osoittaa t„m„n laskutavank”mpelyyden. Tosin osittain hitaus johtuu editoriaalisesta laskennastajoka toimii tulkkiperiaatteella. Jos tehd„„n esim. vastaavaC-kielinen ohjelma, sen nopeus on yli 10-kertainen, mutta sekinhidastuu kohtuuttomasti hieman suuremmilla heittom„„rill„.Esim. jos tuollaisella C-ohjelmalla ajetaan tapaus n=300, MIN=45,MAX=55, aikaa kuluu jo enemm„n kuin editoriaalisessa laskennassa em.tilanteessa. Taulukoimalla kertomien logaritmit (lfact) laskentanopeutuu melkoisesti, mutta h„vi„„ silti reippaasti seuraavillevaihtoehdoille.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±üMuuan nopeutuskeino on v„ltt„„ nuo 6 sis„kk„ist„ ohjelmakierrostapyrkim„ll„ luettelemaan suoraan suotuisat yhdistelm„tn1,n2,n3,n4,n5,n6, joilla n1+n2+n3+n4+n5+n6=n.Survossa kombinatoriikkaan eikoistunut COMB-operaatio kykenee t„h„nmuutamalla eri tavalla.Esim. tapauksessa n=60, MIN=9, MAX=11 voidaan aktivoidaMIN=9 MAX=11üCOMB D,CUR+1 / D=DISTRIBUTIONS,60,6üTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üTa-1@TW20@€TW30@TW20@T„ss„ on lueteltuna kaikki ehdot t„ytt„v„t 141tulosyhdistelm„„ "aakkosj„rjestyksess„".TW10@COMB muodostaa yhdistelm„t tehokkaalla algoritmilla,jossa ei esiinny mit„„n kuusinkertaisia ohjelma-kierroksia.TW30@¶TW10@TW10@TW30@¶¶TW20@Olisi helppo tehd„ sukro, joka laskee kunkin yhdis-telm„n todenn„k”isyyden ja n„m„ yhteen.TW20@T„m„n olen kuitenkin toteuttanut COMB-operaatiossasuoraan seuraavasti:TW20@TW10@TW10@PROB=1/6,1/6,1/6,1/6,1/6,1/6 / Ilmoitetaan vain vaihtoehtojen tnt.TW20@TW10@TW10@SCRATCHTW10@€TW10@TW10@€TW30@üTW10@Nyt luettelossa ovat kaikkienyhdistelmien todenn„k”isyydetja niiden summaTW10@P=TW5@€TW10@ensimm„isell„ tulosrivill„.TW20@Pelkk„ summa eli kysytty toden-n„k”isyys saadaan lasketuksit„smennyksell„ RESULTS=0.TW20@TW10@RESULTS=0TW10@TW5@TW5@SCRATCHTW5@€TW10@TW10@€TW20@ü.±Laskekaamme (nyt ensimm„isen kerran) Jori M„ntysalon mainitsemaesimerkkitapaus, jossa n=600:TW10@MIN=90 MAX=110TW10@PROB=1/6,1/6,1/6,1/6,1/6,1/6TW10@TIME COUNT STARTTW5@COMB D,CUR+3 / D=DISTRIBUTIONS,600,6 RESULTS=0TW20@TIME COUNT ENDTW10@TW20@€TW10@WWWi1wTW30@üTW10@Kysytty todenn„k”isyys on siis P=0.2159... ja sen laskemiseen tarvittiinper„ti N[D]=€ºtulosyhdistelm„„.TW20@ Aikaa kului = sekuntia.TW20@Kun perusvaihtoehtojen todenn„k”isyydet ovat yht„suuret (t„ss„ 1/6),yhteenlaskettavien m„„r„„ voi supistaa olennaisesti laskemallatuloksen luvun n partitioiden kautta.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±üTarkastellaan aluksi tapausta n=60, MIN=9, MAX=11.TW10@Luvun 60 partitiot 6 luvun (9,10 ja 11) summaksi luetteloidaanCOMB-operaatiolla seuraavasti:TW20@COMB P,CUR+1 / P=PARTITIONS,60,6 MIN=9 MAX=11TW20@€TW30@Ta1@Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üSallittuja partitioita on vain nuo 4 kappaletta, mink„ n„invaatimattomassa tapauksessa on helppo todeta suoraankin.Kun otetaan huomioon, ett„ varsinaiset tulosyhdistelm„t syntyv„tn„iden partitioiden permutaatioista, niinesim. tyyppi„ 9 9 10 10 11 11 olevia tapauksia on 6!/(2!*2!*2!)ja kullakin n„ist„ multinomitodenn„k”isyys60!/(9!*9!*10!*10!*11!*11!)/6^60eli erilaisten sallittujen vaihtoehtojen todenn„k”isyydet ovat                     tn. 9  9  9 11 11 11    0.0011204 9  9 10 10 11 11    0.00554599 9 10 10 10 10 11    0.0020335310 10 10 10 10 10    0.00007456ja yhteens„ 0.00877.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±Ta-1@üOlen liitt„nyt COMB-operaation t„h„nkin muotoon mahdollisuuden laskeatuo todenn„k”isyys suoraan k„ytt„m„ll„ t„smennyst„ MULTIN=1:TW20@COMB P,CUR+1 / P=PARTITIONS,60,6 MIN=9 MAX=11 MULTIN=1TW20@€TW30@.±TW20@Isommilla n-arvoilla luetteloinnin voi j„tt„„ pois (RESULTS=0) jaesim. tapauksessa n=600, MIN=90 MAX=110 saadaanTW10@TIME COUNT STARTTW5@COMB P,CUR+3 / P=PARTITIONS,600,6 MIN=90 MAX=110 MULTIN=1 RESULTS=0TW20@TIME COUNT ENDTW10@TW10@€TW20@üTW10@Ta1@Aikaa kului olennaisesti v„hemm„n, sill„ sallittuja partitioita onvain N[P]=€º. Kun aikaisemmin ker„ttiin summaa sallituistaperusyhdistelmist„ (DISTRIBUTIONS), yhteenlaskettavia oli yli 2 miljoonaa eli yli 400-kertainen m„„r„ ja t„m„ on suunnilleen samakuin laskentanopeuksien suhde.Suurilla n-arvoilla tuo suhde l„hestyy arvoa fact(6)=€º, sill„t„ll”in sellaisten n1,n2,n3,n4,n5,n6-yhdistelmien suhteellinen osuus,joilla luvut n1,n2,n3,n4,n5,n6 ovat kesken„„n erisuuria, l„hestyyykk”st„. Jokaistahan t„llaista partitiota vastaa 6! permutaatiota.Koska summa syntyy nyt suuremmista yhteenlaskettavista, joita onolennaisesti v„hemm„n, py”ristysvirheetkin v„henev„t.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±üYlivoimaisesti nopein tapa on kuitenkin laskea po. todenn„k”isyysrekursiivisesti.T„m„ tapahtuu tarkastelemalla yht„ vaihtoehtoa (esim. 1) muita(2,3,4,5,6) vastaan, jolloin kyseess„ on binomijakauma Bin(n,1/m).Olkoon nyt P(n,m,min,max) todenn„k”isyys sille, ett„ kunkinvaihtoehdon frekvenssi kokeessa j„„ v„lille [min,max].Kun merkit„„n lyhyesti P(n,m)=P(n,m,min,max), ko. todenn„k”isyysvoidaan laskea kokonaistodenn„k”isyyten„ helposti todennettavallapalautuskaavalla         maxP(n,m) = SUM   C(n,i)*(1/m)^i*(1-1/m)^(n-i)*P(n-i,m-1)         i=minreunaehdoin P(n,m) = 0, jos m*min>n tai m*max<n,            P(n,1) = 1.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±üSeuraava Survon editoriaalisen laskennan kaavio noudattaa tarkastijuuri kuvattua rekursiota:P(N,M):=if(M*min>N)then(0)else(P1(N,M))P1(N,M):=if(M*max<N)then(0)else(P2(N,M))P2(N,M):=if(M=1)then(1)else(P3(N,M))P3(N,M):=for(i=min)to(max)sum(C(N,i)*(1/M)^i*(1-1/M)^(N-i)*P(N-i,M-1))n=240 m=6 min=36 max=44TIME COUNT STARTP(n,m)=TIME COUNT ENDTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@€TW50@üB.±Ta1@üLaskentaa jouduttaa huomattavasti viel„ se, ett„ pannaan muistiinkaikkien rekursiivisesti m„„riteltyjen funktioiden arvot.Survon editoriaalisessa laskennassa t„m„ tapahtuu k„ytt„m„ll„funktion m„„rittelyss„ merkint„„ |= merkinn„n := sijasta.P(N,M)|=if(M*min>N)then(0)else(P1(N,M))P1(N,M)|=if(M*max<N)then(0)else(P2(N,M))P2(N,M)|=if(M=1)then(1)else(P3(N,M))P3(N,M)|=for(i=min)to(max)sum(C(N,i)*(1/M)^i*(1-1/M)^(N-i)*P(N-i,M-1))n=240 m=6 min=36 max=44TIME COUNT STARTP(n,m)=TIME COUNT ENDTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@€TW50@üB.±Ta1@T„ll„ tavoin nopeutettuna saatetaan editoriaalisella laskennallakink„sitell„ vaivatta esim. tapaus n=600:P(N,M)|=if(M*min>N)then(0)else(P1(N,M))P1(N,M)|=if(M*max<N)then(0)else(P2(N,M))P2(N,M)|=if(M=1)then(1)else(P3(N,M))P3(N,M)|=for(i=min)to(max)sum(C(N,i)*(1/M)^i*(1-1/M)^(N-i)*P(N-i,M-1))n=600 m=6 min=90 max=110TIME COUNT STARTP(n,m)=TIME COUNT ENDTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@€Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@B.±T„m„ algoritmi on liitetty my”s COMB-operaatioon yleistetyss„ muodossa,joka sallii vaihtelevat todenn„k”isyydet (PROB-t„smennys) jaerilaiset rajat eri vaihtoehdoille.TW30@Žskeinen tapaus n=600 lasketaan seuraavasti:TW10@COMB M,CUR+1 / M=µµµµµMULTIN_PROB,600,6µµµ MIN=90 MAX=110TW20@€TW30@.±N„in on mahdollista my”s tutkia tulosten tarkkuutta laskemallakaikkien multinomitodenn„k”isyyksien summa seuraavasti:TW20@TIME COUNT STARTTW5@COMB M,CUR+3 / M=MULTIN_PROB,600,6 MIN=0 MAX=600TW20@TIME COUNT ENDTW10@TW10@€üSumma on siedett„v„n l„hell„ ykk”st„ eli mit„„n laskutarkkuusongelmiaei esiinny.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta1@üJos sama teht„isiin aikaisemmalla partitio-tekniikalla, aikaakuluisi noin 700-kertaisesti, sill„ partitoita l”ytyy nyt jo981355696 eli l„hes miljardin verran.Arvioni mukaan verrattuna ensimm„iseen (6 sis„kk„isen ohjelmakierroksen,C-kielell„ toteutettuun) ratkaisuun t„m„ rekursiivinen menettelyon noin 5*700*700=2450000 kertaa nopeampi suurilla n-arvoilla!Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±Ta-1@üTarkastellaan lopuksi viel„ tapausta n=10000, jolla 10 prosentin rajatovat MIN=1500 ja MAX=1833.TW20@T„ll”inCOMB M,CUR+1 / M=MULTIN_PROB,10000,6TW10@€TW20@eli t„st„ n„hd„„n, ett„ kysytty todenn„k”isyys on jo varsin l„hell„ykk”st„.TW30@Ta1@T„ss„ tapauksessa kaikkien todenn„k”isyyksien summaksi saadaan0.999999999606738 eli tuloksien tarkkuus on viel„ n„inkin suurilla"heittom„„rill„" ainakin 9 merkitsev„„ numeroa.µµµµµNoppaongelman k„sittely p„„ttyy!Tp        Lopeta painamalla ENTER-nappia! (Keskeytys napilla .)@TVC1200@_@@Tp@üTa-1@0T!1@C6@TLTNLS@Tÿ


{u}LOAD NOPPA2{R}






 PROB=1/6,1/6,1/6,1/6,1/6,1/6{R}


















bTa1@TgC1@C1@C!@C1@C1@SCRATCH€üGPLOT /DEL ALL€BüREDIM 1000,100€Büüü   µµµµµµµ Permutaatiotesti Tarkastellaan kahta yhden muuttujan otostaDATA OTOS1: 148 73 56 63 90 42 106 125 129 161 ENDDATA OTOS2: 127 142 126 21 177 118 169 79 160 106 ENDjoista lasketut keskiarvot ja hajonnat ovatCORR OTOS1,CUR+1€OTOS1  N=10Variable  Mean        Std.dev.OTOS1     99.30000    40.85217CORR OTOS2,CUR+1OTOS2  N=10Variable  Mean        Std.dev.OTOS2     122.5000    46.47401Koska ensimm„iss„ otoksessa keskiarvo (99.3) n„ytt„„ pienemm„lt„ kuintoisessa (122.5), kiinnostaa, onko ero tilastollisesti merkitsev„.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@üSurvossa kysymys ratkeaa erilaisin edellytyksin k„ytt„m„ll„COMPARE-operaatiota seuraavasti (kts. COMPARE?):TW20@COMPARE OTOS1,OTOS2,CUR+1 / SIMUMAX=1000000TW20@€TW30@Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@TW10@Ta1@üSuoritukseen kulunut aika johtui siit„, ett„ tulostaulukossaviimeisin„ esiintyneiden P-arvojen laskenta tapahtui miljoona-kertaisella simulointikokeella. N„in p„„stiin n„kem„„n, ett„n„m„ satunnaistetut testit antavat hyvin samankaltaisiatuloksia kuin vastaava t-testi (t-jakauma-approksimaatiolla)ja Mann-Whitney-testi (normaalijakauma-approksimaatiolla).Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üT„ss„ tapauksessa kaikki 1-suuntaiset testit osoittavat,ett„ havaitun suuruinen poikkeama keskiarvoissa esiintyy yli10 prosentissa sellaisia tapauksia, joissa otokset ovat kotoisinsamasta perusjoukosta. Keskiarvojen ero ei siis ole tilastollisestimerkitsev„.Satunnaistetuilla testeill„ pyrit„„n toteuttamaan k„yt„nn”ss„ se, mit„jo R.A.Fisher tarkoitti permutaatiotestill„.Keskiarvojen testaamisessa permutointi-idea merkitsee yksinkertaisestiseuraavaa: Jos n„m„ 10 havainnon otokset otokset ovat samastaperusjoukosta, voidaan ajatella havainnot yhdistett„v„ksi 20 havainnonaineistoksi, josta OTOS1 on vain yksi C(20,10)=184756 mahdollisesta,yht„ todenn„k”isest„ otoksesta.Jos siis muodostetaan kaikki nuo l„hes 200000 10 havainnon otosta,lasketaan niist„ keskiarvot ja verrataan niit„ todellisuudessahavaittuun keskiarvoon 99.3, saadaan k„sitys, kuinka harvinainent„m„ havaittu tilanne on nollahypoteesin p„tiess„. Erityisestihavaitun keskiarvon alittavien ja tuon saman keskiarvon omaavienotosten suhteellinen osuus on permutaatiotestin P-arvo.K„yt„nn”ss„ on viel„ yksinkertaisempaa laskea otosten havaintosummatja t„ss„ tapauksessa l”yt„„ niiden otosten suhteellinen osuus, joillatuo summa on korkeintaan 10*99.3=993.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üSuurilla havaintom„„rill„ permutaatiotestin laskeminen on varsinty”l„st„. T„m„n vuoksi COMPARE-operaatiossa aito permutaatiotestikorvataan yksinkertaiseen otantaan perustuvalla satunnaistetullatestill„. T„ll”in arvotaan tuosta yhdistetyst„ (t„ss„ 20 havainnon)aineistosta tietty m„„r„ (t„ss„ per„ti miljoona) havaitun ykk”sotoksenkokoisia (t„ss„ 10) otoksia ja suoritetaan vastaavat laskutoimitukset.N„in saadaan satunnaisvaihtelua omaava P-arvo, joka koetoistojenlis„„ntyess„ l„hestyy stokastisesti todellista permutaatiotestinP-arvoa.COMPARE-operaatio kertoo P-arvon tarkkuudesta laskemalla koko ajan my”ssen keskivirhett„, joka t„ss„ tapauksessa on lopulta vain 0.00033(itse P-arvo oli 0.12535). Koska kyseinen P-arvo noudattaa n„inmonilla koetoistoilla varsin tarkkaan normaalijakaumaa, sille onhelppo muodostaa luottamusv„li.Yleens„ koetoistoja ei tarvitse tehd„ kovin paljon (oletus on COMPARE-operaatiolla 100000) ja ajon voi aina keskeytt„„ painamalla ENTER-nappia, kun havaitsee, ettei ole aihetta jatkaa. Toimituksentarvitsee harvoin kest„„ muutamaa sekuntia kauempaa.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üPermutaatiotestien ehdoton etu on se, ett„ ne toimivat huomattavastiv„ljemmin oletuksin kuin vaikkapa t-testi t„ss„ tapauksessa. Esim.mit„„n normaalijakauma-olettamusta ei tarvita.Mielest„ni satunnaistettujen testien pit„isi tulla esille jotilastotieteen perusopetuksessa, koska aikaisemmat laskentaanliittyv„t rajoitukset eiv„t en„„ ole k„ytt”„ rajoittavina estein„.Satunnaistetun keskiarvotestin ymm„rt„minenk„„n ei vaadi l„hesk„„nniin paljon teoreettisia esitietoja kuin t-testin.Satunnaistettu testi siis korvaa t„ydellisen permutaatiotestin k„yt„n-n”ss„. T„ss„ yhteydess„ on kuitenkin tarkoitus n„ytt„„, miten Survonavulla voidaan laskea tuo tarkka P-arvo em. testaustilanteessa.T„h„n tarkoitukseen saattaa l”yty„ varsin kehittyneit„ algoritmeja.Nyt tyydyt„„n kuitenkin pelk„st„„n Survon perustoimintojensoveltamiseen.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±Ta-1@üTarkan P-arvon laskemiseksi t„ss„ kahden 10 havainnon otoksentapauksessa k„yt„mme raakaa voimaa ja pyrimme luettelemaan kaikkimahdolliset C(20,10)=TW10@€184756TW10@ ykk”sotosta.TW30@Suurennamme ensin toimituskent„n 200000-riviseksi:TW10@REDIM 200000,100TW10@€TW10@Sitten teemme tuon luettelon COMB-operaatiolla seuraavasti:TW20@SYMBOLS=A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,TTW10@COMB C10,CUR+2 / C10=SUBSETS,20,10 RESULTS=1TW10@€TW30@ü¶Kirjaimin nimetyt havainnot ovat t„ss„ "aakkosj„rjestyksess„":TW30@TW20@TW20@TW10@TW10@Viimeisen„ siis 10 viimeisen kirjaimen "otos"TW40@TW10@¶¶TW20@üToistamme alkuper„iset otokset ja annamme arvoille kirjaintunnukset:TW10@ OTOS1Tp        K„ytet„„n PREFIX-J-tekniikkaa!@TW20@J           OTOS2J          Tp@TW20@A=B=C=D=E=F=G=H=I=J=K=L=M=N=O=P=Q=R=S=T=TW20@TW10@Sitten m„„rittelemme luettelon matriisiksi X, jonka talletamme:TW20@MATRIX X ///MAT SAVE XTW10@€TW10@üEmme en„„ tarvitse luetteloa, sill„ kaikki 184756 otosta ovatnumeerisessa muodossa talletettuina matriisitiedostoksi X.MAT.TW20@SCRATCHTW10@€TW10@Palautamme toimituskent„n rivien m„„r„ksi 1000:TW10@REDIM 1000,100TW10@€TW20@TW10@Otokset n„ytt„v„t matriisitiedostossa X.MAT t„llaisilta.TW5@Poimimme n„kyviin vain 20 ensimm„ist„ rivi„:TW10@MAT LOAD X(1:20,*),123,CUR+1TW10@€TW20@TW30@üTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±üOtossummat on yksinkertaisinta laskea k„ytt„m„ll„ matriisifunktiotaSUM(A), joka laskee matriisin A pystyrivisummat vaakavektoriksi.TW20@T„ll”in matriisin X vaakarivisummat (otossummat) saadaan suoraanpystyvektorina S komennollaTW20@MAT S=(SUM(X'))'TW10@€TW20@MAT S(0,1)="Summa" / Annetaan ainoalle sarakkeelle nimi 'Summa'.TW10@€TW10@N„ytteeksi poimitaan 10 ensimm„ist„ otossummaa:TW10@MAT LOAD S(1:10,1),12345,CUR+1TW10@€TW30@Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±üLopuksi lasketaan niiden otosten lukum„„r„, joilla summa on korkeintaan993.TW20@ Huom. Matriiseja voi tietyin ehdoin k„ytt„„ datana my”stilastollisissa operaatiossa.TW20@CORR S.MAT,CUR+1 / IND=Summa,0,993 PRIND=0TW10@€TW20@Po. otosten lukum„„r„ on siis N=€ja permutaatiotestin P-arvo on t„ss„ tapauksessaN/C(20,10)=TW10@€TW20@eli simuloinnilla saatu P-arvo 0.12535 on todella l„hell„t„t„ teoreettista tulosta.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±Ta1@üAito permutaatiotesti jo kaksinkertaisilla havaintom„„rill„ onmielet”n teht„v„, sill„ mahdollisten ykk”sotoksia l”ytyy per„tiC(40,20)=137846528820.Vaikka t„ydellist„ l„pik„ynti„ olisikin mahdollista lyhent„„„lykk„ill„ algoritmeilla, en pid„ sellaisten kehitt„mist„kovinkaan tarpeellisena.Satunnaistamistekniikka riitt„„ mainiosti kaikissa j„rkeviss„tilanteissa.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±Ta-1@üTeknisen„ n„ytteen„ t„st„ kaksinkertaistetaan aikaisemmat otoksetDATA OTOS12: 148 73 56 63 90 42 106 125 129 161             148 73 56 63 90 42 106 125 129 161 ENDDATA OTOS22: 127 142 126 21 177 118 169 79 160 106             127 142 126 21 177 118 169 79 160 106 ENDja aktivoidaanCOMPARE OTOS12,OTOS22,CUR+1TW20@€TW50@N„in muutamassa sekunnissa todetaan, ett„ keskiarvojen eroon 5 prosentin tasolla merkitsev„.µµµµµPermutaatiotestin k„sittely p„„ttyy!Tp        Lopeta painamalla ENTER-nappia! (Keskeytys napilla .)@TVC1200@_@@Tp@ü>DEL X.MAT€>DEL S.MAT€>DEL %%1.MAT€ü0T!1@C7@TLTNLS@Tÿ


{u}LOAD OTOKSET{R}

















bTa1@TgC1@C1@C!@C1@C1@SCRATCH€üGPLOT /DEL ALL€BüREDIM 2000,200€Bü   µµµµµµµ Symmetrinen satunnaiskulku m-ulotteisessa avaruudessa    µµ "XY-tasossa „ksy eksyy!"T„m„n katsauksen taustalla on William Fellerin teoksenAn Introduction to Probability Theory and Its Applications, Vol.I(Second Edition 1957) luku XIV.7 "Random Walks in the plane and space".Tein aiheesta vuonna 1959 tilastotieteen seminaariesitelm„n,jossa sain mielest„ni johdettua yksinkertaisemman lausekkeen2-ulotteisessa tapauksessa siirtym„todenn„k”isyydelle n askeleellaorigosta pisteeseen (x,y) kuin mit„ Feller esitt„„ kirjassaan.Saatoin my”s osoittaa helposti tuon lausekkeen avulla satunnaispisteen(x,y) jakauman l„hestyv„n 2-ulotteista normaalijakaumaa.L„hetin Fellerille kirjeen n„ist„ havainnoistani ja sain h„nelt„yst„v„llisen vastauksen, jossa h„n lupasi k„ytt„„ n„it„ tuloksiakirjansa tulevissa painoksissa harjoitusteht„vin„ "if any".Kun kolmas painos ilmestyi, mik„„n ei kuitenkaan ollut muuttunut.Toistan t„ss„ mm. nuo tarkastelut ja havainnollistan asioitaSurvon suomin keinoin.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@ü1-ulotteisessa satunnaiskulussa liikutaan lukusuoran pisteiss„...,-3,-2,-1,0,1,2,3,... l„htien liikkeelle pisteest„ 0.Jos ollaan pisteess„ x, seuraavalla askeleella siirryt„„npisteeseen x+1 todenn„k”isyydell„ p ja pisteeseen x-1 todenn„k”isyydell„q=1-p.T„ll”in todenn„k”isyys, ett„ n askeleen j„lkeen ollaan pisteess„ x, onP1(n,x)=C(n,a)*p^a*q^b, miss„ a=(n+x)/2 ja b=(n-x)/2.a on oikealle suuntautuneiden askelten ja b vasemmalle suuntautuneidenaskelten lukum„„r„ (a+b=n). Jos a (kuten my”s b) ei ole kokonaisluku,P1(n,x)=0.Symmetrisess„ satunnaiskulussa, jossa p=q=1/2 saadaanP1(n,x)=C(n,(n+x)/2)*2^(-n), kun n+x on parillinen jaP1(n,x)=0, kun n+x on pariton.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@ü2-ulotteisesssa, symmetrisess„ satunnaiskulussa siirryt„„n pisteest„(x,y) yhdell„ askeleella yhteen pisteist„ (x+1,y),(x-1,y),(x,y+1),(x,y-1) ja kullakin siirtym„ll„ on todenn„k”isyys 1/4.Olkoon nyt P2(n,x,y) todenn„k”isyys sille, ett„l„hdett„ess„ liikkeelle origosta (0,0) ollaan n askeleen j„lkeenpisteess„ (x,y).T„lle todenn„k”isyydelle Feller tarjoaa (harjoitusteht„v„n„) lausekkeen,joka on hyvin ep„havainnollinen kaksinkertainen integraali. Toden-n„k”isyyden voi kuitenkin ilmaista yksinkertaisesti kahdenbinomitodenn„k”isyyden tulona seuraavalla p„„ttelyll„.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@ü@!T!1@CRWALK@;SUR-SAVEü;*-WKUVA1üT!1@CRWALK@;SUR-RESTORE0@&Tb0@üKannattaa "kiert„„ koordinaatistoa 45 astetta" eli tarkkailla"liikkujan" sijaintia suorilla     x+y=s,  s=...-3,-2,-1,0,1,2,3,...,     x-y=t,  t=...-3,-2,-1,0,1,2,3,...,jolloin "liikkujan" siirtyess„ n askeleella alkuper„isess„koordinaatistossa pisteeseen (x,y) se siirtyy "kierretyss„koordinaatistossa" pisteeseen (s,t).Nyt kuitenkin on helppo havaita, ett„ liikkuminen s-suorilla jat-suorilla on kummallakin erikseen yksiulotteista, symmetrist„satunnaiskulkua ja n„m„ prosessit ovat toisistaan riippumattomia!N„in P2(n,x,y)=P1(n,s)*P1(n,t)              =P1(n,x+y)*P1(n,x-y)              =C(n,(n+x+y)/2)*2^(-n)*C(n,(n+x-y)/2)*2^(-n)              =C(n,(n+x+y)/2)*C(n,(n+x-y)/2)*4^(-n),kun n+x+y on parillinen kokonaisluku ja P2(n,x,y)=0 muuten.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üGPLOT /DEL ALL€BüKoska 2-ulotteisessa satunnaiskulussa liikutaan kerrallaan vainjommankumman koordinaattiakselin suuntaisesti, saattaisi tuntua silt„,ett„ P2(n,x,y) riippuisi suunnasta (y/x) siten, ett„ jos tarkastellaankahta pistett„ (x1,y1) ja (x2,y2), joiden et„isyydet origosta ovatsamat ja jos (x1,y1) on l„hemp„n„ jompaakumpaa koordinaattiakseliakuin (x2,y2), niin P2(n,x1,y1) > P2(n,x2,y2).N„in onkin asian laita pienill„ askelm„„rill„ n, kuten havaitaanseuraavasta esimerkist„.Pisteet (5,0) ja (3,4) ovat yht„ kaukana origosta.M„„ritell„„nP2(n,x,y):=C(n,(n+x+y)/2)*C(n,(n+x-y)/2)*4^(-n)ja erityisestiP34(n):=P2(n,3,4)P50(n):=P2(n,5,0)Tarkastellaan n„iden todenn„k”isyyksien suhdettaS(n):=P34(n)/P50(n)T„ll”inTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üTa-1@  S(7)=TW20@€TW20@  S(9)=TW10@€TW10@ S(11)=TW10@€TW10@ S(13)=TW5@€TW5@ S(15)=€ S(25)=€ S(35)=€S(101)=€S(201)=€S(301)=€TW30@Ta1@eli aluksi P34(n) on pienempi kuin P50(n), mutta askelluvun nkasvaessa n„iden todenn„k”isyyksien suhde l„hestyy selv„sti ykk”st„.T„m„ viittaa siihen, ett„ suurilla askelm„„rill„ suunnalla ei olemerkityst„ ja "liikkujan" jakauma on asymptoottisesti samalla laillasymmetrinen origon suhteen joka suunnassa.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üHavainnollistaan ko. jakaumaa piirroksella, joka kuvaa tilannetta40 ja 41 askeleen j„lkeen.Tehd„„n aluksi pisteiden (X,Y) X,Y=-20,-19,...,19,20 tiedosto XY:Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@üFILE DEL XYTW10@€TW10@COMB L,CUR+1 / L=LATTICE,2 MIN=-20,-20  MAX=20,20TW20@€TW30@üTW10@TW10@TW10@X   YTW10@DATA KTW10@FILE COPY K TO XY / Kopioidaan hilapisteist” tiedostoksi XY.TW20@€TW10@TW10@SCRATCH TW10@€TW20@.±Lasketaan pistetodenn„k”isyydet N=40 askeleen j„lkeen:TW10@VAR P40:8 TO XYTW10@P40=C(N,(N-abs(X)-abs(Y))/2)*C(N,(N-abs(X)+abs(Y))/2)/4^NTW20@üTW10@€TW10@TW10@üja n„iden neli”juuret:TW10@VAR P40=sqrt(P40) TO XYTW20@€TW10@.±TW10@Lasketaan pistetodenn„k”isyydet N=41 askeleen j„lkeen:TW10@VAR P41:8 TO XYTW10@P41=C(N,(N-abs(X)-abs(Y))/2)*C(N,(N-abs(X)+abs(Y))/2)/4^NTW10@üTW10@€TW10@TW10@üja n„iden neli”juuret:TW10@VAR P41=sqrt(P41) TO XYTW20@€TW10@Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@ü.±üFILE SHOW XY / katsotaan pisteen (0,0) todenn„k”isyysTW20@Ta-7@€ü³0³0²Ta7@TW20@ü ja todetaan, ett„se on noin 0.125^2.TW20@.±Ta1@Piirret„„n 40 askeleen j„lkeiset pistetodenn„k”isyydet ympyr”in„ niin,ett„ ympyr„n ala on verrannollinen ko. todenn„k”isyyteen:SCALE=-20,20  WSIZE=WY/2,WY/2 WHOME=WX-WY/2,WY/2  (SURVO MM 15.4.2001)MODE=1000,1000 XDIV=1,10,1 YDIV=1,10,1 HEADER= XLABEL= YLABEL=GPLOT XY,X,YPOINT=0,10,P40,µµµµµ0.125µµµ (kts. POINT?)  OUTFILE=AüTa-1@TW40@€TW40@.±Ta1@Piirret„„n vastaavasti 41 askeleen j„lkeiset todenn„k”isyydetedellisen kuvan p„„lle punaisina ympyr”in„:SCALE=-20,20  WSIZE=WY/2,WY/2 WHOME=WX-WY/2,WY/2MODE=1000,1000 XDIV=1,10,1 YDIV=1,10,1 HEADER= XLABEL= YLABEL=GPLOT XY,X,YPOINT=[FRED],0,10,P41,0.125  INFILE=AüTa-1@TW40@€TW40@üKuvasta hahmottuu jo kohtuullisen hyvin,miten jakauman tasarvok„yr„t tulevatolemaan origokeskisi„ ympyr”it„.üTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta1@ü.±üGPLOT /DEL ALL€BüTutkitaan hieman tarkemmin satunnaiskulun asymptoottistak„ytt„ytymist„ dimensioissa 1 ja 2.Yksiulotteinen symmetrinen tapaus:Tarkastellaan satunnaismuuttujaa Sn, joka kuvaa pisteenasemaa s n askeleen j„lkeen.Se on muunnos Sn=2*(X-n/2) binomijakautuneesta muuttujasta Xparametrein bin(n,1/2)Koska E(X)=n*p=n/2 ja D(X)=sqrt(n*p*q)=sqrt(n/4),E(Sn)=2*(n/2-n/2)=0 ja D(Sn)=2*D(X)=sqrt(n).Kun n kasvaa rajatta, [X-E(X)]/D(X) l„hestyy normaalijakaumaa N(0,1),jolloin muuttujan X lineaarimuunnoksena my”s Sn on asymptoottisestinormaalinen parametrein 0,n.Sn:n jakauman tiheysfunktio on siis asymptoottisesti          1             -x^2f(x)= ------------ exp(------) .      sqrt(2*pi*n)       2*nTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üKaksiulotteinen symmetrinen tapaus:Kierretyss„ koordinaatistossa s ja t ovat riippumattomia muuttujiaja molemmat jakautuneet kuten Sn edell„Siis niiden asymptoottinen tiheysfunktio on                    1         -(s^2+t^2)f(s,t)=f(s)f(t)= -------- exp(----------)  .                  2*pi*n         2*nKoska muunnoksen x+y=s, x-y=t funktionaalideterminantti on 2 jas^2+t^2=2*(x^2+y^2),f(x,y)=2*f(s(x,y),t(x,y))          1        -(x^2+y^2)      = ------ exp(----------)         pi*n          nKysymyksess„ on origokeskinen, "joka suuntaan saman varianssin omaava"2-ulotteinen normaalijakauma.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üKoska yleisesti exp-funktion argumentti on muotoa -1/2*x'inv(S)x, miss„S on kovarianssimatriisi, t„ss„ tapauksessa on      | n/2  0  |  S = |         |      | 0    n/2|eli muuttujien x ja y (samoin kuin kaikkiin suuntiin lasketut)hajonnat ovat suurudeltaan sqrt(n/2).Yleisesti on todettavissa, ett„ m-ulotteisessa symmetrisess„satunnaiskulussa asymptoottinen jakauma on vastaavalla tavallaorigokeskinen, riippumattomien, saman keskihajonnan sqrt(n/m)omaavien, normaalisten muuttujien yhteisjakauma.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üPaluu takaisin origoon on palautuva tapahtuma (kts. Feller, luku XIII).m-ulotteisessa satunnaiskulussa em. tiheysfunktio on muotoa                     Cm          -m*(x1^2+...xm^2)f(x1,x2,...,xm) = --------- exp( ---------------- )                   n^(m/2)             2*nmiss„ Cm riippuu vain dimensiosta m ja erityisesti t„ll”in                  Cmf(0,0,...,0) = --------- .                n^(m/2)T„st„ voidaan p„„tell„, ett„ paluutodenn„k”isyydet u(2n) ovatmuotoa           Kmu(2n) = ---------      (Km vakio)         n^(m/2)jolloin niiden muodostama sarja hajaantuu, kun m=1 tai 2 muttasuppenee, kun m=3,4,...Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üT„m„ tarkoittaa palautuvien tapahtumien teorian perusteella sit„, ett„dimensioilla 1 ja 2 palataan todenn„k”isyydell„ 1 takaisinl„ht”kohtaan (origoon).Sen sijaan suuremmilla ulottuvuuksilla paluutodenn„k”isyys onykk”st„ pienempi ja pienenee jatkuvasti dimension kasvaessa.N„m„ tulokset johti G.Polya jo vuonna 1921.Huom. Kaikilla ulottuvuuksilla paluuajan odotusarvo on „„ret”n.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@TW10@Ta1@üNykyisin nuo paluutodenn„k”isyydet voidaan laskea hyvinkintarkasti. Fellerin aikaan tiedossa oli vain McCrean ja Whipplenvuonna 1940 julkaisema tutkimus, jonka mukaan 3-ulotteisessasatunnaiskulussa paluutodenn„k”isyys on noin 0.35.Tuon todenn„k”isyyden laskeminen suoraan (ilman vaativampiaanalyyttisia keinoja) on jonkin verran konstikasta.Yrit„n kuitenkin laskea paremman likiarvon (kuin 0.35) Survonavulla hyvin alkeellisella tavalla seuraavasti:Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üP„„dyin jo aikoinaan seminaariesitelm„ss„ni siihen, etteitodenn„k”isyyden P3(n,x,y,z) (n askeleella origosta pisteeseen (x,y,z))esitt„minen onnistu esim. 3 binomitodenn„k”isyyden tulona.Paluutodenn„k”isyys 2n askeleella u(2n)=P3(2n,0,0,0) on kirjoitettavissamultinomitodenn„k”isyyksien summana muotoon                  n    n-iu(2n) = 6^(-2n)*SUMMA SUMMA (2n)!/[i!j!(n-i-j)!]^2  .                 i=0   j=0.±N„it„ todenn„k”isyyksi„ voi Survossa laskea kaaviollau2(N):=for(I=0)to(N)sum(S1(N,I))S1(N,I):=for(J=0)to(N-I)sum(exp(S(N,I,J)))S(N,I,J):=-2*lfact(I)-2*lfact(J)-2*lfact(N-I-J)&          +lfact(2*N)-2*N*log(6)ACCURACY=16Esimerkiksi:Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@TW10@üu2(1)=TW10@€TW10@1/6  (siis paluu 2 askeleella origoon)TW20@u2(2)=TW10@€TW10@5/72TW10@u2(3)=TW10@€TW10@155/3888TW10@u2(4)=TW10@€TW10@2485/93312TW10@u2(10)=TW10@€TW10@u2(100)=TW10@€TW10@Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±Ta1@üN„m„ todenn„k”isyydet eiv„t sellaisinaan riit„ kysytyn todenn„k”isyydenlaskentaan, sill„ se on muotoa      ooP3 = SUMMA f2(n)      n=1miss„ f2(n) = P[palataan origoon 1. kerran askeleella 2*n].Todenn„k”isyydet f2(n) voidaan kuitenkin laskea u2(n)-lukujenavulla.Koska askeleella 2*n voidaan olla takaisin origossa niin, ett„se tapahtuu ensimm„isen kerran jollakin askelm„„rist„ 2,4,...,2*n,saadaan kokonaistodenn„k”isyyten„u2(n) = f2(1)u2(n-1) + f2(2)u2(n-2) + ... + f2(n-1)u2(1) + f2(n)eli t„st„ k„„nt„enf2(n) = u2(n) - f2(1)u2(n-1) - f2(2)u2(n-2) - ... - f2(n-1)u2(1)joten t„ss„ on kaava, jolla luvut f2(n) voi laskea edelt„vien u2- jaf2-lukujen avulla, kun l„ht”kohtana on f2(1)=u2(1).Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Lasketaan Survon matriisitulkilla luvut f2(n), n=1,2,...,100:Aluksi talletetaan luvut u2(n), n=1,2,...,100 vektoriin U:.±u2(N):=for(I=0)to(N)sum(S1(N,I))S1(N,I):=for(J=0)to(N-I)sum(exp(S(N,I,J)))S(N,I,J):=-2*lfact(I)-2*lfact(J)-2*lfact(N-I-J)&          +lfact(2*N)-2*N*log(6)n=100MAT U=ZER(n,1)Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üTa-1@TW10@€TW10@MAT #TRANSFORM U BY u2(I#)  / T„m„ saattaa vied„ hieman aikaa!TW10@€TW10@Koska palautuvien tapahtumien yhteydess„ usein tarvitaan „sken johdettuapalautuskaavaa u2-luvuista f2-lukuihin, olen liitt„nyt Survonmatriisitulkkiin uuden operaation, joka laskee u2-lukujen vektorista Uf2-lukujen vektorin F:TW50@MAT #U_TO_F U TO FTW20@€TW10@Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±100 ensimm„isen f2-luvun summaksi saadaanTW10@MAT S=SUM(F)TW10@€TW10@MAT_S(1,1)=TW10@€TW30@mik„ (jos uskotaan Fellerin mainitsemaa arvoa koko summalle) onviel„ kaukana totuudesta.TW20@Koska on syyt„ odottaa f2(n)-luvuilta siisti„ asymptoottistak„ytt„ytymist„, yritet„„n mallintaa ne tyyppi„ f2(n)=a/n^bolevalla approksimaatiolla, kun n>100.TW30@T„t„ varten muunnetaan vektori F Survon havaintotiedostoksi F:TW20@FILE DEL FTW10@€TW10@FILE SAVE MAT F TO F / TYPE=8TW10@€TW10@ja lis„t„„n ja nimet„„n uusia muuttujia seuraavasti:TW10@FILE UPDATE FFIELDS:   1 SA_   8 n   2 NA_   8 F       (#.#############)   3 NR_   8 RES     (##.############)ENDTW10@€TW10@üTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±Kun mallia f2(n)=a/n^b sovitetaan aineistoon F Survon ESTIMATE-operaatiolla, havaitaan, ett„ b=3/2 on mit„ ilmeisimmin "oikea"arvo ja parametrin a estimaatti saadaan seuraavasti k„ytt„enaineiston F 10 viimeist„ havaintoa:TW40@SYSTEM accuracy=16 / Asetetaan suuri tulostustarkkuusTW10@€TW10@a=0.1 / alkuarvoMODEL M1F=a/n^1.5ESTIMATE F,M1,CUR+1 / METHOD=M   IND=ORDER,91,100TW30@€TW30@.±Poimitaan esille viimeiset f2-arvot ja mallin residuaalit:TW10@FILE LOAD F,CUR+1 / VARS=n,F,RES  IND=ORDER,91,100TW20@€TW30@üResiduaalien k„ytt„ytyminen viittaa siihen, ettei malli ole aivanoikea, mutta niiden pienuus antaa aihetta uskoa, ett„ malliavoi silti soveltaa.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±Ta1@Jos siis summassa f2(1)+f2(2)+...+f2(100)+f2(101)+....sata ensimm„ist„ termi„ otetaan sellaisinaan ja jatko korvataanjuuri estimoiduilla arvoilla, kysytylle todenn„k”isyydellesaadaan likiarvokaavaP3=MAT_S(1,1)+a*(zeta(1.5)-s100)miss„MAT_S(1,1) oli 100 ensimm„isen f2-luvun summa, a on juuri estimoitua=0.101718908247253ja s100 on yliharmonisen sarjan 100 ensimm„isen termin summas100=for(i=1)to(100)sum(1/i^1.5)ja zeta(1.5) (Riemannin zeta-funktio)on ko. sarjan kaikkien termien summa. Summan laskeminen raa'allayhteenlaskulla on melko toivoton teht„v„, sill„ sarja suppeneevarsin hitaasti. Riemannin zeta-funktio reaalisella argumentillaantaa tuon summan ja t„t„ funktiota varten on olemassa nopeitaalgoritmeja. Survossa k„ytetyn algoritmin on kehitt„nyt P. Borwein.N„in saamme likiarvonTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@P3=TW10@€TW40@Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±TW10@Ta1@üKuten aikaisemmin mainitsin, ko. paluutodenn„k”isyys voidaan laskeahuomattavasti tarkemmin ja tehokkaammin k„ytt„m„ll„ voimakkaampiaanalyyttisia keinoja. P3 saatetaan lausua gamma-funktion avullajopa suljetussa muodossaP3=1-1/u3 gamma(X):=exp(lgamma(X))u3=sqrt(6)/(32*pi^3)*gamma(1/24)*gamma(5/24)*gamma(7/24)*gamma(11/24)pi=3.141592653589793eliTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@P3=TW10@€TW20@Likiarvomme oli siis oikea noin 4 desimaalin tarkkuudella.Tarkempia tietoja tehokkaammista keinoista l”ytyymm. verkko-osoitteestahttp://pauillac.inria.fr/algo/bsolve/constant/polya/polya.htmlüµµµµµSatunnaiskulkukatsaus p„„ttyy!Tp        Lopeta painamalla ENTER-nappia! (Keskeytys napilla .)@TVC1200@_@@Tp@ü0T!1@C8@TLTNLS@Tÿ











































üü *GLOBAL*HOME=0,0 SIZE=649,349 HEADER=  FRAME=0 WAIT=0XDIV=49,552,48 YDIV=17,306,26 XSCALE=0,23 YSCALE=0,17LINETYPE=[VAALEANHARMAA][viivatyyppi(0)]XLABEL= YLABEL=X0=-9 X1=15WSIZE=WX/2,17/23*WX/2 WHOME=WX/2,WY-17/23*WX/2-30............a=0,23,1 t=0,23,23 k=0,1,1 OUTFILE=KOORDGPLOT x(t)=k*t+(1-k)*a,y(t)=k*a+(1-k)*t / koordinaatisto€............ox=8 oy=6 t=0,23,23 k=0,1,1 LINETYPE=[MUSTA][viivanleveys(5)]INFILE=KOORD OUTFILE=KOORDGPLOT X(t)=k*t+(1-k)*ox,Y(u)=k*oy+(1-k)*t / koordinaattiakselit€............XSCALE=[PIENI],-8(1)15  LINETYPE=[MUSTA][viivatyyppi(0)]YSCALE=[PIENI],-6(1)11  FRAME=1 INFILE=KOORDDATA REITTIX Y0 01 01 11 21 32 32 22 13 13 23 34 3OUTFILE=AGPLOT REITTI,X,Y / LINE=[viivanleveys(7)][VAALEANPUNAINEN],1€............XSCALE=[PIENI],-8(1)15YSCALE=[PIENI],-6(1)11  FRAME=0INFILE=A  OUTFILE=AX=X0,X1,5GPLOT Y(X)=-X+T / T=6,8,1€............XSCALE=[PIENI],-8(1)15YSCALE=[PIENI],-6(1)11  FRAME=0PEN=[CourierB(20)][BLACK]INFILE=A  OUTFILE=AX=X0,X1,5TEXTS=T1,T2,T3,T4T1=x_+_y_=_s,485,86T2=x_-_y_=_t,485,250T3=x,220,170T4=y,330,105GPLOT Y(X)=X-S / S=0,2,1€GPLOT /DEL ALL€GPLOT FILE A€Tÿ TNL-KULKU -sukron aliohjelma

bTa1@TgC1@C1@C!@C1@C1@SCRATCH€üGPLOT /DEL ALL€BüREDIM 1000,200€Büüü   µµµµµµµ Ehdollistamisperiaate (AA-AB-peli) MM ja NN heitt„v„t rahaa toistuvasti. MM voittaa, jos 2 kruunaa (AA)tulee ennen yhdistelm„„ kruuna, klaava (AB). NN voittaa, josAB tulee ennen AA:ta.Jos heitet„„n samaa rahaa, peli on tasapuolinen pelaajienkannalta, sill„ se ratkeaa heti sen j„lkeen, kun on saatuensimm„inen kruuna (A). Jos seuraavalla heitolla tulee kruuna (A),MM voittaa, jos klaava (B), NN voittaa.Mit„ tapahtuukaan, jos kumpikin pelaajista heitt„„kin omaakolikkoaan?Tilanne ei ilmeisestik„„n ole en„„ sama, koska peli voinyt p„„tty„ my”s tasan.Mutta onko peli edelleen reilu eli onko molemmilla yht„suurivoittotodenn„k”isyys?T„m„n kysymyksen k„sittelyss„ ns. ehdollistamisperiaate onhy”dyllinen tarkastelutapa. Sit„ voidaan soveltaa sek„ todenn„k”isyyk-sien ett„ odotusarvojen laskemisessa.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Tutkitaan ensin yksinkertaisempaa tilannetta (A-B-peli), jossa MMvoittaa, jos h„n omaa lanttiaan heitt„ess„„n saa kruunan (A) ennenkuinNN omaa lanttiaan heitt„ess„„n saa klaavan (B).T„ss„ tapauksessa on selv„„, ett„ peli on reilu, mutta mitk„ ovatMM:n ja NN:n (yht„suuret) voittotodenn„k”isyydet ja mik„ on tasapelintodenn„k”isyys?Tasapelih„n voi synty„ jo ensimm„isell„ heittoparilla, kun MM saakruunan ja NN saa klaavan.Yrit„p„ ratkaista t„m„ ongelma, ennenkuin jatkat t„m„n jaksonseuraamista.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±A-B-pelin ratkaisu:Ensimm„isen heittoparin j„lkeen syntyy 4 yht„ todenn„k”ist„ tilannetta:Tapahtuma    MM     NN      Seuraus______________________________________AA            A      A      MM voittaaAB            A      B      Peli p„„ttyy tasanBA            B      A      Peli jatkuu ja alkaa ik„„nkuin alustaBB            B      B      NN voittaaOlkoon MM:n voittotodenn„k”isyys s.T„ll”in s saadaan kokonaistodenn„k”isyyten„ (ehdollistettuna)s=P(AA)*1+P(AB)*0+P(BA)*s+P(BB)*0 =1/4            +1/4*seli t„st„ yht„l”st„ ratkaistuna on s=1/3.Symmetriasyist„ my”s NN:n voittotodenn„k”isyys on 1/3, jollointasapelin todenn„k”isyydeksi j„„ 1-2/3=1/3.N„keek” joku suoraan, miksi kaikki kolme todenn„k”isyytt„ ovat samoja?Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±üPalattakoon alkuper„iseen teht„v„„n:Olkoon MM:n voittotodenn„k”isyys s ja merkit„„n ensimm„isen heittoparin(AA,AB,BA,BB)j„lkeisi„ MM:n ehdollisia voittotodenn„k”isyyksi„ seuraavasti:X[AA]=P[MM voittaa ehdolla AA],X[AB]=P[MM voittaa ehdolla AB],X[BA]=P[MM voittaa ehdolla BA],X[BB]=P[MM voittaa ehdolla BB].T„ll”in s=X[BB], koska heittoparin BB j„lkeen peli ik„„nkuin alkaaalusta (kummallakaan pelaajalla ei ole alla suotuisaa tulosta).Samalla tavalla kuin „skeisess„ yksinkertaisessa A-B-peliss„, esitet„„ntodenn„k”isyydet X[AA],X[AB],X[BA],X[BB] ehdollistettuina kokonais-todenn„k”isyyden kaavan avulla.Asiaa on ehk„ helpompi seurata, jos yleist„en merkitsemme kruunantodenn„k”isyytt„ p:ll„ ja klaavan q:lla (p+q=1).üTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@TW10@Ta1@üSiten ehdollistamalla toisen heittoparin suhteen saadaanX[AA] = P(AA)*1   + P(AB)*0  + P(BA)*X[BA]    + P(BB)*0        MM voitti   tasapeli   peli jatkuu      NN voitti                               tilanteesta BA      = p^2       + 0        + p*q*X[BA]      + 0 .üTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@TW10@Ta1@üVastaavasti p„„tell„„n yht„l”tX[AB] = p^2 + p*q + p*q*X[BA] + q^2*X[BB]X[BA] = p^2*X[AA] + 0 + p*q*X[BA] + 0X[BB] = p^2*X[AA] + p*q*X[AB] + p*q*X[BA] + q^2*X[BB]T„m„ 4 yht„l”n ja tuntemattoman lineaarinen yht„l”ryhm„ saadaan muotoon   1*X[AA]    +0*X[AB]      -p*q*X[BA]        +0*X[BB] = p^2   0*X[AA]    +1*X[AB]      -p*q*X[BA]      -q^2*X[BB] = p^2+p*q = p-p^2*X[AA]    +0*X[AB]  +(1-p*q)*X[BA]        +0*X[BB] = 0-p^2*X[AA]  -p*q*X[AB]      -p*q*X[BA]  +(1-q^2)*X[BB] = 0Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üFRAME=0 MODE=640,200 WSIZE=WX/2,WY/4 WHOME=WX-WX/2-30,WY-WY/4TITLE=Lineaarinen_yht„l”ryhm„GPLOT /FRAME / TEXTS=T T=[Courierb(40)],#LINES:CUR-6,CUR-3,50,200,50ü€ü.±eli kerroinmatriisi A onMATRIX A///  AA    AB      BA     BBAA    1     0    -p*q      0AB    0     1    -p*q   -q^2BA -p^2     0   1-p*q      0BB -p^2  -p*q    -p*q  1-q^2ja vakiovektori BMATRIX B///  vakioAA   p^2AB   pBA   0BB   0Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üGPLOT /DEL ALL€B.±Ta-1@Valitsemalla nyt arvot p=1/2 ja q=1-p talletetaan matriisit A ja BMAT SAVE ATW10@€TW10@MAT SAVE BTW10@€TW10@ja ratkaistaan yht„l”ryhm„ A*X=BTW10@MAT SOLVE X FROM A*X=BTW10@€TW10@MAT LOAD X,1.123456789012345,CUR+1TW10@€TW30@üTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üTW10@Ta1@MM:n voittotodenn„k”isyydelle s=X[BB] saadaan siis arvo0.322314049586777, joka on jonkin suhteellisen yksinkertaisenrationaaliluvun likiarvo. Niinp„ voidaankin todeta, ett„0.322314049586777(15:suhde)=Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@TW10@€TW20@eli "tarkka" MM:n voittotodenn„k”isyys on 39/121.üTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta1@üT„m„n j„lkeen esim. tasapelin todenn„k”isyys pystyt„„n m„„r„„m„„nhyvin helposti katsomalla tasapeli tilap„isesti my”s MM:n voitoksieli muuttamalla ensimm„inen yht„l”X[AA] = P(AA)*1   + P(AB)*0  + P(BA)*X[BA]    + P(BB)*0        MM voitti   tasapeli   peli jatkuu      NN voitti                               tilanteesta BAmuotoonX[AA] = P(AA)*1   + P(AB)*µµµµµ1µµµ  + P(BA)*X[BA]    + P(BB)*0        MM voitti   µµµµµMM voittiµµµ  peli jatkuu      NN voitti                               tilanteesta BAeli t„m„ lis„„ yht„l”ryhm„ss„ ensimm„isen vakiotermin arvostap^2 arvoon p^2+p*q=p. Muodostamme t„m„n mukaisen vakiovektorin B2ja ratkaisemme yht„l”ryhm„n A*Y=B2:üTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@TW10@üMAT B2=BTW10@€TW10@MAT B2(1,1)=p / "korjataan" ensimm„inen alkio"TW10@€TW10@MAT SOLVE Y FROM A*Y=B2TW10@€TW10@ACCURACY=16TW5@TW5@MAT_Y(BB,1)=TW10@€TW20@Nyt saatu "lis„tty" voittotodenn„k”isyys on tarkkaan0.4628099173553721(15:suhde)=TW20@€TW20@eli tasapelin todenn„k”isyys on erotus 56/121-39/121=17/121.TW20@Vastapelurin NN voittotodenn„k”isyys l”ytyy pelk„ll„ v„hennyslaskulla1-56/121=65/121=0.537...TW20@eli peli on NN:lle edullisempi suhteessa 65/39=5/3TW20@On aika yll„tt„v„„, ett„ peli suosii NN:„„, vaikka tasapelitkinluettaisiin MM:n hyv„ksi.üTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±Ta1@üKysyt„„np„ my”s, montako heittoa tarvitaan keskim„„rin, ett„toisaalta MM ja toisaalta NN saavuttaa tavoitteensa. T„h„nkin voidaank„tev„sti vastata ehdollistamisperiaatteella.Ehdollistaminen odotusarvoa laskettaessa tarkoittaa seuraavaa:Olkoot A1,A2,...,An toisensa poissulkevia tapahtumia todenn„k”isyyksinp1,p2,...,pn ja kattakoot ne yhdess„ kaikki vaihtoehdot eliP(A1+A2+...+An)=p1+p2+...+pn=1.Olkoon X samassa todenn„k”isyyskent„ss„ m„„ritelty satunnaismuuttuja,jolla on odotusarvo E(X).T„ll”in on voimassa yleisestiE(X)=p1*E(X|A1)+p2*E(X|A2)+...+pn*E(X|An)eli E(X) voidaan lausua t„ll„ tapaa painotettuna ehdollisten odotus-arvojen summana ja kaava on t„ysin analoginen kokonaistodenn„k”isyydenkaavan kanssa.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üYksinkertaisena osoituksena t„m„n kaavan hy”dyllisyydest„ m„„r„t„„ngeometrisen jakauman odotusarvo. Tarkastellaan toistokoetta, jossatapahtuman A todenn„k”isyys on p. Olkoon X satunnaismuuttuja, jokasaa arvon i, jos A tapahtuu i. kokeessa.Helposti p„„tell„„n, ett„ P(X=i)=(1-p)^(i-1)*p, i=1,2,3,...Odotusarvon tavanomainen laskeminen edellytt„„ pient„ puuhailuap„„ttym„tt”mien sarjojen kanssa, mutta ehdollistamisperiaatehoitaa asian paljon yksinkertaisemmin ilman, ett„ todenn„k”isyyksi„P(X=i) tarvitsee edes k„ytt„„.Olkoon E(X)=m. Ehdollistetaan laskenta kahden tapahtumanA1="A tapahtuu 1. kokeessa" ja  A2="A ei tapahdu 1. kokeessa" suhteen.T„ll”in saadaanE(X)=m=p*E(X|A1)+(1-p)*E(X|A2)      =p*1      +(1-p)*(m+1),sill„, jos A ei tapahdu 1. kokeessa, se menee "hukkaan" ja prosessiik„„nkuin alkaa alusta, jolloin ehdollinen odotusarvo kasvaa yhdell„alkuper„isest„ arvosta m.On syntynyt yht„l” m=p+(1-p)*(m+1), josta v„litt”m„sti irtoaam=1/p.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üPalataan nyt varsinaiseen kysymykseen eli montako heittoa tarvitaankeskim„„rin, ett„ toisaalta MM ja toisaalta NN saavuttaa tavoitteensa.AA-AB-peliss„.Tarkastellaan siis toistokoetta, jossa P(A)=p ja P(B)=q=1-p.Olkoon X=i, jos yhdistelm„ AA esiintyy 1. kerran i. kokeessaEsim. koesarjassa BABBAA... X=6.Mit„ on E(X)=mx ?Ehdollistetaan 2 ensimm„isen kokeen tuloksen suhteen:E(X|AA)=2E(X|AB)=mx+2, koska 2 ensimm„ist„ koetta menev„t hukkaan.E(X|B)=mx+1, koska 1. koe menee hukkaan.Sitenmx = p*[p*2+q*(mx+2)] + q*(mx+1),josta ratkaisemalla mx saadaan mx=(1+p)/p^2.Kun p=q=1/2, mx=6.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üOlkoon sitten Y=i, jos yhdistelm„ AB esiintyy 1. kerran i. kokeessaEsim. koesarjassa BBAAB... Y=5.Mit„ on E(Y)=my ?Ehdollistetaan ensimm„isen kokeen tuloksen suhteen:E(Y|A)=ma   siis odotusarvo ehdolla, ett„ A toteutuu 1. kokeessaE(Y|B)=my+1Siis my=p*ma+q*(my+1)Odotusarvon ma=E(Y|A) laskemiseksi ehdollistetaan 2. kokeen suhteen:E(Y|AA)=ma+1E(Y|AB)=2Siis E(Y|A)=ma=p*(ma+1)+q*2, josta ma=(2-p)/qja sijoittamalla yht„l””n     my=p*ma+q*(my+1)saadaanmy=1/(pq).Jos p=q=1/2, my=4 < 6=mx !NN tarvitsee siis keskim„„rin vain 4 heittoa, kun MM tarvitseeniit„ keskim„„rin 6.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@TW10@Ta1@üTulos on ensin„kem„lt„ yll„tt„v„. Useat pit„v„t intuitiivisestiodotusarvoja samoina.Jos todenn„k”isyytt„ p kasvatetaan, odotusarvojen ero alkaa tasoittua.Voidaan helposti todeta, ett„ mx=my, jos p on (sqrt(5)-1)/2=0.618...Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üLasketaan viel„ pelin keston odotusarvo, joka edell„ esitetynperusteella on varmasti pienempi kuin my=4.K„ytt„m„ll„ ehdollistamisperiaatetta odotusarvolle samaan tapaan kuinaikaisemmin tehtiin MM:n voittotodenn„k”isyydelle p„„dyt„„n j„lleen4 tuntemattoman lineaariseen yht„l”ryhm„„n, jossa on sama kerroin-matriisi A, mutta vakiovektorin alkiot ovat kaikki ykk”si„.Talletetaan siis vektoriMATRIX BM///  KestoAA   1AB   1BA   1BB   1MAT SAVE BMTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@üTW10@€TW10@ja ratkaistaan yht„l”ryhm„ A*M=BMMAT SOLVE M FROM A*M=BMTW20@€TW10@MAT LOAD M,1.123456789012345,CUR+1TW10@€TW30@üViimeinen alkio vastaa kysytty„ odotusarvoa ja sen tarkka arvo on384/121, sill„TW10@3.173553719008265(15:suhde)=TW10@€TW10@Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta1@.±üAA-BB-pelin "s„„nn”t" on mahdollista kuvata 7-tilaisen Markovin ketjunsiirtym„todenn„k”isyysmatriisina P7:MATRIX P7///  AA   AB   BA   BB   MM   NN TASAAA    0    0  p*q    0  p^2  q^2  p*qAB    0    0  p*q  q^2    p    0    0BA  p^2    0  p*q    0    0    q    0BB  p^2  p*q  p*q  q^2    0    0    0MM    0    0    0    0    1    0    0NN    0    0    0    0    0    1    0TASA  0    0    0    0    0    0    1T„ss„ MM (MM voittaa), NN (NN voittaa) ja  TASA (tasapeli) ovatlopputiloja, joista yhteen p„„dyt„„n aina lopulta l„hdett„ess„alkutilasta BB.Esim. MM:n voittotodenn„k”isyys tapauksessa p=1/2, q=1-p lasketaant„st„ matriisista seuraavasti:Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@üTW10@MAT SAVE P7            / Talletetaan P7.TW10@€TW10@MAT A4=P7(AA:BB,AA:BB) / Poimitaan 4 ensimm„ist„ rivi„ ja saraketta.TW10@€TW10@MAT A4=IDN(4,4)-A4     / T„m„ on sama kuin aikaisempi A-matriisi.TW10@€TW10@MAT B4=P7(AA:BB,MM)    / T„m„ on sama kuin aikaisempi B-matriisi.TW10@€TW10@MAT SOLVE X4 FROM A4*X4=B4TW10@€TW10@MAT_X4(BB,MM)=TW10@€TW10@eli tulos on luonnollisesti sama kuin aikaisemmin laskettu s(BB).Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta1@.±Ta-1@üTarkastellaan lopuksi AA-BB-peli„ "k„yt„nn”ss„" simulointikokeella.TW10@Toistetaan heittokoe (100 heittoa) kahdella kolikolla 10000 kertaa jakatsotaan kussakin kokeessa, kumpi tulee ennen AA vai AB.TW30@Pelaajan MM kolikko:TW10@FILE MAKE AA,100,10000,H,1TW10@€TW10@.±Arvotaan 100*10000 heittoa (0=kruuna, 1=klaava):TW10@TRANSFORM AA BY #UNIFORM(0,2) / RND=rand(1998)TW20@€TW10@.±Katsotaan kussakin koesarjassa, mill„ heitolla syntyy ensimm„inenkahden per„kk„isen 0:n yhdistelm„:TW10@VARSTAT AA,AA:2,FIRST,L / L=0,0TW20@€TW10@.±TW10@Katsellaan heittosarjojen alkup„„t„ ja tapahtuman 0 0 esiintymist„:TW10@VARS=H1,H2,H3,H4,H5,H6,H7,H8,H9,H10,H11,H12,AA IND=ORDER,1,7TW10@FILE LOAD AA,CUR+1TW10@€TW30@üTW10@Huom. AA-muuttuja ilmoittaa sen heiton numeron, josta ensimm„inen0 0 -yhdistelm„ alkaa.TW50@.±Lasketaan tunnuslukuja muuttujalle AA:TW10@STAT AA,CUR+1 / VARS=AA  RESULTS=0TW10@€TW30@TW10@mean+1=TW10@€TW10@º on uskottavan l„hell„ aikasemmin laskettua odotusarvoa 6.TW30@.±Pelaajan NN kolikko:TW10@FILE MAKE AB,100,10000,H,1TW10@€TW10@.±Arvotaan 100*10000 heittoa eri kolikolla (eri siemenluvulla):TW10@TRANSFORM AB BY #UNIFORM(0,2) / RND=rand(1999)TW20@€TW10@.±Etsit„„n n„ist„ heittosarjoista ensimm„iset 0 1 -yhdistelm„t:TW10@VARSTAT AB,AB:2,FIRST,L / L=0,1TW20@€TW10@.±TW10@Tunnuslukuja:STAT AB,CUR+1 / VARS=AB  RESULTS=0TW10@€TW30@üTW10@mean+1=TW10@€TW10@º on t„ss„kin tapauksessa hyvin l„hell„ teoreettistaarvoa 4.TW40@.±Luodaan uusi tiedosto pelaajien tulosten vertailua varten:TW10@FILE CREATE AA_AB,8,4FIELDS:1 N 2 AA2 N 2 AB3 N 2 Erotus      AA-AB4 N 2 Kesto       Pelin kestoENDTW20@€TW10@TW10@.±Kopioidaan muuttuja AA tiedostosta AA tiedostoon AA_AB:TW10@FILE COPY AA TO AA_AB / VARS=AATW20@€TW10@.±Kopioidaan muuttuja AB tiedostosta AB tiedostoon AA_AB:TW10@FILE COPY AB TO AA_AB / VARS=AB MATCH=#TW20@€TW10@.±TW10@Lasketaan erotusmuuttuja:TW10@VAR Erotus=AA-AB TO AA_ABTW20@€TW10@.±ja taulukoidaan sen arvot etumerkin mukaan:TW10@VARIABLES=Erotus Erotus=-100,-1(MM),0(Tasapeli),100(NN)TW10@TAB AA_AB,CUR+1TW20@€TW10@üN„hd„„n, ett„ tulokset vastaavat hyvin teoreettisia frekvenssej„TW10@39/121*N=TW10@€TW10@17/121*N=TW10@€TW10@65/121*N=TW10@€TW10@TW30@.±TW10@Pelin kesto kussakin koesarjassa lasketaan yksinkertaisesti n„in:TW10@Kesto=MIN(AA,AB)TW10@VAR Kesto TO AA_ABTW10@€TW10@STAT AA_AB,CUR+1 / VARS=Kesto RESULTS=0TW20@€TW30@üTW10@eli mean+1=TW10@€TW10@º on riitt„v„n l„hell„ teoreettista arvoa384/121=TW10@€TW20@sill„ se poikkeaa v„hemm„n kuin keskivirheen verran:TW10@s=stddev/sqrt(N)TW10@(mean+1-384/121)/s=TW10@€TW10@µµµµµAA-AB-pelin k„sittely p„„ttyy!Tp        Lopeta painamalla ENTER-nappia! (Keskeytys napilla .)@TVC1200@_@@Tp@ü0T!1@C9@TLTNLS@Tÿ


{u}LOAD AA-AB{R}






 yht„l”ryhm„ kuvaksi!


























