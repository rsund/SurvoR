SURVO 84C SUCROS@   2@STEADY        63@DEMO2       1209@TÿTa1@b@!T!1@CSURVOMAR@;SUR-SAVETb0@0@&TgC1@C1@C!@C1@C1@INIT 100,100€TIA1@C(empty)@GA@@GA@TXH@/MARKOV-STEADY Pcomputes the steady-state probabilities of an irreducible Markov chain.The transition probabilities P must be given as (square) matrix fileP and the steady-state probabilities will be saved in a matrix file PI.MTp        Press ENTER!@TVC600@_@@Tp@TLGEnd1@üüüüTXA@MAT DIM =€TIA1@CMATerr@@GErr@@MAT &P==(1:row=-1,1:row=-1)MAT &P=&P'MAT &PV==(row=,1:row=-1)MAT &PVD=DV(&PV)MAT &ONE=CON(row=-1,row=-1)MAT &A=&PVD*&ONEMAT &A=&A-&PMAT &I=IDN(row=-1,row=-1)MAT &A=&A+&IMAT &PV=&PV'MAT SOLVE &PI FROM &A*&PI=&PVMAT &A=SUM(&PI)MAT TRANSFORM &A BY 1-X#MAT &R=ZER(row=,1)MAT &R(1,1)=&PIMAT &R(row=,1)=&AMAT RLABELS FROM = TO &RMAT &R(0,1)="Prob"MAT PI.M=&RMAT NAME PI.M AS "Steady-state_probabilities_of_Markov_chain_="MAT KILL &*€ü@!T!1@CSURVOMAR@;SUR-RESTORE0@&BüMAT LOAD PI.M / Steady-state probabilities of Markov chain =TLGEnd@TXErr@Tp        Matrix not found!@TVC600@_@@Tp@TXEnd1@@!T!1@CSURVOMAR@;SUR-RESTORETXEnd@Ta-1@Tÿ
 def WP=W1




Ta1@bTIA1@CRETURN@@GR@@T!1@CSURVOMR2@;SUR-SAVETb0@TgC1@C1@C!@C1@C1@SCRATCH€üSOFTKEYS *,DUMMY€üRESIZE€üINIT 2000,100€TgC1@C1@C!@C1@C1@üCD i1h=€ü   µµµµµ Working with Markov chains of higher order In this demonstration it will be shown how certain new featuresof SURVO MM can be used for Markov chains.For a long time it has been possible to generate Markov chainsin Survo according to Shannon's technique.There have been also special operations for computing steady-stateprobabilities and multistep transition probabilities as well asfor analyzing the structure (types of states) of Markov chains.All this can be done by various forms of MARKOV operation and certainspecial modes of TRANSFORM (See MARKOV? MARKOVD?).A new feature is the possibility of generating and analyzing Markovchains of higher order.In this demonstration one can see also how the Survo matrix interpreter(MAT commands) is employed for various tasks related to the main topic.üTp        Continue by pressing ENTER or by clicking the mouse!@TVC1200@_@@Tp@üWe shall study a three-state Markov chain of order 2 with thefollowing matrix P2 of transition probabilities:MATRIX P2///    A   B   CAA     0.6 0.2 0.2AB     0   0.9 0.1AC     0.2 0.2 0.6BA     0.6 0.2 0.2BB     0.2 0.6 0.2BC     0.2 0.2 0.6CA     0.3 0.3 0.4CB     0.1 0   0.9CC     0   0.2 0.8Ta-1@TW70@MAT SAVE P2 / saving the matrixTW10@€TW10@Thus the states are A,B,C and, for example, MAT_P2(AB,C)=TW10@€TW20@i.e. probability of state C after the two preceding states A,B is 0.1 .üTp        Continue by pressing ENTER or by clicking the mouse!@TVC1200@_@@Tp@.±üTW10@A sample of this chain P2 of order 2 is easily produced bythe following MARKOV command:TW20@MARKOV CUR+1,CUR+18 BY P2TW20@€TW50@üTp        Labelling the first and last line of the sample...@üTW20@TW10@xTW10@TW10@yTW10@TW50@Tp@üTp        Continue by pressing ENTER or by clicking the mouse!@TVC1200@_@@Tp@.±üTW10@Given this sample (on lines from x to y above) the transitionprobabilities can be estimated and saved in a Survo matrix file P2_ESTby another form of MARKOV command:TW30@ORDER=2                        / order of the chain to be estimatedTW10@STATES=ABC                     / list of statesTW20@MARKOV x,y / MATRIX=P2_ESTTW20@€TW20@MAT LOAD P2_ESTTW10@€TW20@MATRIX P2_ESTüTp        Continue by pressing ENTER or by clicking the mouse!@TVC1200@_@@Tp@TW10@Let's compare the original and estimated probabilities:TW10@MAT E=P2-P2_ESTTW10@€TW10@MAT LOAD ETW10@€TW30@TW10@All differencences seem to be reasonable small as expected.Tp        Continue by pressing ENTER or by clicking the mouse!@TVC1200@_@@Tp@.±üTa1@   µµµµµ Steady-state probabilities for states in chain P2 These probabilities will first be computed by simulation.For this purpose, a data file TEST with a single variable X (of type S2)and 100000 observations is created:Ta-1@TW70@FILE MAKE TEST,1,100000,X,S2TW20@€TW10@The state of the chain when started from first state (A) after 100steps is counted 100000 times by the following TRANSFORM command.TW20@The variable X will tell the final state of each simulation.TW20@TRANSFORM TEST BY #MARKOV(P2,X,100)  / START=1TW20@€TW20@The empirical frequency distribution of states after 100 stepsshould approximate steady-state probabilities of the chain P2.TW30@This distribution is computed byTW10@STAT TEST,CUR+1TW10@€TW20@Ta1@ü¹¹¹¹üTa-1@Tp        Continue by pressing ENTER or by clicking the mouse!@TVC1200@_@@Tp@.±TW10@Ta1@üFor more exact, direct computation of steady-state probabilities,the chain of order 2 is represented as a chain of order 1 with9 states AA, AB, AC, BA, BB, BC, CA, CB, CC.The 9x3-matrix P2 of must then be transformed accordingly to a 9x9-matrix P99 which is computed by the following series of MAT commands:- Tell me (Seppo.Mustonen@survo.fi) if you can do this in a simpler way!MAT I3=IDN(3,3)MAT I1=CON(1,3)MAT I9=KRONECKER(I3,I1)MAT X=KRONECKER(I1,I9')'MAT P99=KRONECKER(I1,P2)MAT TRANSFORM P99 BY X AND X#*Y#MAT RLABELS FROM P2 TO P99MAT CLABELS FROM P2' TO P99Ta-1@Tp        Continue by pressing ENTER or by clicking the mouse!@TVC1200@_@@Tp@üTW20@€üTW10@Transition probabilities in this modified chain of order 1 are now:TW20@MAT LOAD P99,1.1,CUR+1TW10@€TW20@üTa1@µµµµµ                                                                                                   Ta-1@üTW10@The highlighted parts of P99 show how the rows of P2 are located inthis sparse matrix of transition probabilities.TW50@The chain P99 is irreducible and its steady-state probabilities areobtained by the commandTW20@/MARKOV-STEADY P99TW10@€TW20@üTW10@€LR1The corresponding frequencies obtained by simulation wereü¹¹¹¹TW20@TW10@Frequency by simulationTW20@TW10@TW10@Thus the frequencies obtained by simulation correspond nicely tothe theoretical steady-state probabilities.üTp        Continue by pressing ENTER or by clicking the mouse!@TVC1200@_@@Tp@	From PI.M it is possible to compute steady-state probabilities alsofor original states A,B,C as sums - even in two ways.TW20@For example, the probability for C is computed in µµµµµtouch modeµµµ:TW30@Lr1üTa-2@´+TW10@+TW10@+TW10@TW10@=TW20@Ta2@= sum of rows CA,CB,CCTW20@Ta-2@´+TW10@+TW10@+TW10@=TW20@Ta2@= sum of rows AC,BC,CCTW20@TW10@The steady-state probabilities are computed for all states A,B,Csimultaneusly by following matrix operations:TW20@MAT X!=VEC(PI.M,3)' / Convert vector PI.M to a 3x3-matrix XTW20@€TW10@MAT CLABELS FROM P2 TO X  / Setting proper labelsTW10@€MAT RLABELS FROM P2' TO XTW10@€MAT LOAD XTW10@€TW30@º  For example, X(A,C)=PI.M(AC,1)TW30@Then the sums of columnsTW10@MAT COLSUMS=SUM(X)TW10@€TW10@MAT LOAD COLSUMSTW10@€TW30@as well as the sums of rowsTW20@MAT ROWSUMS=SUM(X')TW10@€TW10@MAT LOAD ROWSUMSTW10@€TW30@tell the steady-state probabilities of A,B, and C.TW30@TW10@Finally, let's check how accurately frequencies of A,B,C in the samplepresented earlier on lines from x to y match these probabilities:TW20@SAVEP x,y,CHAIN.TXT           / Saving lines in a text file CHAIN.TXTTW20@€TW10@FILE MAKE STATES,1,0,S,S1     / Creating an empty data file STATESTW20@€TW10@The text in CHAIN.TXT is converted letter by letter in variable Sof data file STATES:TW20@FILE SAVE CHAIN.TXT TO STATES / FORMAT=CHAR,S (special CHAR format)TW20@€TW10@STAT STATES,CUR+1             / statistical summary of states in sampleTW20@€TW20@Thus there is a good correspondence!TW30@Ta1@SOFTKEYS€   µµµµµ End of the demonstration You may study the material covered in this demonstration by pressingthe '.' key.All the text, data, matrices, commands and their results are stillavailable in this edit field for your own work.For example, you may browse data files by commmandsFILE SHOW TESTFILE SHOW STATESand repeat or make more computations with them.After that you still can exit to your earlier work by activating/MARKOV-DEMO2 RETURNüTa-1@Tp        Exit by pressing ENTER or interrupt by '.'@TVC1200@_.@@GE@Tp@üTa1@TXR@FILE DEL TEST€FILE DEL STATES€üT!1@CSURVOMR2@;SUR-RESTORETXE@Tp@Ta-1@Tÿ



















 Painting original rows:








