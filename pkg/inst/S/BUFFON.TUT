üüüüüüTa1@bTIA1@CEXIT@@GR@@TIA1@C?@@GH@@TIA1@C(empty)@GS@@GS@üTXH@T!1@CSURVORME@;SUR-SAVEüüTgC1@C1@C!@C1@C1@INIT 120,80€Sucro /BUFFON simulates Buffons's needle experiment.It creates a file of results and plots them with appropriatestatistics.Usage:                                                        WORK=SAVED/BUFFON <name_of_file>,s,N,Pwhere     s = needle length,     N = number of tosses,     P = confidence level, e.g. 0.95By pressing '.' you may stop and start using /BUFFON.Tp        To return to the earlier work, press ENTER!@TVC600@_.@@GEnd@Tp@üTXR@T!1@CSURVORME@;SUR-RESTORETLGEnd@üüüüTXS@i9TKC~WORK@i6L1i7L2i8L5i7L6T=7@8@-@6@TIN7@C95@@@GS3@Tp        /BUFFON cannot continue. At least 95 edit lines needed!@Ta-1@TW60@Ta1@TLGEnd@TXS3@TIA4@C@GS2@@GS2@TXS1@Tp        Usage: /BUFFON <file>,<needle_length>,N,<conf.level>@Ta-1@TW600@Ta1@TLGEnd@TXS2@TIN2@C0@@@GS4@Tp        Needle length not positive!@Ta-1@TW600@Ta1@TLGEnd@TXS4@T=5@2@/@C2@BSCRATCH€üµCreating a Survo data file for results:FILE CREATE =,45,10,64,7,@3FIELDS: 1 N 8 N 2 N 4 X 3 N 4 Y 4 N 4 A 5 N 4 X1 6 N 4 Y1 7 N 4 X2 8 N 4 Y2 9 N 1 I10 N 8 FEND€üµGenerating data:N=ORDERn=10 X=-0.5+(n+1)*rnd(0)              X,Y are coordinates of     Y=-0.5+(n+1)*rnd(0)              the center of the needle.A=pi*rnd(0) pi=3.141592653589793      Direction of the needleR=@5 Needle length/2X1=X+R*cos(A) Y1=Y+R*sin(A)           End point 1X2=X+R*cos(A+pi) Y2=Y+R*sin(A+pi)     End point 2I=if(int(Y1)=int(Y2))then(0)else(1)   Intersection indicatorF=if(ORDER=1)then(I)else(F[-1]+I)     Cumulative frequencyVAR N,X,Y,A,X1,Y1,X2,Y2,I,F TO =€.±üµMaking the background graph:HEADER=Buffon's_needle_problem___(SURVO_84C_sucro_/BUFFON_by_S.Mustonen_1992)BGPLOT /FRAME   / OUTFILE=BUFFON WAIT=0SIZE=479,479  FRAME=0TEXTS=T1  MODE=VGA PALETTE=NULT1=#LINES:a,b,380,430,15aA needle of length s is tossedrandomly on the XY plane. Theprobability that the needleintersects any of the parallellines y=k,k=...-2,-1,0,1,2,...is 2s/pi when s<=1 and1-2s/pi*(arcsin(1/s)/s          +sqrt(1-1/s^2)-1)when s>1. Above pi=3.14159...These results make possible toattain rough estimates for pi.When the needle intersects lines,it is colored red; otherwise itis green.Below, N is number of tosses,P is proportion of intersections,"pi" is current estimate andl.limit, u.limit are confidencelimits.Needle length s=@2Confidence level=@4   N   P   "pi" l.limitb u.limit€.±üµMaking the final graph:HEADER=Buffon's_needle_problemGPLOT X(t)=X1+(X2-X1)*t,Y(t)=Y1+(Y2-Y1)*tt=0,1,1   R=@5  INFILE=BUFFON OUTFILE=BUFFON WAIT=60X1=DATA:=,X1 Y1=DATA:=,Y1X2=DATA:=,X2 Y2=DATA:=,Y2MESSAGES=M1,M2,M3,M4,M5M1=N,100,450,70       N=DATA:=,NM2=P,100,450,55       P=F/N F=DATA:=,FM3=fpi(P),100,450,40 V=if(R<0.5)then(1)else(-1)fpi(P):=if(R<0.5)then(4*R/P)else(fpi2(P))fpi2(P):=4*R/(1-P)*(arcsin(1/2/R)/2/R+sqrt(1-1/4/R/R)-1)PT=                    PT=N.G(0,1,1-(1-@4)/2)PT=€T=PT*sqrt(P*(1-P)/N)M4=fpi(P+V*T),100,450,25 M5=fpi(P-V*T),100,450,10 (confidence limits)SCALE=-1(1)11  SIZE=479,479  FRAME=0  XDIV=0,8,2 YDIV=1,8,1GRID=YI=DATA:=,ICOLOR_CHANGE=if(I=0)then(3)else(2)PALETTE=NUL MODE=VGA€.±üSucro /BUFFON for Buffon's needle problem has come to its end.You may study the setup above and make your own modifications.To see the final graph again, activate the next line:GPLOT FILE BUFFON / MODE=VGA PALETTE=NULTIA9@CSAVED@GEnd@@GEnd@/BUFFON EXIT   / Return to the earlier work!TXEnd@Tp@Ta-1@Tÿ /BUFFON <file>,<needle_length>,N,<confidence_level> (1.7.92/SM)
 generates N observations from Buffon's needle experiment in <file>.
 <needle_length> is a constant in (0,1).
 After the file with the results has been generated,
 the results (needles) are plotted with appropriate statistics.

 Saving the current setup:

  General description (when started without parameters):
 Restoring the original setup:

 def Wfile=W1 Wneedle=W2 WN=W3 WP=W4
 def WR=W5 Wr=W6 Wc=W7 Wend=W8 Wsaved=W9






