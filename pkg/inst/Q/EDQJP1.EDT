SURVO84ED 81 80     81 S10                                                       *SAVE EDQJP1 / Juha Puranen                                                      *LOAD EDQ                                                                        *                                                                                *LOWESS?                                                                         @LOWESS <data>,<smooth_level>,<output_matrix>            / J.Puranen 1991,1998   *smooths a variable activated by `Y' according to the values of another          *variable activated by `X' using a robust locally weighted regression            *method (LOWESS = LOcally WEighted Scatterplot Smooth).                          *    The smoothened values are saved into a variable activated by `S'. If        *no `S' variable exists, the smoothened values (as well as the values of `X'     *and `Y' variables) are saved into a matrix file given by <output_matrix>.       *The default name of the matrix is SMOOTH.M . The results are saved in           *increasing order of the `X' values. The smoothened scatterplot can be           *plotted by using this matrix file as an input (see the example below).          *    The <smooth_level> gives the level of smoothing, specified as how           *many percents of the observations around each point affects the smoothing.      *A suitable value is 60, which is also the default.                              *    <data> must be sorted by `X' variable before smoothing, if `S' mask         *is applied.                                                                     *@C                                                                              *    The number of iterations can be given by ITERATIONS=1 or 2. The default     *value of 2 should be adequate for almost all situations.                        *    In addition, the deviances from the smoothened values can be saved          *into a variable activated by `E'. If there are any missing values in <data>,    *the `S' and `E' variables must also be initialized with missing values.         *    The IND and CASES specifications can be used to select observations.        *                                                                                *Reference: Cleveland, W. (1979). Robust Locally Weighted Regression             *           and Smoothing Scatterplots. JASA 74, 829-836.                        *                                                                                *See also SMOOTH?                                                                *                                                 (Example on the next page)     *@C                                                                              *........................................................................        *Example:                                                                        *LOWESS <data>,60,SMOOTH.M / VARS=<xvar>(X),<yvar>(Y)                            *....................................................                            *GPLOT SMOOTH.M,X,Y,S / YLINE=0 SLINE=1                                          *........................................................................        *@END                                                                            *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                END                                                                              