SURVO84ED 81 200    81 S20                                                       *SAVE EDQV1                                                                      *LOAD EDQ                                                                        *                                                                                *VAR?                                                                            *Transformation of variables in Survo data sets:                                 *                                                                                *VAR operation:                                                                  *  1 = Simple transformations (type 1)                                           *  2 = Composite transformations (type 2)                                        *  3 = Lags and leads in transformations                                         *  4 = Generating random variates                                                *  5 = Special transformations (#RANK,#NORMAL,#STD,etc.)                         S  6 = Using additional data sets (or matrices) in the VAR operation             *  7 = Transformation of string variables                                        *Other operations:                                                               *  V = VARSTAT operation                                                        C*  T = Same transformation for many variables simultaneously (TRANSFORM)         *  C = Classified variables (CLASSIFY)                                           *  L = Linear combinations of variables (LINCO)                                  *  S = Smoothing of data (SMOOTH)                                                *  M = Moving averages, cumulative sums, etc. (SER)                              *  P = Products of powers (POWERS)                                              C*  F = Code conversions of string fields in data files (FILE CONVERT)            *  D = More information on data management                                       *                                                                                %1=VAR1 2=VAR2 3=LAG1? 4=CHANCE? 5=VARR? 6=VARD 7=VARSTR? V=VARSTAT?             %T=TRANSFORM? C=CLASSIFY? L=LINCO? S=SMOOTH? M=SER? P=POWERS?                    %F=FCONVERT? D=FILE?                                                             *@SELECT                                                                         *                                                                                *VAR1?                                                                           @VAR <variable>=<expression> TO <data in data file>                              *is an operation setting values for a numeric <variable> in <data file>          *as a function of other variables according to <expression>.                     *<variable> may be defined earlier (by FILE CREATE or FILE UPDATE) or it         *may be a new one. In case of a new variable, its type may be given in the       *form <variable>:<type>=<expression> where <type> is 1,2,4 or 8.                 *<variable>:4 is default.                                                        *Also <variable>:S<len>=<expression> is permitted for new string variables.      *<expression> may be any function of variables in <data> and written             *according to the rules of editorial computing (see ARIT?).                      *Examples:                                                                       *VAR Sum=Test1+2*Test2 TO DATA1                                                  *VAR Lincome=log(Income) TO ECON                                                 *VAR Number:2=ORDER TO FILE_A   / 'Number' will be a two-byte variable           *In the last example ORDER is a predefined variable whose value is the           *number (1,2,...) of the current observation. Likewise predefined                *variables N=number of observations, MISSING (missing value) and                 *RND=random value in (0,1) can be used in <expression>.                          *                                                                                *  V = More information on VAR operation                                         %V=VAR                                                                           *@SELECT                                                                         *                                                                                *VAR2?                                                                           @VAR <list of variables> TO <data>                                               *with transformation statements written in the same edit field and               *defining values for the variables in the list specifies                         *simultaneously several transformations and definitions of variables             *as functions of other ones.                                                     *If a variable in the <list of variables> does not exist, it will be             *automatically created provided that there is enough space in <data>.            *                                                                                *Example:  (Data RECTANGLS includes variables 'Width' and 'Height')              *VAR Area,Diagonal TO RECTANGLS                                                  *Area=Width*Height                                                               *Diagonal=sqrt(Width^2+Height^2)                                                 *@C                                                                              *Conditional statements may appear as follows:                                   *                                                                                *VAR Ageclass:1 TO SAMPLE_3 / 'Ageclass' will be a new one-byte variable         *    Ageclass=if(Age<26)then(1)else(A2)                                          *          A2=if(Age<=60)then(2)else(3)                                          *                                                                                *To avoid confusions, it is advisable to protect all those variables             *whose values must not be altered.                                               *                                                                                *  V = More information on VAR operation                                         %V=VAR                                                                           *@SELECT                                                                         *                                                                                *VARD?                                                                           *Fields from other Survo data sets can be used as input information              *in VAR transformations. Other data sets to be employed in VAR must be           *given as a specification                                                        *   INDATA=<data_1>,<data_2>,...                                                 *where <data_1>,<data_2>,... are Survo data sets of any type. Number of          *them is limited to 12.                                                          *                                                                                *A field in <data_i> is denoted by Di:<fieldname>, i=1,2,...                     *Also lags and leads can be indicated in brackets [].                            *Example:                                                                        *VAR Change=Price-D1:Price TO DAT87  / INDATA=DAT86                              *computes 'Change' to data DAT87 as a difference of 'Price' in DAT87             *and DAT86.                                                                      *                                                                                *  M = Matrix files in VAR operation                                            C*  V = More information on VAR operation                                         %M=VARMAT V=VAR                                                                  *@SELECT                                                                         *                                                                                *VARMAT?                                                                         *Matrix files in VAR operation                                                   *                                                                                *Either constants or data values saved as vectors or matrices in                 *matrix files (with extension .MAT) can be referred to in the VAR                *operation. This is done by MAT_A(i,j) functions giving the value                *of the element on the i'th row and j'th column of a matrix A                    *saved as A.MAT before the VAR operation is activated.                           *Name `A' can be replaced by any other of max. 8 characters.                     *In one VAR operation 20 different matrices can be used simultaneously           *in this way. Each matrix is loaded in the memory when it is called              *for the first time by any of the MAT_ functions.                                *If the matrix consists of one column or row, a MAT_ function can                *be written with only one argument as MAT_A(i).                                  >HELP-VARMAT /                                              See |EXAMPLE|       C*@C                                                                              *Example 1: Sampling with replacement                                            *Assume that we have a `population' of 10000 observations                        *described by 3 variables X1,X2,X3 in a Survo data file DATA3                    *and we want to have a sample with replacement of 500 observations               *as a new data file SAMPLE3.                                                     *                                                                                *MAT SAVE DATA DATA3 TO D3  / Saving data to a matrix file D3                    *................................................................................*FILE CREATE SAMPLE3,12,3    / Creating a new file for the sample                *FIELDS:                                                                         *1 N 4 X1                                                                        *2 N 4 X2                                                                        *3 N 4 X3                                                                        *END                                                                             *FILE INIT SAMPLE3,500       / 500 missing observations                          *................................................................................*VAR X1,X2,X3 TO SAMPLE3    / Making the sample                                  *i=int(10000*rand(1998))+1  / Random integer 1,2,...,10000                       *X1=MAT_D3(i,1) X2=MAT_D3(i,2) X3=MAT_D3(i,3)                                    *                                                                                *Another example on the next pages!                                              *@C                                                                              *Example 2:                                                                      *Variable S is defined as a function of x as a sum                               *  S=a1*exp(-b1*x)+a2*exp(-b2*x)+...+a20*exp(-b20*x)                             *where a's and b's are constants and x a variable in a Survo data D.             *Assume that constants a1,...,a20 are saved in a matrix file A and               *constants b1,...,b20 in matrix file B.                                          *................................................................................*Then S will be computed by                                                      *VAR S=for(i=1)to(20)sum(a(i)*exp(-b(i)*x)) TO D                                 *a(i):=MAT_A(i)                                                                  *b(i):=MAT_B(i) .                                                                *Definition of temporary functions a() and b() enables writing the formula       *in a more readable form.                                                        *Numerical example on the next page!                                             *................................................................................*An alternative:                                                                 *If a's and b's are the two (first) coulumns in a matrix C,                      *the temporary functions a() and b() would be expressed as                       *a(i):=MAT_C(i,1) b(i):=MAT_C(i,2) .                                             *................................................................................*@C                                                                               Numerical example (with coefficients selected at random):                       *MAT A=ZER(20,1)                                                                 *MAT B=ZER(20,1)                                                                 *MAT #TRANSFORM A BY 10*rand(1998)   / a's uniform in (0,10)                     *MAT #TRANSFORM B BY rand(1999)      / b's uniform  in (0,1)                     *a(i):=MAT_A(i) b(i):=MAT_B(i)                                                   *VAR S=for(i=1)to(20)sum(a(i)*exp(-b(i)*x)) TO D                                 *                                                                                *DATA D,A,A+5,A-1,A-2                                                            * 11  11.11111                                                                   *  x     S                                                                       A  1  46.76749                                                                   *  2  29.58383                                                                   *  3  20.09316                                                                   *  4  14.53685                                                                   *  5  11.09308                                                                   *  6   8.84248                                                                   *                                                                                   V = More information on VAR operation                                         %V=VAR                                                                           *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                Shadows                                                                                                             8888888888888                                END                                                                              