SURVO84ED 101 100   101 S20                                                                          *SAVE EDQT3                                                                                          *LOAD EDQ                                                                                            *                                                                                                    *FORECAST?                                                                                           @FORECAST <data>,<series>,<predictor>,L                                                              *makes an automatic forecast of a time series by using a variant                                     *of the Holt-Winters' seasonal forecast procedure.                                                   *(See for example, B.Abraham and J.Ledolter (1983). Statistical Methods                              *for Forecasting, Wiley.)                                                                            *                                                                                                    *The period s of the series is given by PERIOD=s.                                                    *If the PERIOD specification is omitted, FORECAST tries to judge s                                   *from the data.                                                                                      *The active part of the observations in <data> is used for the                                       *estimation of the level, slope and seasonal components. The predicted                               *values of <series> are saved in <predictor> for the estimation period                               *plus one complete period (s observations) ahead. Number of forecast                                 *values may be changed by the AHEAD=<#_of_values> specification.                                     *A '-' as <predictor> rejects saving of forecast values.                                             *L (optional) is the first edit line for the results.                                                *@C                                                                                                  *The type of the model is selected by the specification C=<type>.                                    *Default is C=1 (additive seasonal). Another alternative is C=0                                      *(multiplicative seasonal). In case s=1 both models correspond to                                    *Holt's double exponential smoothing procedure.                                                      *Also values 0<C<1 may be tested, but then the time required for                                     *the estimation is much longer.                                                                      *                                                                                                    *The three smoothing coefficients are selected by minimizing the                                     *mean square error of the one-step-ahead forecast errors. The initial                                *values of the level, slope and seasonal parameters are obtained                                     *first by backforecasting on the data.                                                               *However, fixed values for the smoothing coefficients can also given                                 *by a specification of the form PAR=a1,a2,a3 where                                                   *a1=level coefficient, a2=seasonal coefficient and a3=slope coefficient.                             *Each of them must be in the interval (0,1). For stable components                                   *the smoothing coefficients should be close to zero.                                                 *@C                                                                                                  *After estimation of the smoothing coefficients the outliers in data                                 *may be rejected on the basis of the forecast errors. Only one (the                                  *worst) outlier is rejected at a time by replacing the data value                                    *by the current forecast and the whole estimation process is repeated.                               *The OUTLIERS=n,k specification gives n as the maximum number of                                     *such rejections and k as the treshold for an outlier. An observation                                *is rejected (smoothed), if its forecast error exceeds k times the                                   *standard error. Default is OUTLIERS=3,2.5. By OUTLIERS=0 no outliers                                *are considered.                                                                                     *@C                                                                                                  *In addition to the forecast also the components of the series may be                                *saved in the original data (file) by entering certain masks.                                        *The components and their mask symbols are:                                                          *   Trend (level)    T                                                                               *   Slope            B                                                                               *   Seasonal         S                                                                               *                                                                                                    *@C                                                                                                  *Example:                                                                                            *....................................................................................................* 40 *DATA X: 1 2 5 4 2 3 4 5 3 4 5 6 4 5 6 7 5 6 5 10 6 7 8 9 END                                   * 41 *                                                                                               * 42 *FORECAST X,X,-,43  / No specifications are given in this case                                  * 43 *Holt-Winters' Additive Seasonal Forecast: Data X, Variable X                                   * 44 *Period=4 obs. (judged from data)  Estimation on observations 1-24                              * 45 *Outliers:19,20,3 (+more to be found)                                                           * 46 *MSE=0.025814 a(level)=-0.000 a(seasonal)=0.552 a(slope)=0.856                                  * 47 *Autocorrelations of residuals: r1=+0.00 r2=-0.04 r3=-0.05 r4=+0.04                             * 48 *Obs.#   Forecast                                                                               * 49 *  25     6.9678                                                                                * 50 *  26     7.9678                                                                                * 51 *  27     9.0452                                                                                * 52 *  28     9.9920                                                                                * 53 *                                                                                               *....................................................................................................*  T = More information on time series analysis                                                      %T=TIMESER?                                                                                          *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *        trend=activated(&d,'T');                                                                    *        beta=activated(&d,'B');                                                                     *        seas=activated(&d,'S');                                                                     *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    END                                                                                                  