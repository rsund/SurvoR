SURVO84ED 81 150    81 S20                                                       *SAVE EDQU3                                                                      *LOAD EDQ                                                                        *GENREG?                                                                         @GENREG <data>,L                                                                 *estimates a generalized linear model (GLM) defined by ERROR and LINK speci-     *fications from a Survo data where the dependent variate is acti-                *vated by Y and the covariates by X's. IND and CASES specifications              *are used for selection of observations.                                         *The theory of GLM's is described in 'Generalized Linear Models' by              *P.McCullagh and J.A.Nelder (Chapman and Hill 1983).                             *                                                                                *Variables for the model and for results are selected by masks as follows:       *     Y  dependent variate (only one Y allowed)                                  *     X  covariate (also the constant term must be specified by X)               *     R  for output of scaled Pearson residuals (optional)                       *     P  for predicted values of Y (optional)                                    *     N  number of trials in ERROR=Binomial (Y is number of successes)           *                                                                                *  E = ERROR specification                                                      C*  L = LINK specification                                                        *  P = Printout of results                                                       *  T = Using TABFIT as a preparatory operation for GENREG                        *  S = General information on statistical operations                             %E=ERROR L=LINK P=PRINTOUT T=TABM S=STATIS?                                      *@SELECT                                                                         *                                                                                *ERROR?                                                                          *Possible error structures in GENREG are                                         *   ERROR=Normal      (LINK=Identity)                                            *   ERROR=Poisson     (LINK=Log)                                                 *   ERROR=Binomial    (LINK=Logit)                                               *   ERROR=Gamma       (LINK=Reciprocal)                                          *The default (canonical) links are in parentheses.                               *                                                                                *   L = LINK specification                                                       *   R = Logistic regression                                                     C*   G = More information on GENREG                                               %L=LINK R=LOGIST G=GENREG                                                        *@SELECT                                                                         *                                                                                *LINK?                                                                           *The link function is given by any of the following alternatives:                *   LINK=Identity              (default in ERROR=Normal)                         *   LINK=Log                   (default in ERROR=Poisson)                        *   LINK=Logit                 (default in ERROR=Binomial)                       *   LINK=Reciprocal            (default in ERROR=Gamma)                          *   LINK=Probit                (N variable must be given)                        *   LINK=Complementary_log-log (N variable must be given)                        *   LINK=Square_root                                                             *   LINK=Exponent,alpha        (x^alpha power transformation)                    *                                                                                *   E = ERROR specification                                                      *   G = More information on GENREG                                               %E=ERROR G=GENREG                                                                *@SELECT                                                                         *                                                                                *TABM?                                                                           *The TABFIT operation generates, as a by-product, the design matrix              *extended by the dependent variate and the external weight function              *according to the current model. This matrix is saved (even in saturated         *cases) as a matrix file XTAB.M .                                                *The matrix file XTAB.M as such (or more conveniently, its transform to a        *data file by FILE SAVE MAT operation) can be used as an input data set          *for GENREG. Data for various models including factors and their inter-          *actions can be organized easily by this procedure.                              *                                                                                *   T = TABFIT operation                                                         *   G = More information on GENREG                                               %T=TABFIT? G=GENREG                                                              *@SELECT                                                                         *                                                                                *PRINTOUT?                                                                       *The extent of results given by GENREG is controlled by the RESULTS              *specification.                                                                  *If RESULTS=0, only minimal information (i.e. deviance, degrees of freedom,      *the error structure, and the link) is printed.                                  *Otherwise also the estimates of the parameters and their standard errors        *are given.                                                                      *                                                                                *In any case, the covariance estimates of parameters are saved as a matrix       *file PCOV.M on the current data disk.                                           *Similarly, the estimates of the parameters are saved in GENREG.M .             C*                                                                                *   G = More information on GENREG                                               %G=GENREG                                                                        *@SELECT                                                                         *                                                                                *LOGIST?                                                                         *To run logistic regression (with a binary dependent variable Y) define a        *constant variable, say I, (with all values =1) with mask `N' and                *activate                                                                        *GENREG <data>,L / ERROR=Binomial .                                              *To have a constant term included, define another constant variable,             *say C=1 with mask `X' as other independent variables.                           *                                                                                *The most convenient way of applying GENREG in logistic regression is           C*provided by the /LOGREG sucro (made by Kimmo Vehkalahti).                      C*                                                                                *   G = More information on GENREG                                               *   L = /LOGREG                                                                 C%G=GENREG L=/LOGREG?                                                             *@SELECT                                                                         *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                END                                                                              