übTa1@T!1@CSURCIRC@;SUR-SAVETb0@üTgC1@C1@C!@C1@C1@SCRATCH €B                                                            µµ*GLOBAL*   µµµµµµµ Estimation of a circle µüGPLOT /FIX 1€B                                                     µµWHOME=WX-WY/2,WY/2                                                     µµWSIZE=WY/2,WY/2                                                     µµMODE=800,600üTtC2@TW10@In this example we generate a sample of points (x,y)located roughly on the circumference of the circle   (x-X0)^2+(y-Y0)^2=R^2or   x=X0+R*cos(T), y=Y0+R*sin(T).TW10@The sample will also include one outlier and we shall investigatethe influence of this outlier in parameter estimation.TW10@   µµµµµµµ Generating the sample TW5@We assume that X=X0+R*cos(T)+eps1TW5@ and Y=Y0+R*sin(T)+eps2TW5@ wherethe radius is R=3 and the coordinates of the center are X0=5 and Y0=7.TW10@The error terms are eps1=0.2*probit(rnd(0)) and eps2=0.2*probit(rnd(0))TW10@i.e. they both are from N(0,0.2^2) distribution.TW30@To scatter the points randomly around the center we assume thatT has a uniform distribution, i.e. T=2*pi*rnd(0) where pi=3.14159265.TW10@Before generating sample values according to these specificationsTW5@we create a data file CIRCLE for 40 observations:TW10@FILE CREATE CIRCLE,8,2,64,7,40TW5@FIELDS:1 N 4 X2 N 4 YENDTW5@TW10@€TW5@Now 40 observations (X,Y) will be produced by the VAR operation:TW5@VAR X,Y TO CIRCLETW10@€TW5@The sample is plotted byGPLOT CIRCLE,X,Y  / SCALE=0(2)12                    HEADER=[Arialb(20)],Points_on_a_circleTW5@TW10@€TW10@The last observation will be replaced by an outlier X=10, Y=11:TW10@üüüüüüFILE SHOW CIRCLETW10@TtC5@TD1@€´10	11²TD0@TtC2@üTW10@and the sample is plotted again:TW5@  OUTFILE=A (save picture in file A.EMF)TW10@TW10@€TW10@.±µµµµµµµ OLS estimation of the circle TW10@We now `forget' the true values of parameters R,X0,Y0 and try toestimate them from the sample generated above.TW10@Estimation will be started from poor initial values R=2  X0=7 and Y0=3.TW10@The corresponding circle is plotted byGPLOT X(T)=X0+R*cos(T), Y(T)=Y0+R*sin(T)  / T=0,2*pi,pi/20 INFILE=AOUTFILE=ATW10@TW10@€TW10@The model to be estimated is defined byTW5@MODEL Cmodelsqrt((X-X0)^2+(Y-Y0)^2)=RTW15@To estimate parameters of this model from the data set CIRCLETW5@we activate the following ESTIMATE operation:TW10@ESTIMATE CIRCLE,Cmodel,CUR+2TW10@€TW10@TW50@.±The estimated circle is plotted byTW5@GPLOT X(T)=X0+R*cos(T), Y(T)=Y0+R*sin(T)T=0,2*pi,pi/20 INFILE=A OUTFILE=ATW5@TW10@€TW10@The estimates may be slightly biased due to the drift caused bythe outlier.TW10@To improve the estimates, a more robust estimation criterion MAD,Minimum Absolute Deviation or L1, instead of OLS (L2)can be applied. The previous OLS estimates are used as initial values.TW10@CRITERION=L1  (in fact any Lp norm is accepted)TW10@ESTIMATE CIRCLE,Cmodel,CUR+2TW10@€TW50@.±The corresponding (red) circle is:TW5@GPLOT X(T)=X0+R*cos(T), Y(T)=Y0+R*sin(T)      T=[RED],0,2*pi,pi/20 INFILE=ATW10@TW10@€TW10@Returning to earlier work in 30 seconds!TW300@T!1@CSURCIRC@;SUR-RESTORETÿRS: To avoid MIPSEL-BE ECOFF executable conflict in R CMD check




 FILE EDIT CIRCLE{wait 10}{tempo 5}{keys 1}{act}{search}40{R}
 {erase}10{R}
 {erase}11{R}
 {exit}{keys 0}{tempo 2}{R}


