SURVO 84C SUCROS@   8@TAULU1       171@TAULU2      1273@TAULU3      2500@TAULU4      5698@TAULU5      9243@TAULU6     12079@TAULU7     14347@TAULU8     15874@TÿTa1@SCRATCH €   µµµµ Taulukot 1: Yleist„    Tekstin ohella luvut ja niist„ muodostetut taulukot ovat keskeist„materiaalia tietoa k„sitelt„ess„. Survo tuntee useita erilaisiataulukkojen esityksi„ ja hallintatapoja.   T„ss„ jaksossa keskityt„„n pelk„st„„n toimituskent„ss„ olevientaulukkojen k„sittelyyn.   Taulukolla tarkoitetaan yhdest„ tai useammasta lukujen (tai sanojen)muodostamasta sarakkeesta koostuvaa esityst„. Survossa t„llaistataulukkoa muokataan useilla tavoilla. Tekstink„sittelyn keinojenlis„ksi taulukkoa voi muuntaa esim. sarakkeittain Survon erilaisillakomennoilla.   Taulukkoon voi laskea my”s uusia sarakkeita. Monipuolisimmin t„m„tapahtuu kosketuslaskennalla ja VAR-komennolla. N„it„ keinojaesitell„„n vasta my”hemmin matemaattisten toimintojen yhteydess„.   Jos taulukko sis„lt„„ tilastollista aineistoa, siihen voidaankohdistaa erilaisia Survon tilastollisia toimintoja.   N„yt„mme seuraavissa sukroissa er„it„ tyypillisi„ taulukkojenk„sittelytapoja.Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@GA@TXA@Tp@Ta-1@0T!1@C2@TLTAULUS@TÿTa1@SCRATCH €   µµµµ Mist„ taulukot tulevat?    J„rjestelm„llisesti ker„tyt numeeriset tiedot esitet„„n Survossayleens„ taulukkoina. Suurimmat taulukot ovat tietokantoja, jotka talle-tetaan levylle datatiedostoiksi.   Survo pystyy tallettamaan ja hallitsemaan hyvinkin laajoja tieto-kantoja. T„ss„ opetusjaksossa ty”skennell„„n p„„asiassa toimitus-kent„ss„ olevilla aineistoilla.   Taulukot syntyv„t joko kirjoittamalla ne suoraan toimituskentt„„ntai poimimalla niit„ valmiina eri l„hteist„. T„llaisia l„hteit„ ovat(vaikkapa muilla ohjelmilla synnytetyt) tekstitiedostot sek„ Survonomat datatiedostot ja matriisitiedostot. Usein tiedon alkuper„inen olo-muoto ei vastaa tarkoitustamme. Survossa on kuitenkin lukuisia keinojamuuntaa tietoa k„ytt””mme sopivaksi. Sellaista tilannetta, ett„ tiedotjouduttaisiin kirjoittamaan k„sin uudelleen, ei ole.   Jo tekstink„sittelyn yhteydess„ n„ytettiin, miten tietoa poimitaantoimituskentt„„n tekstitiedostosta LOADP- ja SHOW-komennoilla.   My”hemmin, tilastollisten toimintojen yhteydess„, tullaan kuvaamaantarkemmin tietojen siirtoa Survon datatiedostoista.Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@GA@TXA@0T!1@C3@Ta-1@Tp@TLTAULUS@TÿTa1@SCRATCH €   µµµµ Taulukon kirjoittaminen    Jos taulukkoon liittyvi„ tietoja ei l”ydy valmiina tiedostona,aineisto kirjoitetaan Survossa joko suoraan datatiedostoon tai toimi-tuskentt„„n. Nyt tarkastellaan toimituskentt„„n tallentamista.   Taulukkoja kirjoitetaan periaatteessa samoin kuin teksti„. Apunakannattaa kuitenkin k„ytt„„ esim. sarkaimia ja taulukkojen muotoilu-komentoja.   N„yt„mme nyt joitakin mahdollisia tapoja kirjoittaa numeroaineistoja.Tp        Jatka painamalla ENTER!@TVC1200@_@GA@TXA@Tp@Ta-1@   Esimerkiksi otamme pienen 12 Euroopan maata k„sitt„v„n taulukon,TW5@jossa on tietoja er„iden juomien kulutuksesta henke„ kohti.TW20@TW5@   On hyv„ aloittaa kirjoittamalla sarakkeiden otsikot sopivin v„lein:TW20@TW5@  MaaTW5@        KahviTW5@   TeeTW5@   OlutTW5@  ViiniTW5@   ViinaTW20@   Otsikoiden alle kirjoitetaan tietoja maittain seuraavasti:TW10@TW5@  SuomiTW5@       12.5TW5@  0.15TW5@   54.7TW5@    7.6TW5@     2.7TW10@TW5@  RuotsiTW5@      12.9  0.30   58.3    7.9     2.9TW20@TW5@   Kirjoittamista helpottaa olennaisesti sarkainten k„ytt”.TW10@ T„t„kuvattiin jo tekstink„sittelyn yhteydess„.TW10@ Asetamme ensin sarkaimetdesimaalipisteiden kohdalle:TW20@TW10@Ta-5@TD1@T   Ta5@TD0@             T    T       T      T       TTW20@TW5@   Nyt sujuu lukujen asettelu suoriksi sarakkeiksi 0l	=-napinavulla automaattisesti:TW20@TW5@  NorjaTD2@	9.4	0.19	43.5TD0@	3.1	1.8TW20@  Tanska	11.8	0.41	113.9	10.4	1.7TW10@  Englanti	1.8	3.49	113.7	5.1	1.4TW5@Ta1@  Irlanti	0.2	3.73	124.5	3.8	1.9  Hollanti	9.2	0.58	75.5	9.7	2.7  Sveitsi	9.1	0.25	73.5	44.9	2.1  Ranska	5.2	0.10	44.5	104.3	2.5  Italia	3.6	0.06	13.6	106.6	2.0  Espanja	2.5	0.03	43.6	73.2	2.7  Portugali	2.2	0.03	27.5	89.3	0.9Ta-1@TW30@   Joskus on tarvetta kirjoittaa taulukkoa sarakkeittainTW5@ eik„ riveitt„inTW5@kuten juuri tehtiin.TW10@ Taulukon keskell„ tai lopussa olevan sarakkeenkirjoittamista helpottaa t„ll”in nappiyhdistelm„ 0l= l@2,TW5@joka asettaa kohdistimen nykyisen paikan vasemmaksi reunaksi @2-nappia painettaessa.TW20@ Poistetaan nyt 'Viina'-sarake ja kirjoitetaan seuudelleen t„ll„ tekniikalla:TW20@				¹¹¹TD2@TD0@TW5@Vasen reuna kiinnitetty!TW20@TD2@	2.7	2.9	1.8TD0@	1.7	1.4	1.9	2.7	2.1	2.5	2.0	2.7	0.9TW20@Vasen reuna poistetaanpalauttamalla se kent„n alkuun.TW10@Painetaan l@3-nappia jasen j„lkeen uudelleen= @2 .TW20@TD2@TD0@Nyt vasen reunaon palautettu ennalleen.TW20@TW5@SCRATCH TW10@€TW10@  Kirjoittamisen j„lkeen sarkainrivi voidaan poistaaTW10@TW5@TW10@ja taulukko on valmis jatkok„sittelyyn.TW20@  Tulemme seuraavissa sukroissa k„ytt„m„„n t„t„ taulukkoa jamuokkaamaan sit„ edelleen.TW10@ Siksi talletamme sen nyttekstitiedostoksi MAAT.TXT:TW10@SAVEP 23,35,MAAT.TXTTW20@€TW20@Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@GB@TXB@Tp@0T!1@C4@TLTAULUS@TÿTa1@SCRATCH €   µµµµ Taulukon muotoilu Ta-1@   Taulukkoja joudutaan usein j„lkik„teen parantelemaan suoristamallaja siirtelem„ll„ sarakkeita ja rivej„.TW10@   Katsomme er„it„ menettelyj„ mallitaulukkomme avulla.TW10@ Poimimme senensin t„h„n kentt„„n.TW20@LOADP MAAT.TXTTW5@€TW30@TW5@TW5@   Taulukko on mallikelpoinen siin„ suhteessa, ett„ sarakkeet ovatkauniisti suorassa.TW10@ N„in ei ole aina asian laita, kun saamme taulukonk„ytt””mme.TW10@ Teemme nyt hieman ilkivaltaaTW5@ ja n„yt„mme sitten,TW5@ mitensaamme taulukon siistiin asuun j„lleen.TW20@          TW5@   Sarakkeiden ryhdist„miseen k„ytet„„n FORM-komentoa.TW10@ Annamme ensinmallirivin,TW5@ joka n„ytt„„ sarakkeiden paikat ja muodot.TW20@TW5@TW10@  AAAAAAAAA   11.1  11.1  111.1  111.1     1.1TW20@TW5@   Suoristus tapahtuu viittaamalla FORM-komennossa ensimm„iseen javiimeiseen riviin (10,21)TW5@ sek„ malliriviin (22):TW20@TW5@FORM 10,21,22TW10@TD2@€TD0@TW20@TW5@TW5@SCRATCH TW10@€TW20@   FORM-komento sopii luonnollisesti my”s valmiiksi suoristetuntaulukon sarakkeiden kaventamiseen ja levent„miseen:TW20@TW10@TW5@    TW5@   TW20@TW10@TD2@€TD0@TW20@   T„ll”in my”s otsikot (rivill„ 9)TW10@ on syyt„ sijoittaa uudelleen.TW20@Palaamme nyt kuitenkin alkuper„iseen tilaan:TW10@TW10@  TW10@TD2@€TD0@TW20@TW5@TW10@SCRATCH TW10@€TW20@   Sarakkeiden paikkojen vaihtoon voidaan k„ytt„„ CHANGE-komentoaseuraavasti:TW20@   Osoitamme vaihdettavat sarakeryhm„t X- ja Y-maskeilla:TW20@TW5@             XXXXXXXXXXX         YYYYYYYYYYYYYTW20@TW5@   CHANGE-komento viittaa ensimm„iseen ja viimeiseen k„sitelt„v„„nriviin sek„ maskiriviin:TW20@TW10@CHANGE 9,22,22TW20@TD2@€TD0@TW30@TW5@   Koska sis„llytimme riveihin otsikkorivin (9) ja itse maskirivin(22),TW5@ my”s n„m„ muuttuivat j„rkev„sti.TW20@   Niinp„ voimme vaihtaa samalla komennolla takaisin:TW20@TW10@TD2@€TD0@TW20@TW5@SCRATCH TW5@€TW5@   Kun halutaan vaihtaa rivien j„rjestyst„,TW5@ se tehd„„n yksitt„istenrivien osalta CHANGE-komennolla,TW5@ jossa viitataan suoraan vaihdettavienrivien kirjaimilla merkittyihin rivitunnuksiin.TW20@   Vaihtaaksemme 'Englannin' ja 'Hollannin' kesken„„nTW5@ merkitsemmeedellisen rivin X:ll„TW5@, j„lkimm„isen Y:ll„TW5@ ja sovellamme CHANGE-komentoa seuraavasti:TW20@TD2@XYTD0@TW20@TW10@CHANGE XYTW10@TD2@€TD0@TW20@   / Sama uudelleen vaihtaa takaisin.TD2@€TD0@TW20@TW5@TW10@TW5@SCRATCH TW5@€TW10@   Sama CHANGE k„y my”s useista riveist„ koostuvien osataulukoidenpaikanvaihtoon.TW10@ Siirr„mme pohjoismaat taulukon loppuun:TW20@TW5@TW5@ATW5@TW5@ATW5@BTW5@*TW5@BTW5@TW10@CHANGE ABTW10@TD2@€TD0@TW30@  /  Uusi aktivointi palauttaa takaisin.TW10@TD2@€TD0@TW30@TW5@TW5@SCRATCH TW5@€TW5@   Muita keinoja rivien siirtelyyn tarjoavat tekstink„sittelynyhteydess„ esitetyt menettelyt,TW5@ esim. 0l±=-nappi, COPY-komentoja 0l¹=-nappi.TW10@ My”s lajittelukomento SORT,TW5@ jota kuvataanseuraavassa sukrossa,TW5@ on usein hy”dyllinen n„iss„ teht„viss„.TW20@Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@GB@TXB@Tp@0T!1@C5@TLTAULUS@TÿTa1@SCRATCH €   µµµµ Lajittelu Ta-1@   Taulukon lajittelulla pyrit„„n rivit j„rjest„m„„n halutun sarakkeenmukaan esim. suuruusj„rjestykseen tai aakkosj„rjestykseen.TW10@   Lajittelemme nyt esimerkkitaulukkoamme eri tavoin.TW20@LOADP MAAT.TXTTW5@€TW20@TW5@TW10@TW5@   Lajittelu tapahtuu SORT-komennolla,TW5@ joka viittaa lajiteltaviinriveihinTW5@ ja lajitteluavaimena olevaan sarakkeeseen maskirivin kautta.TW20@   Vaikka riveihin viitattaessa saa aina k„ytt„„ rivinumeroita,TW5@ onyleens„ parempi merkit„ t„rke„t rivit kirjaintunnuksinTW5@ ja k„ytt„„komennoissa rivitunnuksia rivinumeroiden asemasta.TW20@ Voimme merkit„ensimm„isen ja viimeisen lajiteltavan rivin seuraavasti:TW20@TD2@ATD0@TW10@TD2@BTD0@TW20@TW5@   Tunnusten k„yt”st„ on se etu,TW5@ ett„ ne pysyv„t paikoillaan, vaikkarivej„ lis„t„„n tai poistetaan.TW10@ Numerot sit„ vastoin muuttuvat:TW20@TW5@TW20@Rivi 'A' oli alunperin 9,TW5@ nyt 11.TW20@TW5@TW10@TW5@TW5@SCRATCH TW10@€TW20@   Lajittelemme taulukon aluksi oluen kulutuksen mukaan nousevaanj„rjestykseen.TW20@ Valitsemme jonkin vapaan rivin maskiriviksi jakirjoitamme numeerisen maskin '11111' Olut-sarakkeen kohdalle.TW20@TW10@                          11111TW10@TW5@   Annamme nyt SORT-komennon ja aktivoimme sen:TW10@TW5@SORT A,B,21TW20@TD2@€TD0@TW30@   Jos haluamme vaihtaa j„rjestyksen viinin kulutuksen mukaiseksi,TW5@on helppo siirt„„ lajitteluavainta ja aktivoida SORT uudelleen:TW20@TW10@       TW10@TD2@€TD0@TW30@TW5@SCRATCH TW10@€TW10@   Saatamme saman tien muuttaa lajitteluj„rjestyksen laskevaksilis„„m„ll„ SORT-komennon eteen merkin -TW10@ ja aktivoimalla j„lleen:TW20@TW5@-TW5@TW10@TD2@€TD0@TW30@TW5@TW10@   Rivit saadaan maan nimen mukaiseen aakkosj„rjestykseenkirjoittamalla Maa-sarakkeen kohdalle aakkosellisen maskin 'AAAAAAAAA'TW10@ja aktivoimalla SORT-komennon:TW20@TW10@TW10@  AAAAAAAAATW20@TW5@TW10@TD2@€TD0@TW30@TW5@SCRATCH TW5@€TW10@   Maat voidaan j„rjest„„ my”s t„sm„lleen k„ytt„j„n valitsemallatavalla,TW5@ esim. siten, ett„ Pohjoismaat ovat ensin jaTW5@ muut seuraavatsuurin piirtein siin„ j„rjestyksess„,TW5@ kuinka kaukana ne ovatSuomesta.TW20@   Teemme t„m„n kirjoittamalla halutut j„rjestysnumerot uudeksilajittelusarakkeeksi,TW5@ asettamalla sille maskinTW5@ ja aktivoimallaSORT-komennon:TW20@					TW5@1TW5@TW5@2TW5@TW5@3TW5@456789101112TW20@TW5@TW10@					TW5@11TW10@TD2@€TD0@TW30@Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@GA@TXA@Tp@0T!1@C6@TLTAULUS@TÿTa1@SCRATCH €   µµµµ Uusien sarakkeiden laskeminen    Monissa sovelluksissa taulukoiden sarakkeista johdetaan laskemallauusia. Survon tarjoamista keinoista t„ss„ esitell„„n komennotSET, COUNT ja C .   Lis„„ mahdollisuuksia l”ytyy kosketuslaskennasta ja VAR-operaatiosta,joita kuvataan my”hemmin erikseen.Tp        Jatka painamalla ENTER!@TVC1200@_@GA@TXA@Ta-1@Tp@   Poimimme j„lleen k„ytt””mme Euroopan maita koskevan taulukon.TW20@LOADP MAAT.TXTTW5@€TW20@TW5@TW10@   SET-komennolla tehd„„n vakiosarake,TW5@ jonka malli annetaanmaskirivill„ esim. seuraavasti:TW20@					TW10@PohjoismaaTW10@SET 12,15,24TW10@TD2@€TD0@TW20@   SET 12,15,24 kopioi siis rivill„ 24 olevan sanan 'Pohjoismaa'jokaiselle riveist„ 12-15.TW30@TW5@SCRATCH TW5@€TW5@   COUNT-komennolla voidaan rakentaa j„rjestysnumeroitaTW5@ ja vastaaviasystemaattisesti etenevi„ sarakkeita.TW20@   Teemme maiden j„rjestysnumerot yll„olevaan taulukkoon n„in:TW20@TW5@TW10@					TW10@11TW10@COUNT 12,23,24TW10@TD2@€TD0@TW30@   COUNT-komennolla on useita yleisempi„ muotoja.TW10@ Emme esittele niit„t„ss„.TW10@ Voit itse etsi„ tietoa kyselysanalla COUNT? .TW20@TW5@SCRATCH TW5@€TW5@¹¹¹TW10@TW20@   C-komennoilla C+,C-,C*,C/ ja C% lasketaan summa-, erotus-, tulo-,osam„„r„- ja prosenttisarakkeita.   Esim. kahvin, oluen ja viinin kulutuksen summaTW5@ (joka ei tarkoitaehk„ mit„„n j„rkev„„ t„ss„)TW5@ lasketaan n„in:TW20@   Merkit„„n yhteenlaskettavat sarakkeet X-maskeilla ja summasarakkeenpaikka ja muoto maskilla '111.1':TW20@TW5@              XXXX        XXXXX  XXXXX             123.1TW20@   Summasarake muodostuu nyt C+ -komennolla:TW10@TW10@C+ 12,23,24TW10@TD2@€TD0@TW30@					TW10@SummaTW10@TW5@TW5@SCRATCHTW5@€TW5@   Vastaavasti kahvin ja teen kulutuksen suhde syntyy seuraavasti:TW20@TW10@              XXXX  YYYY                                   123.123TW20@TW5@/TW10@TD2@€TD0@TW30@Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@GB@TXB@Tp@0T!1@C7@TLTAULUS@TÿTa1@SCRATCH €   µµµµ Uusien rivien laskeminen Ta-1@   Rivien laskeminen aikaisempien perusteella tapahtuu komennoillaL+,L-,L*,L/ ja L%,TW7@ jotka toimivat samalla periaatteella riviensuhteen kuin C-komennot sarakkeiden suhteen.TW20@   Otamme nyt k„sittelyyn pienen valmiina tekstitedostona POHJOLA.TXTolevan v„est”tilaston.TW20@LOADP POHJOLA.TXTTW5@€TW30@TW5@TW10@   Laskeaksemme sarakesummat eli Pohjoismaiden v„est”jakaumanik„luokittain voimme tehd„ sen L+ -komennolla.TW10@ Aktivoimme ensinkyselyn saadaksemme tarkempia tietoja.TW20@L+?TD2@€TD0@TW30@TW5@   L+ viittaa riveihin (L1,L2), joista summat lasketaan,TW5@ maskiriviin(K), joka antaa k„sitelt„v„t sarakkeetTW5@ ja tulosriviin (L), jollesummat kirjoittuvat maskirivin osoittamassa muodossa.TW20@ Toimimme n„in:TW10@TW5@TW5@ATW5@BTW5@LTW5@KTW5@TW5@A,BTW5@TW10@TW5@XXXX  XXXX  XXXX  XXXX  XXXXTW10@TW10@TD2@€TD0@TW30@TW5@   Saamme vastaavasti C+ -komennolla v„kiluvut maittain:TW20@CL  TW20@TW5@ Yht.TW10@11111TW20@TD2@€TD0@TW30@TW10@TW5@   N„emme, ett„ esim. Pohjoismaiden koko v„kiluku on noin 22.5 milj.TW20@   Ns. kosketuslaskenta, joka esitell„„n my”hemmin,TW5@ antaa taitavallek„ytt„j„lle k„tevimm„t keinot t„m„ntapaisiin laskelmiin.TW20@Tp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@GA@TXA@Tp@0T!1@C8@TLTAULUS@TÿTa1@SCRATCH €üGPLOT /DEL ALL€Bü   µµµµ Taulukko tilastollisena aineistona    Survossa tilastollisia aineistoja on mahdollista esitt„„ useissa muo-doissa. N„it„ esitystapoja k„sitell„„n laajemmin tilastollisten menetel-mien yhteydess„.   Kiinnit„mme kuitenkin jo t„ss„ vaiheessa huomiota siihen, ett„ toimi-tuskent„ss„ olevat taulukot kelpaavat Survon tilastollisten toimintojenkohteeksi yleens„ sellaisenaan.   Tilastollisiin aineistoihin viitataan Survossa aina nimelt„. Jos siistaulukkoa k„sitell„„n tilastollisin keinoin, k„ytt„j„n tulee antaa sillenimi, joka kirjoitetaan tavallisesti taulukon eteen muodossaDATA NNmiss„ NN on valittu nimi.   N„yt„mme nyt aivan lyhyesti, miten nime„mme edell„ k„ytt„m„mmetaulukot tilastollisiksi aineistoiksi. Osoituksena, kuinka niit„voidaan k„ytt„„ tilastollisissa toiminnoissa, piirr„mme muutamankuvan.Tp        Jatka painamalla ENTER!@TVC1200@_@GA@TXA@Tp@Ta-1@TW5@   Otamme ensin k„ytt””n pohjoismaisen v„est”tilaston:TW10@LOADP POHJOLA.TXTTW5@€TW20@TW5@TW10@TW5@   Nime„mme nyt taulukonTW10@TW5@DATA POHJOLATW10@ºTW10@ ja piirr„mme siit„ pylv„skuvion GPLOT-komennolla:TW10@GPLOT POHJOLATD2@€TD0@TW20@TW5@   Poimimme sitten 12 Euroopan maata koskevat kulutusluvut:TW10@LOADP MAAT.TXTTW5@€TW20@TW5@   Nime„mme t„m„nkin aineistonTW10@TW5@DATATW5@TW5@TW10@ºTW10@ ja piirr„mme t„st„ viinin ja kahvinkulutuksen riippuvuutta kuvaavan hajontakuvion seuraavasti:TW20@GPLOT MAAT,Viini,KahviTW10@TD2@€TD0@TW10@   Kuva kertoo enemm„n, jos pelkkien pisteiden asemasta panemmekunkin maan paikalle sen nimen.TW20@ T„m„ tapahtuu, kun kirjoitammet„smennyksen POINT=MaaTW10@ ja aktivoimme uudelleen:TW20@TD2@€TD0@TW20@TW5@   Palaamme my”hemmin taulukoiden ja muiden tilastollisten aineistojenkuvaamiseen ja analyysiin.TW20@üTa1@GPLOT /DEL ALL€BTa-1@üTp        T„m„ sukro p„„ttyy. Paina ENTER-nappia!@TVC1200@_@GB@TXB@Tp@0T!1@CX@TLTAULUS@Tÿ



