übTa1@TgC1@C1@C!@C1@C1@SCRATCH€üGPLOT /DEL ALL€BüREDIM 1000,100€Büüü   µµµµµµµ Permutaatiotesti Tarkastellaan kahta yhden muuttujan otostaDATA OTOS1: 148 73 56 63 90 42 106 125 129 161 ENDDATA OTOS2: 127 142 126 91 177 118 169 79 160 106 ENDjoista lasketut keskiarvot ja hajonnat ovatCORR OTOS1,CUR+1€OTOS1  N=10Variable  Mean        Std.dev.OTOS1     99.30000    40.85217CORR OTOS2,CUR+1OTOS2  N=10Variable  Mean        Std.dev.OTOS2     122.5000    46.47401Koska ensimm„iss„ otoksessa keskiarvo (99.3) n„ytt„„ pienemm„lt„ kuintoisessa (122.5), kiinnostaa, onko ero tilastollisesti merkitsev„.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@Ta-1@üSurvossa kysymys ratkeaa erilaisin edellytyksin k„ytt„m„ll„COMPARE-operaatiota seuraavasti (kts. COMPARE?):TW20@COMPARE OTOS1,OTOS2,CUR+1 / SIMUMAX=1000000TW20@€TW30@Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@TW10@Ta1@üSuoritukseen kulunut aika johtui siit„, ett„ tulostaulukossaviimeisin„ esiintyneiden P-arvojen laskenta tapahtui miljoona-kertaisella simulointikokeella. N„in p„„stiin n„kem„„n, ett„n„m„ satunnaistetut testit antavat hyvin samankaltaisiatuloksia kuin vastaava t-testi (t-jakauma-approksimaatiolla)ja Mann-Whitney-testi (normaalijakauma-approksimaatiolla).Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üT„ss„ tapauksessa kaikki 1-suuntaiset testit osoittavat,ett„ havaitun suuruinen poikkeama keskiarvoissa esiintyy yli10 prosentissa sellaisia tapauksia, joissa otokset ovat kotoisinsamasta perusjoukosta. Keskiarvojen ero ei siis ole tilastollisestimerkitsev„.Satunnaistetuilla testeill„ pyrit„„n toteuttamaan k„yt„nn”ss„ se, mit„jo R.A.Fisher tarkoitti permutaatiotestill„.Keskiarvojen testaamisessa permutointi-idea merkitsee yksinkertaisestiseuraavaa: Jos n„m„ 10 havainnon otokset otokset ovat samastaperusjoukosta, voidaan ajatella havainnot yhdistett„v„ksi 20 havainnonaineistoksi, josta OTOS1 on vain yksi C(20,10)=184756 mahdollisesta,yht„ todenn„k”isest„ otoksesta.Jos siis muodostetaan kaikki nuo l„hes 200000 10 havainnon otosta,lasketaan niist„ keskiarvot ja verrataan niit„ todellisuudessahavaittuun keskiarvoon 99.3, saadaan k„sitys, kuinka harvinainent„m„ havaittu tilanne on nollahypoteesin p„tiess„. Erityisestihavaitun keskiarvon alittavien ja tuon saman keskiarvon omaavienotosten suhteellinen osuus on permutaatiotestin P-arvo.K„yt„nn”ss„ on viel„ yksinkertaisempaa laskea otosten havaintosummatja t„ss„ tapauksessa l”yt„„ niiden otosten suhteellinen osuus, joillatuo summa on korkeintaan 10*99.3=993.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üSuurilla havaintom„„rill„ permutaatiotestin laskeminen on varsinty”l„st„. T„m„n vuoksi COMPARE-operaatiossa aito permutaatiotestikorvataan yksinkertaiseen otantaan perustuvalla satunnaistetullatestill„. T„ll”in arvotaan tuosta yhdistetyst„ (t„ss„ 20 havainnon)aineistosta tietty m„„r„ (t„ss„ per„ti miljoona) havaitun ykk”sotoksenkokoisia (t„ss„ 10) otoksia ja suoritetaan vastaavat laskutoimitukset.N„in saadaan satunnaisvaihtelua omaava P-arvo, joka koetoistojenlis„„ntyess„ l„hestyy stokastisesti todellista permutaatiotestinP-arvoa.COMPARE-operaatio kertoo P-arvon tarkkuudesta laskemalla koko ajan my”ssen keskivirhett„, joka t„ss„ tapauksessa on lopulta vain 0.00033(itse P-arvo oli 0.12535). Koska kyseinen P-arvo noudattaa n„inmonilla koetoistoilla varsin tarkkaan normaalijakaumaa, sille onhelppo muodostaa luottamusv„li.Yleens„ koetoistoja ei tarvitse tehd„ kovin paljon (oletus on COMPARE-operaatiolla 100000) ja ajon voi aina keskeytt„„ painamalla ENTER-nappia, kun havaitsee, ettei ole aihetta jatkaa. Toimituksentarvitsee harvoin kest„„ muutamaa sekuntia kauempaa.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@üPermutaatiotestien ehdoton etu on se, ett„ ne toimivat huomattavastiv„ljemmin oletuksin kuin vaikkapa t-testi t„ss„ tapauksessa. Esim.mit„„n normaalijakauma-olettamusta ei tarvita.Mielest„ni satunnaistettujen testien pit„isi tulla esille jotilastotieteen perusopetuksessa, koska aikaisemmat laskentaanliittyv„t rajoitukset eiv„t en„„ ole k„ytt”„ rajoittavina estein„.Satunnaistetun keskiarvotestin ymm„rt„minenk„„n ei vaadi l„hesk„„nniin paljon teoreettisia esitietoja kuin t-testin.Satunnaistettu testi siis korvaa t„ydellisen permutaatiotestin k„yt„n-n”ss„. T„ss„ yhteydess„ on kuitenkin tarkoitus n„ytt„„, miten Survonavulla voidaan laskea tuo tarkka P-arvo em. testaustilanteessa.T„h„n tarkoitukseen saattaa l”yty„ varsin kehittyneit„ algoritmeja.Nyt tyydyt„„n kuitenkin pelk„st„„n Survon perustoimintojensoveltamiseen.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±Ta-1@üTarkan P-arvon laskemiseksi t„ss„ kahden 10 havainnon otoksentapauksessa k„yt„mme raakaa voimaa ja pyrimme luettelemaan kaikkimahdolliset C(20,10)=TW10@€184756TW10@ ykk”sotosta.TW30@Suurennamme ensin toimituskent„n 200000-riviseksi:TW10@REDIM 200000,100TW10@€TW10@Sitten teemme tuon luettelon COMB-operaatiolla seuraavasti:TW20@SYMBOLS=A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,TTW10@COMB C10,CUR+2 / C10=SUBSETS,20,10 RESULTS=1TW10@€TW30@ü¶Kirjaimin nimetyt havainnot ovat t„ss„ "aakkosj„rjestyksess„":TW30@TW20@TW20@TW10@TW10@Viimeisen„ siis 10 viimeisen kirjaimen "otos"TW40@TW10@¶¶TW20@üToistamme alkuper„iset otokset ja annamme arvoille kirjaintunnukset:TW10@ OTOS1Tp        K„ytet„„n PREFIX-J-tekniikkaa!@TW20@J           OTOS2J          Tp@TW20@A=B=C=D=E=F=G=H=I=J=K=L=M=N=O=P=Q=R=S=T=TW20@TW10@Sitten m„„rittelemme luettelon matriisiksi X, jonka talletamme:TW20@MATRIX X ///MAT SAVE XTW10@€TW10@üEmme en„„ tarvitse luetteloa, sill„ kaikki 184756 otosta ovatnumeerisessa muodossa talletettuina matriisitiedostoksi X.MAT.TW20@SCRATCHTW10@€TW10@Palautamme toimituskent„n rivien m„„r„ksi 1000:TW10@REDIM 1000,100TW10@€TW20@TW10@Otokset n„ytt„v„t matriisitiedostossa X.MAT t„llaisilta.TW5@Poimimme n„kyviin vain 20 ensimm„ist„ rivi„:TW10@MAT LOAD X(1:20,*),123,CUR+1TW10@€TW20@TW30@üTp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±üOtossummat on yksinkertaisinta laskea k„ytt„m„ll„ matriisifunktiotaSUM(A), joka laskee matriisin A pystyrivisummat vaakavektoriksi.TW20@T„ll”in matriisin X vaakarivisummat (otossummat) saadaan suoraanpystyvektorina S komennollaTW20@MAT S=(SUM(X'))'TW10@€TW20@MAT S(0,1)="Summa" / Annetaan ainoalle sarakkeelle nimi 'Summa'.TW10@€TW10@N„ytteeksi poimitaan 10 ensimm„ist„ otossummaa:TW10@MAT LOAD S(1:10,1),12345,CUR+1TW10@€TW30@Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±üLopuksi lasketaan niiden otosten lukum„„r„, joilla summa on korkeintaan993.TW20@ Huom. Matriiseja voi tietyin ehdoin k„ytt„„ datana my”stilastollisissa operaatiossa.TW20@CORR S.MAT,CUR+1 / IND=Summa,0,993 PRIND=0TW10@€TW20@Po. otosten lukum„„r„ on siis N=€ja permutaatiotestin P-arvo on t„ss„ tapauksessaN/C(20,10)=TW10@€TW20@eli simuloinnilla saatu P-arvo 0.12535 on todella l„hell„t„t„ teoreettista tulosta.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±Ta1@üAito permutaatiotesti jo kaksinkertaisilla havaintom„„rill„ onmielet”n teht„v„, sill„ mahdollisten ykk”sotoksia l”ytyy per„tiC(40,20)=137846528820.Vaikka t„ydellist„ l„pik„ynti„ olisikin mahdollista lyhent„„„lykk„ill„ algoritmeilla, en pid„ sellaisten kehitt„mist„kovinkaan tarpeellisena.Satunnaistamistekniikka riitt„„ mainiosti kaikissa j„rkeviss„tilanteissa.Tp        Jatka painamalla ENTER-nappia!@TVC1200@_@@Tp@.±Ta-1@üTeknisen„ n„ytteen„ t„st„ kaksinkertaistetaan aikaisemmat otoksetDATA OTOS12: 148 73 56 63 90 42 106 125 129 161             148 73 56 63 90 42 106 125 129 161 ENDDATA OTOS22: 127 142 126 21 177 118 169 79 160 106             127 142 126 21 177 118 169 79 160 106 ENDja aktivoidaanCOMPARE OTOS12,OTOS22,CUR+1TW20@€TW50@N„in muutamassa sekunnissa todetaan, ett„ keskiarvojen eroon 5 prosentin tasolla merkitsev„.µµµµµPermutaatiotestin k„sittely p„„ttyy!Tp        Lopeta painamalla ENTER-nappia! (Keskeytys napilla .)@TVC1200@_@@Tp@ü>DEL X.MAT€>DEL S.MAT€>DEL %%1.MAT€ü0T!1@C7@TLTNLS@TÿRS: To avoid MIPSEL-BE ECOFF executable conflict in R CMD check



{u}LOAD OTOKSET{R}

















