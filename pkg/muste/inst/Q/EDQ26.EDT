SURVO84ED 101 250   101 S20                                                                          *SAVE EDQ26                                                                                          *LOAD EDQ                                                                                            *                                                                                                    *REGRES?                                                                                             *Linear regression analysis                                                                          *The linear regression model is specified by activating variables in the                             *data set as follows:                                                                                *  Y is the regressand,                                                                              *  X is a regressor,                                                                                 *  R is the residual variable (optional, must not be protected),                                     *  P is the variable for predicted values (optional, not protected).                                 *For general rules of variable selection, see MASK and VARS.                                         *                                                                                                    *The following operations work on this basis:                                                        *  A = LINREG  (OLS through correlations)                                                            *  B = REGDIAG (OLS by orthogonalization, regression diagnostics)                                    *  C = MOVREG  (Moving linear regression analysis) (by KV)                                           *  D = ROBREG  (Least Median of Squares regression analysis) (by Reino Siren)   C                    *  E = ESTIMATE (for non-linear models)                                                              *                                                                                                    *  U = Sucros for regression analysis (special applications)                                         *  S = More information on statistical analysis                                                      %A=LINREG B=REGDIAG C=MOVREG? D=ROBREG E=ESTIMATE? U=U S=STATIS?                                     *@SELECT                                                                                             *                                                                                                    *U?                                                                                                  *Sucros for regression analysis (special applications):                                              *                                                                                                    */RESTREG ? / for linear regression with linear restrictions (by F. èberg)                           */STEPREG ? / for stepwise and automatic linear regression (by M.Karpoja)                            */LM-ANOVA  / for diagnostics and graphics (in Finnish) (by M.Lahdenkari)                            */LOGREG?   / for logistic regression analysis (by KV)                                               */LMSELECT? / for model selection statistics (by KV)                                                 *                                                                                                    *  R = More information on linear regression analysis                                                *  S = More information on statistical analysis                                                      %R=REGRES S=STATIS?                                                                                  *                                                                                                    *LINREG?                                                                                             @LINREG data,L                                                                                       *performs linear regression analysis on active variables in <data>.                                  *The regressand is indicated by mask Y and the regressors by X's.                                    *The optional variables for residuals and predicted values of the                                    *model are pointed out by masks R and P, respectively.                                               *The first line for the results (L) is optional.                                                     *If the results level is at least 70 (see RESULTS?), the means, standard                             *deviations and correlations of variables included in the model will be                              *also printed.                                                                                       *If several Y variables are given, the same model (with a constant term                              *and X variables) will be computed for each of them. In this case no                                 *R and P variable is valid.                                                                          *                                                                                                    *LINREG saves the regression coefficients in a matrix file REG.M                                     *and in the case of one regressand and one regressor also coefficients                              C*of an orthogonal regression analysis in a matrix file OREG.M.                                      C*                                                                                                    *  D = Regression diagnostics                                                                        *  R = More information on regression analysis                                                       %D=REGDIAG R=REGRES                                                                                  *@SELECT                                                                                             *                                                                                                    *REGDIAG?                                                                                            @REGDIAG <data>,L                                                                                    *estimates the parameters of a linear regression model by orthogonalizing                            *the design matrix X.                                                                                *These procedure is more accurate than the classical approach of LINREG                              *through moment matrix (correlations).                                                               *The model is specified by activating variables with Y and X's. The                                  *constant term is omitted by setting CONSTANT=0.                                                     *Furthermore the following masks for special output variables may be used:                           *  R is the residual variable,                                                                       *  P is the variable for predicted values,                                                           *  H is the diagonal of the hat matrix X*INV(X'*X)*X',                                               *  S is the variable for (externally) Studentized residuals,                                         *  C is the variable for (signed square roots of) Cook's distances.                                  *                                                                                                    *These output variables provide a basis for regression diagnostics.                                  *See Belsley,Kuh&Welsch (1980): Regression Diagnostics, for example.                                 *  M = Matrix files created by REGDIAG                                                              C*  R = More information on regression analysis                                                       *  S = MAT SOLVE (is a similar procedure in the matrix interpreter)                                  *  C = Confidence intervals in simple linear regression (in PLOT)                                   C*  D = Durbin-Watson test statistics and its P-values                                               C%M=MATRDIAG R=REGRES S=MATSOL? C=CONFBAND? D=DURBIN                                                  *@SELECT                                                                                             *                                                                                                    *MATRDIAG?                                                                                           *Matrix files created by REGDIAG                                                                    C*                                                                                                    *The following matrices are available for additional computations:                                   *REG.M        vector of regression coefficients                                                      *REGS.M       regression coeffients and their standard errors                                        *REG_CORR.M   correlations of regression coefficients                                                *RG.M         vector of miscellaneous scalars (see next page)                                        *                                                                                                    *The covariance matrix of regression coefficients can be computed by                                 */COV REG_COV,REG_CORR.M,REGS.M                                                                      *@C                                                                                                  *The vector RG.M has the following contents (when displayed by MAT LOAD).                            *REGDIAG statistics from data DECA                                                                   *RG.M                                                                                                *///          REGDIAG                                                                                *n             48.000 / # of cases                                                                   *k              6.000 / # of regression coefficients                                                 *const          1.000 / 1 if constant term included, 0 otherwise                                     *df            42.000 / n-k                                                                          *Yvar       26132.000 / variance of regressand                                                       *SST      1228203.979 / total sum of squares                                                         *SSE       445535.121 / residual sum of squares                                                      *SSR       782668.858 / SST-SSE                                                                      *MSE        10607.979 / mean square error                                                            *Resvar     10607.979 / MSE                                                                          *R              0.798 / multiple correlation coefficient                                             *R2             0.637 / R^2                                                                          *kappa         93.968 / condition number                                                             *DW             1.246 / Durbin-Watson statistics                                                     *F             14.756 / Overall F-test: SSR/(k-1)/MSE (only when const is 1)                         *Pr_F           1.000 / P-value of F-test                                                            >HELP-REGDIAG /                        Studying P-values of F-test in |EXAMPLE|                     C*@END                                                                                                *                                                                                                    *ROBREG?                                                                                             @ROBREG <data>, L                                  / Reino Siren                                     *Performs a robust estimation of the parameters of a linear regression                               *model by the method of Least Median of Squares (Rousseeuw 1984,                                     *Rousseeuw & Leroy 1987). Instead of minimizing the sum of squared                                   *residuals (OLS), the median of squared residuals is minimized, giving                               *estimates which are highly robust to outliers in the data.                                          *The model is specified by activating variables with Y and XÔs in the                                *<data>.                                                                                             *The constant term is omitted by setting CONSTANT=0.                                                 *The seed number used in subsampling may be specified by SEED=<integer>.                             *It is optional.                                                                                     *The number of trials or samples from the data used in the estimation,                               *may be specified by TRIALS=<integer>. The default value is 1500.                                    *@C                                                                                                  *ROBREG (continued)                                                                                  *                                                                                                    *Furthermore the following masks for special output variables from the                               *LMS -fit may be used:                                                                               *U is the residual variable,                                                                         *V is the variable for predicted values,                                                             *T is the variable for the standardized lms-residuals.                                               *                                                                                                    *The printed output includes the LMS estimates of the regression                                     *coefficients and the robust error scale estimate.                                                   *The first line of results (L) is optional.                                                          *                                                                                                    *Literature:                                                                                         *Rousseeuw, Peter, J. 1984.  Least median of squares regression. J. Am.                              *Stat. Assoc. Vol 79, 871-880.                                                                       *- " - & Leroy, Annick, M. 1987. Robust Regression and Outlier                                       *Detection. Wiley. New York.                                                                         *http://win-www.uia.ac.be/u/statis/publicat/progress_abstr.html                                      *                                                                                                    *  R = More information on regression analysis                                                       %R=REGRES                                                                                            *                                                                                                    *DURBIN?                                                                                             *REGDIAG gives the value of the Durbin-Watson statistics for testing                                 *the first order autocorrelation of residuals.                                                       *To get its P-value enter a specification DWN=<integer>                                              *where <integer> must be at least 10000.                                                             *Then the P-value will be computed by simulation using <integer>                                     *replicates.                                                                                         *                                                                                                    *Also higher-order autocorrelations can be tested by the same method.                                *By MAXLAG=k the order 1,2,...,k autocorrelations of residuals                                       *will be tested by using the generalized DW statistics                                               *                                                                                                    *       sum [res(i)-res(i-j)]^2                                                                      *D(j) = -----------------------                                                                      *          sum [res(i)]^2                                                                            *                                                                                                    *where res(1),...,res(n) are the residuals of the estimated linear                                   *regression model                                                                                    *   Y = X*beta + eps                                                                                 *where X is the n*m design matrix and eps is N(0,sigma^2*I).                                         *Then we have res=M*eps where M=I-X*inv(X'X)X'.                                                      *@C                                                                                                  *By making the SVD decomposition X=U*D*V' where U is a n*m matrix                                    *the residuals can be computed by 2*m*n multiplications by                                           *res=(I-U*U')*eps.                                                                                   *                                                                                                    *In randomized tests DWN replicates of D(j), j=1,2,...,k are                                         *computed and the P values are obtained as the proportion of replicates                              *having a lower value than the original one.                                                         *                                                                                                    *By using RN specification instead of DWN the randomized tests                                       *will be based on autocorrelations instead of DW values.                                             *                                                                                                    >HELP-DWN /                                                 See |EXAMPLE|                           C*                                                                                                    *  E = Estimating regression models with autocorrelated disturbances                                 *  R = More about REGDIAG                                                                            %E=AR? R=REGDIAG                                                                                     *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    *                                                                                                    END                                                                                                  