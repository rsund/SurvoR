SURVO84ED 81 180    81 S20                                                       *SAVE EDQU1                                                                      *LOAD EDQU2                                                                      *                                                                                *GLM?                                                                            *Generalised Linear Models (GLM):                                                *   1 = TABFIT for data in multiway tables                                       *   2 = GENREG for general cases                                                 *   3 = Logistic regression analysis by GENREG                                  C%1=TABFIT 2=GENREG? 3=LOGIST?                                                    *@SELECT                                                                         *                                                                                *TABFIT?                                                                         @TABFIT <table>,<name of model>,L                                                *estimates the parameters of a log-linear model for frequency data               *given as a multiway table (F table) or                                          *estimates the parameters of an ANOVA model for data                             *given as a multiway table (X table).                                            *                                                                                *Both types of TABFIT models are special cases of GLM (generalized linear        *models) and treated here by the same program.                                   *The type of the multiway table (F or X) is given as the last parameter          *of the TABLE definition for <table>. It specifies whether a log-linear          *model (with the log link) or a classical ANOVA model (with the identity         *link) is estimated.                                                             *@C                                                                              @TABFIT <table>,<name of model>,L                                                *Parameter L is optional and gives the first line for the results in             *the edit field.                                                                 *The model to be fitted has to be defined by a MODEL specification typed         *on any two consecutive lines in the edit field as follows:                      *     MODEL <name of model>                                                      *     <list of terms to be fitted>                                               *<table> has to be written in the edit field and it has to be defined            *by a TABLE specification. The structure of <table> is that of tables            *produced by the TAB operation (See TAB?). Thus, multiway tables                 *computed by TAB can be used as input for TABFIT without any changes.            *                                                                                *Each term in the model may consist either of one (main effect) or               *several (interaction between factors) factors.                                  *The factors are notated by the initials of the classifier names                 *in the table.                                                                   *@C                                                                              *The model is given on two consecutive edit lines in the form:                   *MODEL <name of the model>                                                       *<list of the terms to be fitted>                                                *                                                                                *The terms to be fitted are separated by a '+' operator. If the term is          *an interaction term of two or several classifiers, the factors must be          *separated by '.'.For example, A.B represents an interaction of A and B.         *Also a '*' operator can be used:                                                *For example, A*B=A+B+A.B                                                        *             A*B*C=A+B+C+A.B+A.C+B.C+A.B.C                                      *The user can remove any existing term from the model by operator '-':           *For example, A*B*C-A.B.C=A+B+C+A.B+A.C+B.C                                      *The constant term is given as '1'.                                              *Thus a typical model definition is                                              *MODEL M1                                                                        *1+S+B*K                                                                         *where S,B and K are initials of classifiers of the multiway table.              *@C                                                                              *The extent of results given by TABFIT is controlled by the RESULTS              *specification.                                                                  *If RESULTS=0, only minimal information (i.e. deviance, degrees of freedom       *and structure of the model) is printed.                                         *Otherwise also the estimates of the parameters and their standard errors        *are given.                                                                      *Furthermore, if a value >70 (like RESULTS=100) is given, the fitted             *values are displayed as a new multiway table having the same                    *structure as the original table.                                                *                                                                                *In all cases, the design matrix generated by TABFIT is saved as a matrix        *file XTAB.M and the covariance estimates of parameters as a matrix file         *PCOV.M on the current data disk.                                                *                                                                                *   T = More information on table management                                     *   S = More information on statistical analysis                                 %T=TABT? S=STATIS?                                                               *@SELECT                                                                         *                                                                                *TABTEST?                                                                        @TABTEST <table_of_frequencies>,L                                                *performs various tests for independence etc. by simulation                      *for a two-dimensional table of frequencies. The table is                        *given in edit field in the form used by the TAB operations.                     *The table can be also given in a simpler form without any labels:               *TABLE TEST / Example (An empty line indicates the end of the table.)            *7 2 0                                                                           *3 1 5                                                                           *                                                                                *Different assumptions about the stochastic structure of the table are           *determined by a FIX specification with following alternatives:                  *   FIX=Fisher  Both row and column margins fixed (exact test)                   *   FIX=RC      Both row and column margins fixed                                *   FIX=C       Column margins (vertical sums) fixed                             *   FIX=R       Row margins (horizontal sums) fixed                              *   FIX=N       No fixed margins, only the grand total fixed                     *   FIX=F(i,j)  Element of row i and column j fixed                              >HELP-TABTEST /                                             See |EXAMPLE|       C*   FIX=FIT     Goodness of fit test for an n x 2 table                         C*@C                                                                              *The test statistics used in simulation is selected by a TEST specification:     *TEST=X^2 is the common Pearson's chi-square statistics: sum of (O-E)^2/E .      *TEST=G^2 is the likelihood statistics: sum of -2*O*log(O/E) .                   *TEST=PROB is the probability of the simulated table. The unknown                *          margin probabilities are replaced by simulated relative               *          frequencies. We call this `Probability statistics'.                   *In case FIX=Fisher, TEST=PROB is always selected.                               *In other cases TEST=X^2 is default.                                             *@C                                                                              *Maximum number of replicates is given by SIMUMAX (default 10000000).            *The seed number of the random number generator (either 'rand' or 'urand')       *is given by RAND (default RAND=rand(12345). See RAND? .                         *The process may be interrupted by pressing any key.                             *                                                                                *The results are displayed after each 100 replicates as a table of the form      *      N           P               Confidence interval (level=0.95)              *# of replicates   Estimate of P                lower limit                      *            s.e.  Standard error               upper limit                      *                                                                                *The confidence level for P is set by CONF=p (0.8<p<1). Default is CONF=0.95     *The two-way table is also saved as a matrix by using the specification          *MATRIX=<name_of_a_matrix_file> , say, MATRIX=T .                                *This matrix can be analyzed further, for example, by the sucro command          */X2                                                                             *which computes various derived tables as matrices such as the expected          *frequencies and decomposition of the X^2 statistics in cells and                *margins.                                                                        *@C                                                                              *........................................................................        *Example:                                                                        *TABLE T / This 2x2 table is tested with default settings.                       *7 2                                                                             *1 4                                                                             *                                                                                *TABTEST T,CUR+1                                                                 *                                                                                *   G = Goodness of fit test for an n x 2 table                                 C*   T = More information on TAB operations                                       *   S = More information on statistical tests                                    %G=GFIT T=TAB? S=TEST?                                                           *                                                                                *GFIT?                                                                           *Goodness of fit test for an n x 2 table                                         *                                                                                *TABTEST <table>,L / FIX=FIT                                                    C*computes the Pearson goodness of fit test for an n x 2 table of                 *integers. In the first column the observed frequencies                          *and in the second column integers proportional to the expected                  *frequencies are given.                                                          *After the common Chi-squared approximation for P is obtained                    *the P value is also computed by simulation according to the same                *principle as in other forms of TABTEST.                                         *                                                                                *   T = More information about TABTEST                                           %T=TABTEST                                                                       *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                END                                                                              