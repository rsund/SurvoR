SURVO84ED 81 300    81 S20                                                       *SAVE EDQM3                                                                      *LOAD EDQ                                                                        *                                                                                *MATSAVE?                                                                        *Matrices to be processed by MAT operations have to be saved in matrix           *files. The MAT SAVE operation does this job both for matrices written           *in the edit field and for matrices coming from various Survo files.             *  A = Saving matrices from the edit field                                       *  B = Moving matrices from Survo data files to matrix files                     *                                                                                *  M = More information on MAT operations                                        %A=SAVE1 B=MATDATA M=MATO?                                                       *@SELECT                                                                         *SAVE1?                                                                          *A matrix to be saved in a matrix file has to be represented in either           *of the two forms below:                                                         *                                                                                *   11 *    2x3 matrix A without row and column labels:                          *   12 *MATRIX A ///                                                             *   13 * -1.45  2.33 -5.00                                                       *   14 *  0.91  3.07  2.28                                                       *   15 *                                                                         *   16 *    2x3 matrix B with row and column labels:                             *   17 *MATRIX B                                                                 *   18 *///    Y1   Y2   Y3                                                      *   19 * X1  12.2 33.6  6.1                                                      *   20 * X2   3.9  0.0 18.7                                                      *   21 *                                                                         *                                                                                *In both cases the line after the last row in the matrix must be left            *empty or it has to start with word END. @C                                      *To save a matrix A located in the edit field, activate                          *MAT SAVE A                                                                      *and the first matrix in the current edit field starting with MATRIX A           *will be saved in matrix file A.MAT on the current data disk.                    *To save matrix A in matrix file TEST.MAT, activate                              *MAT SAVE A TO TEST.                                                             *Hence MAT SAVE A is equivalent to MAT SAVE A TO A.                              *                                                                                *A direct way to save a matrix without a MATRIX label is                         *   11 *                                                                         *   12 *MAT SAVE AS A                                                           C*   13 * -1.45  2.33 -5.00                                                       *   14 *  0.91  3.07  2.28                                                       *   15 *                                                                         *@C                                                                              *Also general and rowwise comments can be given                                 C*as shown by the following schematic example:                                    *                                                                                *MATRIX A                                                                        *This is a general comment 1.                                                    *This is a general comment 2.                                                    *A                                                                               *///  C1  C2  C3                                                                 *R1   11  12  13                                                                 *R2   21  22  23 / This a comment on line R2.                                    *R3   31  32  33 / This a comment on line R3.                                    *R4   41  42  43                                                                 *                                                                                *MAT SAVE A / Saving A                                                           *                                                                                *If the matrix is loaded by MAT LOAD A, the comments will appear                 *in their proper places.                                                         *This feature is useful especially in result matrices like RG.M                  *in REGDIAG making the output self-documenting. (See REGDIAG?:M)                 *@C                                                                              *Symbolic constants in matrices                                                  *A matrix to be saved from the edit field may also have expressions              *of symbolic constants as elements. For example,                                 *   11 *                                                                         *   12 *   r=sqrt(1/n) n=4                                                       *   13 *MATRIX R ///                                                             *   14 * 1    r    r^2  r^3                                                      *   15 * r    1    r    r^2                                                      *   16 * r^2  r    1    r                                                        *   17 * r^3  r^2  r    1                                                        *   18 *                                                                         *defines a 4*4 matrix which can saved by MAT SAVE R. Please, note that           *R will be saved in numerical form only. If r is altered, MAT SAVE R             *must be activated again.                                                        *@G MM                                                                           *                                                                                *MM?                                                                             *  S = More information on MAT SAVE                                              %S=MATSAVE                                                                       *@SELECT                                                                         *                                                                                *MATDATA?                                                                        @MAT SAVE DATA <Survo data> TO <matrix file>                                     *saves a Survo data file (active fields) or a part of it to a matrix             *file. The specifications VARS, MASK, CASES and IND are available for selecting  *variables and observations to be moved. If the first active field is a          *string field it will be used as the row label. Otherwise the rows are           *labelled numerically. The columns are always labelled by the                    *corresponding field names (abbreviated to 8 first characters).                  *                                                                                *Since in many applications the order of columns (variables) is important,       *it can be changed either by specifying the variables in desired order           *by VARS or by observing the fact that MAT SAVE DATA sorts the columns           *in alphabetic order with respect of their activation mask symbols.              *For example, MASK=AYY-XX specifies the order 1,5,6,2,3 (4 omitted)              *of columns (variables).                                                         *                                                                                *  S = More information on MAT SAVE                                              *  M = More information on multivariate statistical analysis                     %S=MATSAVE M=MULTI?                                                              *@SELECT                                                                         *                                                                                *MATLOAD?                                                                        @MAT LOAD <matrix file>,<format>,L                                               *loads <matrix file> to the edit field using the optional <format>.              *L will be the first line in the edit field for the loaded matrix.               *Examples: MAT LOAD R,##.###,10     MAT LOAD R,20                                *If <format> is omitted, a proper format will be sought automatically.           *MAT LOAD <matrix file>                                                         C*loads <matrix file> immediately after the command line.                        C*                                                                                *Also parts (submatrices) may be loaded as follows:                              *MAT LOAD R(6:10,1:5),10                                                         *loads a submatrix of R consisting of the rows 6-10 and of the columns 1-5.      *                                                                                *For temporary displays of matrix files use /MATSHOW <matrix_file> or           C*/MATSHOW <matrix_file>,<format>. Example: /MATSHOW CORR.M,12.123               C*                                                                                *  L = LOADM operation for output in partitioned form                            *  A = Elements of matrices in editorial computing                               *  M = More information on MAT operations                                        %L=LOADM A=MATARIT? M=MATO?                                                      *@SELECT                                                                         *                                                                                *LOADM?                                                                          @LOADM <matrix_file>,<format>,L                                                  *works in principle like MAT LOAD but writes the matrix in the edit              *field (and in the output file) in block form where the width of each            *block is limited by the visible part of the edit field.                         *The number and order of rows and columns to be written can be selected          *by ROWS and COLUMNS specifications. For example, ROWS=3,2,1,4 informs           *that rows 3,2,1,4 only and in this order will be written.                       *                                                                                *To emphasize exceptional elements of the matrix (like high loadings             *of a factor matrix) in the display, specifications LIMITS and SHADOWS           *can be used.                                                                    *Another alternative is to use the SHADOW_MATRIX specification as shown in       *                                                                                *LIMITS gives a list of upper bounds of various classes and SHADOWS              *gives a list of corresponding shadow values.                                    *Example: LIMITS=-0.7,-0.3,0.3,0.7,1                                             *         SHADOWS=7,1,0,1,7  (0=normal display)                                  *Another alternative is to use the SHADOW_MATRIX specification as shown in       >HELP-LOADM_S /                                             See |EXAMPLE|       C*@C                                                                              *Formats of elements in LOADM:                                                   *Parameter <format> is given in one of the following ways:                       *                                                                                *1. LOADM <matrix_file>,12.1234,L                                                *   writes elements with 2 places in the integer part and with 4 decimals.       *                                                                                *2. LOADM <matrix_file>,(10),L                                                  C*   gives elements with 10 characters according to the maximum element          C*   by absolute value. Thus when the greatest value is 1998.261213,             C*   the selected format corresponds to 1234.1234 (if negative values            C*   appear in the matrix) or to 1234.12345 (if not).                            C*                                                                               C*3. LOADM <matrix_file>,(C10),L                                                 C*   works as the previous alternative but the format is selected                C*   separately for each column of the matrix.                                   C*@C                                                                              *@G LOADM2                                                                       *                                                                                *LOADM2?                                                                         *                                                                                *Extended form of LOADM especially for factor matrices                          C*according to the style suggested by Lauri Tarkkonen:                           C*                                                                                @LOADM <matrix_file>,<format>,L                                                  *with specifications LIMITS, SHADOWS, SORT, COLUMNS, SUMS, POSDIR, WIDE          *writes a (rotated factor) matrix in the edit field by                           *  1. sorting (SORT) the rows hierarchically by factors and loadings             *     of variables,                                                              *  2. inserting long descriptive names of variables at the end of                *     each row (provided that a name of data giving those names is               *     indicated by SORT),                                                        *  3. displaying the elements with different shadings according to their         *     sizes (LIMITS, SHADOWS as described earlier, see LOADM?),                  *  4. sorting the columns according to the sums of squares (COLUMNS=SORT),       *  5. displaying marginal sums of squares (SUMS=2) or sums (SUMS=1),             *  6. orienting the factors (signs of loadings) according to the same            *     rules as in the POSDIR operation (POSDIR=1,2, or 3), see POSDIR?,          *  7. allowing wide matrices to be written as a single block (WIDE=1)            *     if the line length is large enough.                                        *@C                                                                              *The most important specification is SORT of the form                            *SORT=1                                                                          *or                                                                              *SORT=<name_of_data_file>                                                        *In both cases the variables are written in the order of their                   *loadings in different factors as follows. At first the factors                  *are studied according the order of the sums of squares of loadings.             *Variables having their highest loadings in the strongest factor                 *are sorted to descending order according to the absolute                        *values of their loadings in that factor. These variables in this                *order will appear as first ones in the output. The same procedure               *is applied to the remaining variables according to the second                   *strongest factor and so on.                                                     *In the latter form of SORT the long names of variables are taken                *from the given data file and appended to the end of each row.                   *This helps interpretation of factors.                                           *@C                                                                              *SORT=-1 or SORT=-<name_of_data_file>                                            *leads to the same sorting procedure but now within each factor                  *the loadings are sorted by their signed values.                                 *                                                                                *An extra parameter in all forms of SORT, for example, SORT=1,0.3                *excludes variables with a highest loading less than a given value (0.3)         *from the sorting procedure and puts those variables (rows) at the end           *of the matrix.                                                                  *                                                                                *Sucro /LOADFACT <data_file>,<rotated_factor_matrix>                             *does the job automatically with selected values of extra specifications         *and gives a ready-made work scheme which may be improved by the user.           *See                                                                             */LOADFACT ?                                                                     *@END                                                                            *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                END                                                                              