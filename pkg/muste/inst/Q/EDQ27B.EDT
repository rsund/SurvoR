SURVO84ED 81 300    81 S20                                                       *SAVE EDQ27B                                                                     *LOAD EDQ27                                                                      *                                                                                *LOGMEAN2?                                                                       *Derivation of the formula                                                       *                              n       xi                                        *(1) L(x1,x2,...,xn) = (n-1)! SUM ---------------                                *                             i=1     n                                          *                                  PRODUCT log(xi/xj)                            *                                    j=1                                         *                                    j<>i                                        *                                                                                *from the definition of L as a series expansion                                  *                                                                                *(2) L(x1,x2,...,xn) = 1 + (u1+u2+...+un)/n +                                    *                    ...                                                         *                      u1^m+u1^(m-1)*u2+...+un^m                                 *                    + -------------------------                                 *                           C(n+m-1,m)*m!                                        *                    + ...                                                       *                                                                                *where ui=log(xi), i=1,2,...,n and                                               *the homogeneous, symmetric polynomial in the term of the m'th degree            *has the form                                                                    *@C                                                                              *P(n,m)=     SUM         u1^i1*u2^i2*...*un^in .                                 *        i1+i2+...+in=m                                                          *        i1>=0, i2>=0,...,in>=0                                                  *                                                                                *Thus the coefficients are all equal to 1 which was typical for the              *basic case n=2. Binomial coefficients C(n+m-1,m) appearing as divisors          *equal to number of terms in the polynomial.                                     *                                                                                *It was mentioned already that P(n,m) can be represented in a recursive          *form according to decreasing powers of the last u as                            *                                                                                *(3)  P(n,m) =   u(n)^m                                                          *              + u(n)^(m-1)*P(n-1,1)                                             *              + u(n)^(m-2)*P(n-1,2)                                             *              ...                                                               *              + u(n)^1*P(n-1,m-1)                                               *              + u(n)^0*P(n-1,m)                                                 *                                                                                *with side conditions  P(n,1) = u1+u2+...+u(n),                                  *                      P(1,m) = u1^m.                                            *@C                                                                              *If all x's (as well u's) are mutually different, it is fundamental              *to notice that these polynomials can be represented by another way              *by using expressions                                                            *                                                                                *               n    ui^m                                                        *(4) Q(n,m) =  SUM  ------, k=0,1,2,...,                                         *              i=1   T(i)                                                        *                                                                                *where                                                                           *             n                                                                  *(4b) T(i) = PRODUCT (ui-uj).                                                    *            j=1                                                                 *            j<>i                                                                *                                                                                *The following identities are valid and will be proved at the end of this        *text:                                                                           *(5)  Q(n,m) = 0  for m=0,1,2,...,n-2,                                           *(6)  Q(n,n-1) = 1,                                                              *(7)  Q(n,m) = P(n,m-n+1)  for m=n,n+1,n+2,...  .                                *                                                                                *By means of these identities we can derive (1) from (2).                        *@C                                                                              *The series expansion (2) is transformed stepwise as follows:                    *                                                                                *    L(x1,x2,...,xn) = 1 + P(n,1)/n + P(n,2)/[C(n+1,2)*2!] + ...                 *                                                                                *                        + P(n,m)/[C(n+m-1,m)*m!] + ...                          *                                                                                *                                  oo     P(n,m)                                 *                    = 1 + (n-1)!  SUM   --------                                *                                  m=1   (n+m-1)!                                *                                                                                *                                  oo     Q(n,n+m-1)                             *                    = 1 + (n-1)!  SUM   -----------  from (7)                   *                                  m=1    (n+m-1)!                               *                                                                                *                                  oo     Q(n,k)                                 *                    = 1 + (n-1)!  SUMA  --------                                *                                  k=n      k!                                   *                                                                                *                              oo     Q(n,k)                                     *                    = (n-1)!  SUM   --------         from (6)                   *                             k=n-1     k!                                       *@C                                                                              *                              oo     Q(n,k)                                     *                    = (n-1)!  SUM   --------         from (5)                   *                              k=0      k!                                       *                                                                                *                                      n    ui^k                                 *                                     SUMA ------                                *                              oo     i=1   T(i)                                 *                    = (n-1)!  SUM   ------------     from (4)                   *                              k=0      k!                                       *                                                                                *                                     oo    ui^k                                 *                                     SUM  ------                                *                               n     k=0    k!                                  *                    = (n-1)!  SUM   ------------                                *                              i=1      T(i)                                     *                                                                                *@C                                                                              *                               n     exp(ui)                                    *                    = (n-1)!  SUM   ----------       from (4b)                  *                              i=1    n                                          *                                    PRODUCT (ui-uj)                             *                                    j=1                                         *                                    j<>i                                        *                                                                                *which is identical with (1) since ui=log(x1), i=1,2,...,n.                      *                                                                                *Jorma Merikoski (University of Tampere) remarked that (5)                       *and (6) are well-known identities when considering divided differences          *(in the Lagrange interpolation scheme) for powers u^k, k=0,1,...,n-2.           *                                                                                *His note led me to find out that (1) is equal to the (only) (n-1)th             *order divided difference of 'function values' xi=exp(ui), i=1,2,...,n,          *multiplied by (n-1)!.                                                           *See also http://mathworld.wolfram.com/DividedDifference.html                    *By METHOD=4, LOGMEAN computes the logarithmic mean by using this                *divided difference scheme but it has the same computational                     *deficiencies for larger n as (1).                                               *@C                                                                              *Proof of identitities (5),(6),(7) (without using results for divided            *differences):                                                                   *                                                                                *It can be seen that these identities are valid for n=2. In this case            *  Q(2,k) = u1^k/(u1-u2)+u2^k/(u2-u1) = (u1^k-u2^k)/(u1-u2), k=0,1,2,...         *and                                                                             *  Q(2,0)=0, Q(2,1)=1 and Q(2,k)=P(2,k-1) for k=2,3,...                          *                                                                                *The general proof is based on induction from n-1 to n. Thus by assuming         *that the identities are valid in case n-1 it will be shown that they            *are valid in case n, too.                                                       *@C                                                                              *By writing denominators ui^m in (4) in the form                                 *(ui^m-un^m)+un^m and by splitting these terms and by dividing the               *first part by the last factor ui-un in the divisor                              *we get a recursion formula                                                      *                                                                                *(8) Q(n,m) =   un^(m-1)*Q(n-1,0)                                                *             + un^(m-2)*Q(n-1,1)                                                *             + ...                                                              *             + un^0*Q(n-1,m-1) + un^m*Q(n,0) for m=1,2,...                      *                                                                                *Let's denote                                                                    *Q(n,0) = f(u1,u2,...,un) and study the function f by the inverse values         *of its arguments, i.e. the function f(1/u1,1/u2,...,1/un).                      *Then the expressions 1/ui-1/uj can be written in the form                       *(uj-ui)/(ui*uj) and after simplification we get                                 *                                                                                *f(1/u1,1/u2,...,1/un) = (-1)^n*u1*u2*...*un*Q(n,n-2)                            *@C                                                                              *By applying the recursion formula (8) to the last factor and by                 *observing that (5) is valid in case n-1, we see that only the last term         *in the recursion formula can be different from 0 and hence                      *                                                                                *f(1/u1,1/u2,...,1/un) = (-1)^n*u1*u2*...*un*un^(n-2)*f(u1,u2,...,un).           *                                                                                *Function f(u1,...,un) is homogeneous and symmetric.                             *If f were else than identically zero, this leads to a contradiction             *since the right side of the last equation could not be a symmetric              *function in cases n>2. Thus Q(n,0)=0 for n=2,3,... and (5) has been             *proved in case m=0.                                                             *                                                                                *Then in (8) the last term can be omitted and we have                            *                                                                                *(9) Q(n,m) =   un^(m-1)*Q(n-1,0)                                                *             + un^(m-2)*Q(n-1,1)                                                *             + ...                                                              *             + un^0*Q(n-1,m-1)  for m=1,2,...                                   *@C                                                                              *By the induction assumption this gives                                          *                                                                                *    Q(n,1) = un^0*Q(n-1,0) = 0,                                                 *    Q(n,2) = un^1*Q(n-1,0) + un^0*Q(n-1,1) = 0,                                 *    ...                                                                         *    Q(n,n-2) = un^(n-3)*Q(n-1,0) + ... + u^n0*Q(n-1,n-3) = 0                    *                                                                                *Thus (5) has been proved also for m=1,2,...,n-2.                                *                                                                                *In case m=n-1 (9) gives                                                         *                                                                                *    Q(n,n-1) = un^0*Q(n-1,n-2) = 1*1 = 1                                        *                                                                                *and (6) is valid.                                                               *@C                                                                              *In case m=n (9) gives                                                           *                                                                                *    Q(n,n) = un^1*Q(n-1,n-2) + un^0*Q(n-1,n-1)                                  *           = un*1 + 1*(u1+u2+...+u(n-1)) = u1+u2+...+un                         *                                                                                *and (7) is valid when m=n and Q(n,n)=P(n,1).                                    *                                                                                *By these results the recursion formula (9) can be reduced to the form           *                                                                                *(10) Q(n,m) =   un^(m-n+1)                                                      *              + un^(m-n)*Q(n-1,n-1)                                             *                ...                                                             *              + un^0    *Q(n-1,m-1) , k=1,2,...                                 *                                                                                *By using this formula and (7) for n-1 we get                                    *                                                                                *     Q(n,n+1) = un^2 + un^1*Q(n-1,n-1) + un^0*Q(n-1,n)                          *              = un^2 + un*P(n-1,1) + P(n-1,2)                                   *              = P(n,2)   by (3)                                                 *                                                                                *which means that (7) is valid for m=n+1 and Q(n,n+1)=P(n,2).                    *@C                                                                              *Correspondingly when m>n we obtain by using (10) and (7) (the latter            *for n-1)                                                                        *                                                                                *     Q(n,m) = + un^(m-n+1)                                                      *              + un^(m-n)  *P(n-1,1)                                             *              + un^(m-n-1)*P(n-1,2)                                             *                ...                                                             *              + un^0      *P(n-1,m-n+1)                                         *                                                                                *            = P(n,m-n+1)  by (3)                                                *                                                                                *and this proves (7) in general.                                                 *                                                                                *   L = More information on logarithmic mean                                     %L=LOGMEAN?                                                                      *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                *                                                                                END                                                                              