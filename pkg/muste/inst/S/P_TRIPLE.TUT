üüüüTa1@bFBSCRATCH€ü µµµµµµµ Pythagorean triples and their neighbours A triple of integers X,Y,Z satisfying the equation X^2+Y^2=Z^2is called a Pythagorean triple.Then a right triangle exists with legs X,Y and hypotenuse Z.Now a scatter diagram of X,Y (X=1,2,...,200, Y=1,2,...,200)will be plotted so that each point will have a color on thecolor scale from red to green depending on how close Z=sqrt(X^2+Y^2)is to an integer.Thus if X,Y,Z is a Pythagorean triple, point (X,Y) is red anddepending on how much Z differs from an integer the colorwill change from red towards green.You may click any point in the graph and see if it is a Pythagoreanpoint (X,Y) and if not, how close Z is to an integer.See also curved traces between neighbouring points.üTp        Press ENTER!@Ta-1@TVC600@_@@Ta1@Tp@ü.±µ21 colors gradually from green to red: FILL(-1)=1.00,0.00,1.0,0   FILL(-11)=0.50,0.50,1.0,0 FILL(-2)=0.95,0.05,1.0,0   FILL(-12)=0.45,0.55,1.0,0 FILL(-3)=0.90,0.10,1.0,0   FILL(-13)=0.40,0.60,1.0,0 FILL(-4)=0.85,0.15,1.0,0   FILL(-14)=0.35,0.65,1.0,0 FILL(-5)=0.80,0.20,1.0,0   FILL(-15)=0.30,0.70,1.0,0 FILL(-6)=0.75,0.25,1.0,0   FILL(-16)=0.25,0.75,1.0,0 FILL(-7)=0.70,0.30,1.0,0   FILL(-17)=0.20,0.80,1.0,0 FILL(-8)=0.65,0.35,1.0,0   FILL(-18)=0.15,0.85,1.0,0 FILL(-9)=0.60,0.40,1.0,0   FILL(-19)=0.10,0.90,1.0,0FILL(-10)=0.55,0.45,1.0,0   FILL(-20)=0.05,0.95,1.0,0                            FILL(-21)=0.00,1.00,1.0,0µCreating file P_TRIPLE:FILE CREATE P_TRIPLE,64,8FIELDS:1 N 2 X2 N 2 Y3 N 4 ZENDü€üM=200FILE INIT P_TRIPLE,40000€µCreating a grid of points (X,Y):X=int((ORDER-1)/M)+1Y=ORDER-X*M+MVAR X,Y TO P_TRIPLE€µComputing Z values:VAR Z=sqrt(X*X+Y*Y) TO P_TRIPLE€µComputing deviation from the nearest integer:D=min(Z-int(Z),int(Z+1)-Z)VAR D TO P_TRIPLE€µNon-linear mapping of D values to color indices -20,-19,...,-1:F=-int(20-20*(2*D)^0.2)-1VAR F:2 TO P_TRIPLE€µMaking the graph:GPLOT /DEL ALL€GPLOT /FIX 1€TITLE=Pythagorean_points_and_their_neighbours_(Survo_graphics)FILE DEL MOUSE.MSG€SCALE=0,200 XLABEL= YLABEL= HEADER= k=0.96 MODE=1024,1024 WSIZE=k*WY,k*WY WHOME=WX-k*WY,0XDIV=124,800,100 YDIV=124,800,100TEXTS=T1,T2,T3,T4,ExitT1=[Arialb(25)][RED],Pythagorean_points_(X;Y):_X^2+Y^2=Z^2_& (X;Y;Z_integers)_in_red,124,990T2=[Arialb(25)][GREEN],Other_points_(X;Y)_more_or_less_green_& depending_on_how_far_Z_is_from_an_integer.,124,960T3=[Arialb(25)][GREEN],See_curved_traces_between_neighbours.,124,930T4=[Arialb(30)][RED],Click_any_point!,740,925Exit=[Arialb(30)][RED],EXIT,935,60MOUSE=MOUSE.MSG OUTFILE=AGPLOT P_TRIPLE,X,Y / POINT=6,3 µPOINT_COLOR=F€µWaiting for a new point:LR1TXM@TtC2@TW2@Ta1@CHECK MOUSE.MSG€TtC2@TW3@Ta1@ i8xBTIA8@CN@@GM@@LOADP MOUSE.MSG€üWWi1wWi2wüTIN2@C100@GE1@@@üüüüT=3@1@-@C124@T=4@2@-@C124@T=3@3@/@C4@T=4@4@/@C4@üint(@3)=€ i3wint(@4)=€ i4wT=5@3@*@3@T=6@4@*@4@T=5@5@+@6@sqrt(@5)=€ C.i6xT!7@C1@TIA6@C.@GA@@GA@üBT=3@3@+@C1@@3 @4 T=5@3@*@3@T=6@4@*@4@T=5@5@+@6@sqrt(@5)=€ C.i6xT!7@C2@TIA6@C.@GA@@GA@üBT=3@3@-@C1@T=4@4@+@C1@@3 @4 T=5@3@*@3@T=6@4@*@4@T=5@5@+@6@sqrt(@5)=€ C.i6xT!7@C3@TIA6@C.@GA@@GA@üBT=3@3@+@C1@@3 @4 T=5@3@*@3@T=6@4@*@4@T=5@5@+@6@sqrt(@5)=€ C.i6xT!7@C4@TIA6@C.@GA@@GA@üBround(sqrt(@3^2+@4^2),4)=€ i5wB(@3;@4)_is_not_Pythagorean_(Z=@5).Bi7XTLGB@TXA@i5wB(@3;@4)_is_Pythagorean!_(Z=@5).Bi7XTLGB@üTXB@.±TITLE=Pythagorean_points_and_their_neighbours_(Survo_graphics)T=[Arial(45)],@7,124,50 üExit=[Arial(30)],EXIT,935,60  FRAMES=F F=930,57,65,35,-1FILL(-1)=0,0.8,0.8,0üTEXTS=T,Exit INFILE=A k=0.96 MODE=1024,1024 WSIZE=k*WY,k*WY WHOME=WX-k*WY,0 XDIV=124,800,100 YDIV=124,800,100 MOUSE=MOUSE.MSG FILE DEL MOUSE.MSG €GPLOT /FRAME €üLr1TLGM@TXE1@.±GPLOT /DEL ALL€Büµµµµµµµ Some hypotheses: Our illustration of Pythagorean points reveals e.g. that all thesepoints (X,Y) seem to be located on hyperbolasY = 2*C*(X-C)/(X-2*C), C=1,2,...The equations can be written in parametric formX(T) = C*sqrt(2/tan(T))+2*C,Y(T) = C*sqrt(2*tan(T))+2*C,  0 < T < pi/2and the hyperbolas are plotted in yellow for values C=1,2,...,50on the previous graph as follows:üTp        Press ENTER!@Ta-1@TVC600@_@@Ta1@Tp@ü.±TITLE=Pythagorean_points_and_their_neighbours_(Survo_graphics)INFILE=ASCALE=0,200 XLABEL= YLABEL= HEADER=k=0.96 MODE=1024,1024 WSIZE=k*WY,k*WY WHOME=WX-k*WY,0XDIV=124,800,100 YDIV=124,800,100FRAMES=F1,F2 F1=740,927,200,30,-1 F2=930,57,65,35,-1FILL(-1)=0,0,0,0  LINETYPE=[WHITE]TEXTS=T1 T1=[Arial(45)],Yellow_hyperbolas_connecting_&Pythagorean_points,124,50C=1(1)50pi=3.141592653589793T=[YELLOW],0.00001,pi/2,pi/1000GPLOT X(T)=C*sqrt(2/tan(T))+2*C-1/4,Y(T)=C*sqrt(2*tan(T))+2*C-1/4€Tp        Press ENTER!@Ta-1@TVC600@_@@Ta1@Tp@üGPLOT /DEL ALL€BüBy a small sucro, the number N(C) of Pythagorean points on the curveY = 2*C*(X-C)/(X-2*C)is computed for X < Y and we getC     1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 µ18µµµµµµµ 19 ...N(C)  1  2  3  3  3  6  3  4  5  6  3  9  3  6  9  5  3 µ10µµµµµµµ  3 ...This seems to be sequence A078644 in Sloane's Encyplodia of IntegerSequences and thus the general expression for N(C) isN(C) = d(2*C^2)/2where d(n) is the number of divisors of n.For example, for C=µ18µµµµµµµ we have 2*C^2=648 and 648(10:factors)=2^3*3^4.Then 648 has (3+1)*(4+1)=20 divisors and N(C)=µ10µµµµµµµ.If you like to see these results proved, please press 'µYµµµµµµµ'.Otherwise press µENTERµµµµµµµ.üTp        Press 'Y' or ENTER!@Ta-1@TVC600@_Yy@@GY@GY@Ta1@Tp@üTXX@GPLOT /DEL ALL€FILE DEL P_TRIPLE€FILE DEL A.EMF€FILE DEL MOUSE.MSG€TgC1@C1@C!@C1@C1@TLGE@TXY@Ta1@Tp@.±LR2üWe now prove that the number of Pythagorean points on the curve(1)    X(T) = C*sqrt(2/tan(T))+2*C,       Y(T) = C*sqrt(2*tan(T))+2*C,  0 < T < pi/2where C is a positive integer isN2(C) = d(2*C^2)where d(n) is the number of divisors of n.X(T) and Y(T) must be positive integers. Therefore sqrt(2/tan(T)) andsqrt(2*tan(T)) must be rational and this implies that tan(T) must beof the form       tan(T) = 2*k^2where k is a rational number.Then equations (1) are then written in the form(2)     X(k) = 2*C + C/k,(3)     Y(k) = 2*C + 2*C*k.The last member of a Pythagorean triple Z(k) (Z(k)^2=X(k)^2+Y(k)^2) is(4)     Z(k) = 2*C + C/k + 2*C*k = X(k) + Y(k) - 2*CThen N2(C) will be the number of k-values for which all threeexpressions (2),(3),(4) are positive integers.Since Z(k) is an integer when X(k) and Y(k) are integers,it is sufficient to pay attention to X(k) and Y(k) only.If C is a prime number p<>2, it is seen immediately that the onlyaccepted values for k for getting integer values X(k),Y(k)i.e. simultaneously for C/k and 2*C*k are        k = 1, p, 1/pand their halves        k = 1/2, p/2, 1/2psince the latter ones give an integer value also for 2*C*k.Similarly, if C is product of two primes p,q<>2, the only acceptedvalues for k are        k = 1, p, q, pq, p/q q/p, 1/p, 1/q, 1/pqand their halves        k = 1/2, p/2, q/2, pq/2, p/2q q/2p, 1/2p, 1/2q, 1/2pq.Now it is crucial to notice that there is a bijection fromdivisors of 2*C^2=2*p^2*q^2 to these values of k by        2^(i)*p^(ip)*q^(iq) <=> 2^(i-1)*p^(ip-1)*q^(iq-1)where i=0,1, ip,iq=0,1,2.In the general case let the prime factorization of C beC = 2^a*p1^a1*...pm^am. Then the bijection is(5) 2^(i)*p1^(i1)*...*pm^(im) <=>                             2^(i-a-1)*p1^(i1-a1)*...*pm^(im-am)where i=0,1,...2*a+1, i1=0,1,...,2*a1, ..., im=0,1,...,2*am.Since the only valid k-values (making X(k) and Y(k) integers)are values on the right side of (4) and the left side gives alldivisors of 2*C^2, we finally obtainN2(C) = d(2*C^2).The same result has been recently derived inDarryl McCullough: Height and Excess of Pythagorean Triples,   Mathematics Magazine, Vol.78, No.1, February 2005but our treatment of the problem is simpler due to the parametricrepresentation (1) while McCullough is operating in a more generalframework. Also the nice interpretation of N2(C) as thenumber of divisors of 2*C^2 seems not to be given in his paper.From equations (4) we get the excessX(T)+Y(T)-Z(T) = 2*Cand this is the basis of enumeration in McCullough's paper. Since theexcess is always an even integer, it is clear that only integer valuesof C give Pythagorean triples. Hence equations (2),(3),(4) give anexhaustive enumeration of these triples for C=1,2,... and for variousk-values obtained from divisors of 2*C^2 according to (5).Lr2TXE@Tÿ
 def Wx=W1 Wy=W2 Wtmp=W8







 New point is (Wx,Wy).
 Exit ?

 Checking type of the point (X,Y):







   {print W3}^2+{print W4}^2={act}{line end} {print W5}^2={act}











