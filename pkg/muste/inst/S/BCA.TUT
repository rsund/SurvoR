¸Ta1@b@!T!1@CBCA@;SUR-SAVE0@&BINIT 1000,100ÄTIA1@C?@@GHelp@@TIA1@C(empty)@@GHelp@@TLGAlku@TXHelp@ºLl¸     Bootstrap-based confidence limits     / Reijo Sund 2003BSÅÅÅÅÅÅÅÅÅÅÅâÉãèèéåÑÖ±SUsage: /BCA <data>,<variable>,<theta>,<alfa>,<replications>,<seed>Sucro /BCA produces bootstrap-based confidence limits for some statistic <theta> of some variable <variable> in some data <data>. The confidence level is given with parameter <alfa>. The number of bootstrap replications <replications> and some seed <seed> for the random number generator are also needed. /BCA works with statistics defined in FILE AGGR, such as MEAN, MEDIAN and STDDEV.The precentile method and acclerated and bias-corrected (BCa) method are used in producing bootstrap-based confidence limits. For MEAN /BCA calculates also the confidence limits based on normal approximation.For more information, see: Efron, B. & Tibshirani, R.J. (1993): An introduction to the boostrap. Chapman & Hall, New York.http://statwww.epfl.ch/davison/BMA/Example: /BCA <Survo>\U\D\DECA,Height,MEAN,0.95,3000,1234Tp        Press ENTER!@T!1@C1@TXscroll@T=1@1@+@C1@LOLoºTVC1@S@@GEnd1@TIN1@C20@@@Gfill@SSTLGscroll@TLGscroll@TXfill@S∫±ST!1@C1@TLGscroll@¸TXEnd1@Tp@L0@!T!1@CBCA@;SUR-RESTORE0@&B/BCA <Survo>\U\D\DECA,Height,MEAN,0.95,3000,1234BTLGEnd@TXAlku@/SUR-RESTORE BCAFILE DEL _BCA0ÄFILE COPY = _BCA0 / VARS=@2ÄMAT SAVE DATA _BCA0 TO _BCA0ÄVAR _BCAD=1 TO _BCA0Ä.±FILE AGGR _BCA0 BY _BCAD TO _BCA1 / PRIND=0VARIABLES:N N @2THETA @3 @2HAJ STDDEV @2ENDÄMAT SAVE DATA _BCA1 TO _BCA1ÄMAT__BCA1(N)=Ä i7w.±FILE DEL _BCA1ÄMAT _BCA4=#JACKKNIFE(_BCA0)ÄFILE SAVE MAT _BCA4 TO _BCA1Ä.±VAR _BCAD=int((ORDER-1)/@7-1)+1 TO _BCA1Ä.±FILE AGGR _BCA1 BY _BCAD TO _BCA2 / PRIND=0VARIABLES:THETA @3 @2ENDÄVAR _BCAD=1 TO _BCA2Ä.±FILE AGGR _BCA2 BY _BCAD TO _BCA3 / PRIND=0VARIABLES:THETA MEAN THETAENDÄMAT SAVE DATA _BCA3 TO _BCA2Ä.±U1=(MAT__BCA2(THETA)-THETA)^3 U2=(MAT__BCA2(THETA)-THETA)^2VAR U1,U2 TO _BCA2ÄFILE AGGR _BCA2 BY _BCAD TO _BCA3 / PRIND=0VARIABLES:U1 SUM U1U2 SUM U2ENDÄVAR A=if(U2<>0)then(U1/(6*(U2^(3/2))))else(0) TO _BCA3ÄMAT SAVE DATA _BCA3 TO _BCA3Ä.±FILE DEL _BCA4 / PRIND=0ÄT=10@7@*@5@MAT _BCA5=#SAMPLE(_BCA0,@:,URS,@6)ÄFILE SAVE MAT _BCA5 TO _BCA4Ä.±VAR OTOS=int((ORDER-1)/@7)+1 TO _BCA4Ä.±FILE AGGR _BCA4 BY OTOS TO _BCA5 / PRIND=0VARIABLES:THETA @3 @2ENDÄMAT__BCA1(THETA)=Ä i8w_BCAD=1 _BCAZ=if(THETA<@8)then(1)else(0)VAR _BCAD,_BCAZ TO _BCA5Ä.±FILE AGGR _BCA5 BY _BCAD TO _BCA6 / PRIND=0VARIABLES:ZN SUM _BCAZENDÄMAT SAVE DATA _BCA6 TO _BCA4ÄAPU=MAT__BCA4(ZN)/@5N.G(0,1,APU)=Ä i<w.±CORALFA=(1-@4)/2+@4ZALFAUP=N.G(0,1,CORALFA)ZALFALOW=N.G(0,1,1-CORALFA)ZLOW=MAT__BCA1(THETA)-ZALFAUP*(MAT__BCA1(HAJ)/sqrt(MAT__BCA1(N)))ZUP=MAT__BCA1(THETA)+ZALFAUP*(MAT__BCA1(HAJ)/sqrt(MAT__BCA1(N)))Z0=@<A=MAT__BCA3(A)ALFAUP=N.F(0,1,Z0+((Z0+ZALFAUP)/(1-A*(Z0+ZALFAUP))))ALFALOW=N.F(0,1,Z0+((Z0+ZALFALOW)/(1-A*(Z0+ZALFALOW))))CORALFA=Ä i>w1-CORALFA=Ä i=wALFAUP=Ä i@wALFALOW=Ä i?wZLOW=Ä iAwZUP=Ä iBw.±FILE AGGR _BCA5 BY _BCAD TO _BCA6 / PRIND=0VARIABLES:LOW FRACTILE(@=) THETAUP FRACTILE(@>) THETABCALOW FRACTILE(@?) THETABCAUP FRACTILE(@@) THETAENDÄT=6@4@*@C100@@!T!1@CBCA@;SUR-RESTORE0@&BFILE LOAD _BCA6,CUR+2 / VARS=LOW,UPÄBFILE LOAD _BCA6,CUR+5 / VARS=BCALOW,BCAUPÄBBootstrap @6%-confidence limits (@5 replications)B@3 = @8BPercentile methodBBias-corrected and accelerated (BCa)BTIA3@CMEAN@@GKeskiarvo@@TLGEnd@TXKeskiarvo@∫ (norm.apprx.CI: @A - @B)BTLGEnd@TXEnd@LLºTa-1@Tˇ Boostrap luottamusvÑlit (Reijo Sund 11/2003)
 # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
 # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
