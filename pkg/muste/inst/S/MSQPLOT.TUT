übTa1@@!T!1@CMSQPLOT@;SUR-SAVE0@&INIT 1000,1000€LINE=[BLACK][line_width(1.2)],7 LINE2=[BLACK],X,Y sc=0.2POINT=[RED],0,10 XSCALE=1-sc,colMSQ+sc YSCALE=1-sc,rowMSQ+scSIZE=colMSQ*200,rowMSQ*200 XDIV=1,10,1 YDIV=1,10,1 HOME=0,0MAT MSQ== / SELECT=ORDER,MIN,MAX€YLABEL=@2 / POINT2=¶MAT MSVEC=VEC(MSQ')MAT MSVEC(0,1)="VALUE"MAT DIM MSQFILE SAVE MAT MSVEC TO NEW MSVECFILE EXPAND MSVEC,10,40 / X2=0 Y2=0 C=0T!10@CVAR X:2,Y:2,X2:2,Y2:2,C:2 TO MSVEC / Y=int((N-ORDER)/(N/rowMSQ))+1 X=mod(ORDER-1,colMSQ)+1@@:FILE SORT MSVEC BY VALUE TO MSSORTFILE COPY MSSORT TO NEW MSPICFILE COPY MSSORT TO MSPIC / SELECT=ORDER,1VAR C=VALUE TO MSSORT / FILL(0)=0,1,1,0 FILL(1)=1,0,1,0PLOT MSPIC,X,Y / DEVICE=PS,MSQUARE.PS FRAME=0 XLABEL= HEADER=EPS MSQUARE =-MSQPLOT- HYPPY....................LINE=[BLACK][line_width(1.2)],7 LINE2=[BLACK],X,Y sc=0.2LINE3=CX,CY LINE4=CX,CY DEVICE=PS,MSQ.PSFRAME=0 XLABEL= HEADER= YLABEL=@2POINT=[RED],0,10 XSCALE=1-sc,colMSQ+sc YSCALE=1-sc,rowMSQ+scSIZE=colMSQ*200,rowMSQ*200 XDIV=1,10,1 YDIV=1,10,1 HOME=0,0MX=(X+X2)/2 MY=(Y+Y2)/2DX=X2-X DY=Y2-Y K=0.2 (1-L/M)*0.2 M=sqrt((colMSQ-1)^2+(rowMSQ-1)^2)L=sqrt(DX*DX+DY*DY) CX=if(DX=0)then(CXX)else(CXY) CY=if(DY=0)then(CYY)else(CYX)CXY=if(DY=0)then(MX)else(MX+DX/L*K) CYX=if(DX=0)then(MY)else(MY-DY/L*K)CXX=if(DY<0)then(MX+K)else(MX-K) CYY=if(DX<0)then(MY+K)else(MY-K)VALUE=if(ORDER>N/2)then(MISSING)else(X)A=VALUE,!MISSING- HYPPYMAT DIM MSQT!10@CVAR X2:2,Y2:2,VALUE,CX,CY,L,M,K TO MSSORT / X2=X[+(N+1-2*ORDER)] Y2=Y[+(N+1-2*ORDER)]@@:T!10@CPLOT MSSORT,X,Y / SELECT=A LINE=[BLACK][line_width(1.2)],9 LINE2=X2,Y2 POINT=4,10 POINT2=4,10@@:EPS MSQ =-MSQFAMT!10@CPLOT MSSORT,X,Y / SELECT=A LINE=[BLACK][line_width(1.2)],6 LINE2=X2,Y2 POINT=4,10 POINT2=4,10 LINE3=X,Y LINE4=X,Y@@:EPS MSQ =-MSQFAS¶€/GS-PDF =-MSQB±CUR-1ºPLOT.EPS€B±CUR-1ºFAM.EPS€B±CUR-1ºFAS.EPS€T!1@CMSQPLOT@;SUR-RESTORETÿPlot routines for magic squares, RS 29.8.2013
