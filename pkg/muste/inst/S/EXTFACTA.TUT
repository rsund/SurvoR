üüüüTa1@bTIA1@Creturn@@GM@@i3TKC~MASK@i4TKC~METHOD@i5TKC~IND@i6TKC~CASES@i7TKC~SELECT@i8TKC~FEPS@@!T!1@CSURVOEXF@;SUR-SAVETb0@0@&TgC1@C1@C!@C1@C1@SCRATCH€TIA1@C?@GA@@GA@TXH@ü/EXTFACTA <data_file>,<#_of_factors>                              creates a setup for extended graphical factor rotation.           At first it makes a primary factor solution FACT.M by FACTA       for variables activated by 'A's and 'B's.                         Then it computes the projections of external variables activated  by 'X's to the factor space (as correlations of factor scores and X-variables) and saves them as EXTFACT.M.                         Finally a following setup is created in the edit field:           EXTERNAL=EXTFACT.M                                                FSHOW=FSHOW.M                                                     ROTATE FACT.M,<#_of_factors>,CUR+1 / METHOD=GRAPHICAL             where FSHOW.M is an indicator vector of of '1's and '0's with     '1' for each A-variable and '0' for each B-variable.              Thus when the ROTATE operation is activated by the user,          a graphical factor rotation can be performed in a window where    only A-variables (in black) and X-variables (in gray) are shown.  Before activating /EXTFACTA it is the user's task to divide       the variables to categories 'visible' i.e. important (A) and      'invisible i.e. secondary (B) in order to get a clear picture of  the factor space especially when the number of variables is high. The X-variables are to be used as external quidance when selectingrotated factor axes.                                              üTp        Press ENTER!@TXM2@TVC600@_@@TXM@Tp@T!1@CSURVOEXF@;SUR-RESTORETLGEnd@TXA@üüüTgC1@C1@C!@C1@C1@µ/EXTFACTA return / back to current work!TIA4@C@@GA1@@METHOD=@4TXA1@TIA3@C@@GA2@@MASK=@3TXA2@TIA5@C@@GA3@@IND=@5TXA3@TIA6@C@@GA4@@CASES=@6TXA4@TIA7@C@@GA5@@SELECT=@7TXA5@TIA8@C@@GA6@@FEPS=@8TXA6@STAT =,CUR+1,STATUS / #MASK=ABX€#A=€ i9wB#B=€ i:wB#X=€ i;wBT=12@9@+@10@TIN12@C0@@GERR1@@CORR =€MAT DIM CORR.M€rowCORR.M-#A-#B-#X=€ i=w=TIN13@C0@GERR2@@GERR2@MAT !R=CORR.M(1:@<,1:@<)€FACTA !R,@2€MAT !A=FACT.M€TIN11@C0@@GL@@T=13@12@+@C1@T=14@12@+@11@MAT !RAB=CORR.M(@=:@>,1:@<)€üMAT !J=INV(DIAG(IDN(@<,@<)-!A*!A'))€MAT !K!=INV(!A'*!J*!A+IDN(@2,@2))*!A'*!J€üMAT EXTFACT.M=!RAB*!K'*DIAG(!K*!R*!K')^(-0.5)€MAT NAME EXTFACT.M AS Loadings_of_external_variables€TXL@üMAT FSHOW.M=CON(@<,1)€MAT RLABELS FROM !A TO FSHOW.M€MAT FSHOW.M(0,1)="show"€TIN10@C0@@GL1@@T=13@9@+@C1@MAT !J=ZER(@:,1)€MAT FSHOW.M(@=,1)=!J€MAT NAME FSHOW.M AS Variables_to_be_displayed€MAT KILL !*.MAT€TXL1@LR1Setup for graphical factor rotation generated by /EXTFACTA:Primary factor matrix saved in FACT.M             þ /MATSHOW FACT.MTIN11@C0@@GL2@@EXTERNAL=EXTFACT.M Loadings of external variables þ /MATSHOW EXTFACT.MTXL2@FSHOW=FSHOW.M      Variables shown in displays    þ /MATSHOW FSHOW.MROTATE FACT.M,@2,CUR+1 / METHOD=GRAPHICAL¹¹Lr1¹¹üüT!1@CSURVOEXF@;SUR-RESTORE¹¹¹¹TLGEnd@üTXERR1@Tp        No active variables (masks A,B)! Press ENTER!@TLGW@TXERR2@Tp        Only masks A,B,X,- allowed! Press ENTER!@TLGW@TXW@TVC300@_@@Tp@TLGM@TXEnd@Tÿ  /EXTFACTA <data_file>,<#_of_factors>

  def Wmask=W3 Wmethod=W4 Wind=W5 Wcases=W6 Wsel=W7 Wfeps=W8

*********************************************************************
*********************************************************************
  def Wdata=W1 Wr=W2 Wmask=W3 Wmethod=W4 Wind=W5 Wcases=W6 Wsel=W7
  def Wfeps=W8
  def WA=W9 WB=W10 WX=W11 Wp=W12 Wt=W13 Wt2=W14
 Factor score coefficients:
 Loadings of external variables (X)
 Creating indicator matrix FSHOW.M:

 def W1=W1

