SURVO84ED 81 240    81 S20                                                       *SAVE EDQ24                                                                      *LOAD EDQ24                                                                      *                                                                                *ESTIMATE?                                                                       *  1 = Estimation of linear and non-linear regression models                     *  2 = Maximum likelihood estimates for user-defined distributions               *  3 = Estimating regression models with autocorrelated disturbances            C*  4 = Estimating ARMAX models                                                  C*  S = More information on statistical analysis                                  %1=ESTIM 2=EML 3=AR? 4=ARMA? S=STATIS                                            *@SELECT                                                                         *ESTIM?                                                                          @ESTIMATE <data>,<name of model>,L                                               *estimates the parameters of a linear or a nonlinear regression model.           *Parameter L is optional and gives the first line for the results in             *the edit field.                                                                 *The regression model has to be defined by a MODEL specification typed on        *any two consecutive lines in the edit field as follows:                         *           MODEL <name of model>                                                *           <regressand>=<function of regressors and parameters>                 *<data> may either be defined by the DATA specification in the edit              *field or it may be a Survo data file.                                           *The regressand and the regressors are notated by the names given as             *labels for the columns in the DATA specification of the data set.               *Unidentified words in the model are interpreted as parameters to be             *estimated.                                                                      *                                                                                *ESTIMATE is able to evaluate the expressions of first and second                *derivatives of the model function with respect to parameters. This              *information is employed in the model identification and in the numerical        *computation of estimates.                                                       *@C                                                                              *The estimation process can be controlled by extra specifications typed          *in the edit field.                                                              *@GOTO EXTRA                                                                     *EXTRA?                                                                          *Extra specifications and parameters in ESTIMATE:                                *                                                                                *  1 = model specification (MODEL)                                               *  2 = estimation criterion (CRITERION)                                          *  3 = numerical (optimization) method (METHOD)                                  *  4 = initial values for parameters                                             *  5 = weight variable (WEIGHT)                                                  *  6 = step length (STEP)                                                        *  7 = residuals, predicted values                                               *  8 = selecting observations                                                    *  9 = constants in the model function                                           *  A = displaying intermediate results                                           *  M = results in matrix files                                                  C*  D = more on data analysis                                                     *                                                                                %1=EMODEL 2=ECRIT 3=EMETHOD 4=EINIT 5=EWEIGHT @                                  %6=ESTEP 7=ERES 8=ESEL 9=ECON A=DISPLAY M=MAT D=STATIS? @                        *@SELECT                                                                         *                                                                                *ECRIT?                                                                          *Unless otherwise stated the estimation method is ordinary least                 *squares (OLS). As an alternative the Lp norm may be used as the                 *measure for goodness-of-fit and the p value is indicated by the extra           *specification CRITERION=Lp where p is a positive number.                        *Thus CRITERION=L2 is same as OLS and CRITERION=L1 corresponds to                *the minimum absolute deviation, which may also be selected by                   *CRITERION=ABS. If p<>2, METHOD=H must be used. @GOTO EE                         *EE?                                                                             *  S = more on extra specifications in ESTIMATE                                  %S=EXTRA                                                                         *@SELECT                                                                         *EMETHOD?                                                                        *The iterative numerical algorithm needed for minimizing of the                  *residual sum of squares may be selected by the user by an extra                 *specification METHOD typed in the edit field. At the moment we have             *the alternatives:                                                               * METHOD=N     Newton-Raphson            (see e.g. Walsh, 1975 p.108)            * METHOD=M     Modified Newton           (see e.g. Gill & al., 1982 p.105-)     C* METHOD=D     Davidon-Fletcher-Powell   (see e.g. Walsh, 1975 p.110)            * METHOD=d     As D above, but without 2nd derivatives (saves space)             * METHOD=H     Hooke-Jeeves              (see e.g. Walsh, 1975 p. 76)            * METHOD=G     Direct search in a grid of parameter space                        *              The search values for each parameter A must given as             C*              A=<lower_limit>,<upper_limit>,<step>                             C*              This last alternative exists mainly for searching for good       C*              initial values of parameters to be estimated.                    C*                                                                                *In case of a linear model METHOD=N is default and in case of a non-             *linear model METHOD=D is default.                                               *References: Walsh: Methods of optimization, Wiley (1975)                        *            Gill,Murray,Wright: Practical Optimization, Academic Press (1982)   *@G EE                                                                           *EINIT?                                                                          *When the model is linear with respect to parameters, no initial values          *are needed.                                                                     *In case of a non-linear model the initial values of the parameters may          *be entered in the field in the form <parameter>=<initial value>. If an          *intial value is not given, 0 will be default. @GOTO EE                          *EWEIGHT?                                                                        *The observations may be weighted by any variable or by a function of            *variables appearing in the data set. The weight function is defined             *by a WEIGHT specification of the form:                                          *      WEIGHT=<function of variables>                                            *If the WEIGHT specification is missing, WEIGHT=1 will be used. @G EE            *EMODEL?                                                                         *MODEL is a specification to be used in conjunction with the ESTIMATE            *operation. In regression models the general structure is                        *MODEL <name of the model>                                                       *<regressand>=<function of regressors and parameters>                            *                                                                                *Examples: Weight=a+b*Length                                                     *          log(Y)=constant+S*sin(s*t)+C*cos(c*t)                                 *          (Z^c-1)/c=a*X+b    (c on the left side is a parameter.)               *                                                                                *It is possible to make literal substitutions in the model notation              *by using abbreviations in braces as follows:                                    *                                                                               Ca{L}=log(Length)                                                                C*MODEL M1                                                                       CaY=a0+a1*{L}+a2*{L}^2+a3*{L}^3                                                  C*                                                                                *  F = mathematical functions available in ESTIMATE                              *  M = general ML estimation                                                     *  S = More information on extra specifications in ESTIMATE                      %F=EFUNC M=EML S=EXTRA                                                           *@SELECT                                                                         *                                                                                *DISPLAY?                                                                        @DISPLAY=1                                                                       *gives the possibility to monitor preliminary stages                             *of the analysis on the screen. For example, the analytical                      *derivatives will be displayed temporarily.                                      *Also scanning of observations and saving of residuals will                      *be displayed.                                                                   *If DISPLAY is omitted, only the optimization process will                       *be shown as a temporary display.                                                *@G EE                                                                           *                                                                                *ESTEP?                                                                          *If METHOD=D or METHOD=H is in use, the initial step length may be               *selected by STEP=<step length>.  STEP=1 is default.                             *If METHOD=H is used, the STEP specification may also be given in an             *augmented form STEP=<initial step>,<final step>. The default values             *correspond to STEP=1,0.00001    @GOTO EE                                        *ERES?                                                                           *  Residuals and predicted values                                                *The residuals and the predicted values of the regression model may              *be obtained by activating variables in the data set by R,F or G                 *where                                                                           *  R is a mask for the residuals,                                                *  F is a mask for the predicted values of the model function and                *  G is a mask for the values of the regressand (function).                      *The VARS and MASK specifications may be used for these activations              *as well.                                                                        *@G EE                                                                           *ESEL?                                                                           *  Selecting observations                                                        *The IND and CASES specifications can be used.                                   *@G EE                                                                           *                                                                                *ECON?                                                                           *Various constants (for example, fixed parameters) in the model                  *function may also have symbolic names with a '#' as a prefix.                   *For instance, #mean1=102.83333 may be typed in the edit field                   *and thereafter 102.83333 can be notated in the model specification              *by mean1. @GOTO EE                                                              *                                                                                *EML?                                                                            *By the ESTIMATE operation also maximum likelihood estimates for                 *parameters of a user-defined univariate distribution can be                     *computed.                                                                       *The distribution has to be defined by a MODEL specification                     *of the form:                                                                    *    10  *MODEL <name of model>                                                  *    11  *LOGDENSITY=<logarithm of the density function>                         *All other specifications are same as in ESTIMATE for regression                 *models.                                                                         *Example on the next page:                                                       *@C                                                                              *.......................................................................         *Estimation of a logit model:                                                    *FILE CREATE TEST,24,3,64,7,10000 / Creating file TEST (10000 cases)             *FIELDS:                                                                         *1 N 4 X1                                                                        *2 N 4 X2                                                                        *3 N 1 Y                                                                         *END                                                                             *                                                                                *VAR X1,X2,Y TO TEST / Making simulated data values                              *X1=rand(2002) X2=rand(2002) Y=int(rand(2002)+1/(1+exp(3-2*X1-3*X2)))            *Y is 1 with probability 1/(1+exp(3-2*X1-3*X2)) and Y=0 otherwise.               *                                                                                *Estimation of the model on the next page:                                       *@C                                                                              *Estimation of the logit model:                                                  a{P}=1/(1+exp(C+a*X1+b*X2)) / Shorthand notation for the model function          *                                                                                *MODEL LM1                                                                       aLOGDENSITY=Y*log({P})+(1-Y)*log(1-{P})                                          *                                                                                *ESTIMATE TEST,LM1,CUR+1 / METHOD=M PRIND=0                                      *Estimated parameters of model LM1:                                              *C=2.87264 (0.0711958)                                                           *a=-1.99688 (0.0807001)                                                          *b=-2.75048 (0.0835568)                                                          *n=10000 log(L)=-5830.526990 nf=56                                               *Correlations:                                                                   *                 C      a      b                                                * C           1.000 -0.714 -0.749                                                * a          -0.714  1.000  0.188                                                * b          -0.749  0.188  1.000                                                *                                                                                *  E = More information on ESTIMATE                                              %E=ESTIMATE                                                                      *                                                                                *EFUNC?                                                                          *Functions available in ESTIMATE model specifications:                           *                                                                                *Functions with derivatives:                                                     *sqrt, log (ln), exp, sin, cos, tan, atan (arctan), sinh, cosh,                  *tanh, asin (arcsin), acos (arccos), lgamma, phi, PHI.                           *                                                                                *lgamma is the logarithm of the gamma function.                                  *phi and PHI are the density and cumulative distiribution functions             C*of the standardized normal distribution, respectively.                         C*                                                                                *Functions without derivatives:                                                  *abs, int, round.                                                                *                                                                                *round(x) is x rounded to the nearest integer.                                   *@G EE                                                                           *                                                                                *MAT?                                                                            *When estimating regression models, results are saved in matrix files            *as follows:                                                                     *                                                                                *EST_PAR.M   parameter estimates and their standard errors                       *EST_CORR.M  correlations of parameter estimates                                 *EST.M       various basic statistics                                            *For example, MAT_EST.M(SSE)=                                                    *when activated after ESTIMATE gives the residual sum of errors.                 *                                                                                *  S = more information on ESTIMATE                                              %S=EXTRA                                                                         END                                                                              