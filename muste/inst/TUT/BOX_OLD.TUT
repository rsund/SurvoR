ISCRATCH €µµµµµµµThurstone's box problemTW20@The famous box problem will be studied here as follows:TW10@We generate a sample of 100 boxes where instead of the basicdimensions, say X,Y,Z, various derived variables like X+Y, XYZ etc.are analyzed.TW15@To make the situation more realistic each variable will also havean additive error term which is normally distributed.TW10@The random numbers generated for our experiment are time dependent.TW10@Thus by repeating this tutorial several times you may study thesampling variation.TW15@REDIM 200,80€We start by creating a file BOX for 25 variables and define the'latent' variables X,Y,Z:TW10@FILE CREATE BOX,100,25  Data for Thurstone's box problemFIELDS:1 N 4 X2 N 4 Y3 N 4 ZEND€Then we initialize the data file by 100 missing observations:FILE INIT BOX,100€and compute the latent variables X,Y,Z by the following VAR operation:VAR X,Y,Z TO BOXX=10*(1+rnd(0))Y=10*(1+rnd(0))Z=10*(1+rnd(0))€Hence X,Y,Z are independent and each of them is uniformly distributedon the interval (10,20).TW20@Let's check this byCORR BOX,END+1€TW30@SCRATCH €TW10@.±We assume now that X,Y and Z cannot be measured directly, but there arecertain derived variables available:TW10@X1=X+2*probit(rnd(0))  / error is N(0,4)Y1=Y+2*probit(rnd(0))±38ZZX2=X*X+50*probit(rnd(0))±40YYY±41ZZZSXY=X+Y+2*probit(rnd(0))±43ZZ±44YYPXY=X*Y+30*probit(rnd(0))±46ZZ±47YYVAR X1,Y1,Z1,X2,Y2,Z2,SXY,SXZ,SYZ,PXY,PXZ,PYZ TO BOX€TW10@.±We compute still 6 more variables:TW10@S2XY=sqrt(X*X+Y*Y)+2*probit(rnd(0))±52ZZZ±53YYYSXYZ=X+Y+Z+5*probit(rnd(0))S2XYZ=sqrt(X*X+Y*Y+Z*Z)+3*probit(rnd(0))PXYZ=X*Y*Z+1000*probit(rnd(0))VAR S2XY,S2XZ,S2YZ,SXYZ,S2XYZ,PXYZ TO BOX€TW20@.±The complete data set has now been generated and we may start the analysis.TW10@We shall omit the latent variables X,Y,Z and select variables asfollows:---²The correlations are computed byCORR BOX€The correlation matrix has been saved as matrix file CORR.Mand means and standard deviations as MSN.MTW10@TW20@We make copies of these files byMAT R=CORR.M€MAT M=MSN.M€TW10@To see the number of factors we use 5 as the first guess in theMATRUN PFACT operation which computes the principal axes solution:TW10@MATRUN PFACT,R,5€MAT LOAD PFACT.M,END+1€TW20@To see the significance of these factors we compute the sums ofsquares in each column (in touch mode):TW10@´·P+*RFF=P€SCRATCH €Only 3 first of them (as expected) whas a value above 1.Thus 3 will be the number of factors!TW30@SCRATCH €3€To get better estimates for communalities we activate thefollowing MATRUN operation a couple of times:TW10@€€MAT LOAD PFACT.M,END+1€´·P+*RFF=P€As expected the first factor is much stroger than the others.TW10@This solution does not reveal the true latent structure.TW20@To improve the situation we perform the Varimax rotation byROTATE PFACT.M,3€MAT LOAD AFACT.M,END+1€´·P+*RFF=P€Thus we have 3 almost equally strong factors which clearlydescribe the true structure.TW30@To confirm this result we compute the factor scores and theircorrelations with the latent variables X,Y,Z as follows:TW10@At first the coefficients for the scores are computed byMATRUN FCOEFF,AFACT.M,M€LINCO BOX,FCOEFF.M(F1,F2,F3)€CORR BOX ,END+1 / VARS=X,Y,Z,F1,F2,F3€There should now be high correlations (pairwise in some order)between X,Y,Z and F1,F2,F3 variableswhich indicates that factor analysis has revealed the true structureof the data.TW50@0d>DEL =*.M€AT€BOX.SVO€LOAD INDEX€Tÿ